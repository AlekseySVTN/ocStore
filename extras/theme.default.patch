diff --git a/catalog/view/theme/default/stylesheet/ie6.css b/catalog/view/theme/default/stylesheet/ie6.css
deleted file mode 100644
index 880de3e..0000000
--- a/catalog/view/theme/default/stylesheet/ie6.css
+++ /dev/null
@@ -1,249 +0,0 @@
-/* layout */
-#content {
-	zoom: 1;
-}
-/* header */
-#header {
-	z-index: 99;
-}
-#header .button-search {
-	z-index: 16;
-	top: 2px;
-	width: 30px;
-}
-#header #search input {
-	margin-top: 1px;
-	width: 255px;
-	position: relative;
-	left: 4px;
-}
-#header #cart {
-	right: -40px;
-	width: 400px;
-	z-index: 11;
-	zoom: 1;
-}
-#header #cart.active .heading {
-	z-index: 13;
-}
-#header #cart.active .content {
-	height: 150px;
-	z-index: 12;
-}
-/* menu */
-#menu ul li {
-	position: relative;
-	float: left;
-	z-index: 5;
-}
-#menu ul li.active {
-	background: #000;
-}
-#menu ul li a {
-	font-size: 13px;
-	color: #FFF;
-	text-decoration: none;
-	display: block;
-	padding: 12px 15px 11px 15px;
-	z-index: 6;
-	position: relative;
-}
-#menu ul li div {
-	display: none;
-	background: #FFFFFF;
-	position: absolute;
-	z-index: 5;
-	padding: 5px;
-	border: 1px solid #000000;
-	background: url('../image/menu.png');
-}
-#menu ul li.active div {
-	display: block;
-}
-#menu ul li div li {
-	float: none;
-}
-#menu ul li div li a {
-	font-size: 12px;
-	text-decoration: none;
-	padding: 4px;
-	color: #FFFFFF;
-	display: block;
-	width: 120px;
-	white-space: normal;
-}
-#menu ul li div li a:hover {
-	background: #000000;
-}
-.success, .warning, .attention, .information {
-	position: relative;
-}
-.success .close, .warning .close, .attention .close, .information .close {
-	position: absolute;
-	right: 10px;
-}
-.buttons {
-	zoom: 1;
-}
-/* box category */
-.box-category {
-	margin-top: -5px;
-	zoom: 1;
-}
-.box-category ul li {
-	padding: 8px 8px 8px 0px;
-	border-top: 1px solid #EEEEEE;
-}
-.box-category ul li a, .box-category ul li a:visited {
-	text-decoration: none;
-	color: #333;
-}
-.box-category ul li ul {
-	display: none;
-}
-.box-category ul li a.active {
-	font-weight: bold;
-}
-.box-category ul li ul {
-	list-style: none;
-	margin: 0;
-	padding: 0;
-}
-.box-category ul li ul li {
-	zoom: 1;
-	padding: 5px 5px 0px 10px;
-	border-top: 0;
-}
-.box-category ul li ul li a, .box-category ul li ul li a:visited {
-	color: #38B0E3;
-	text-decoration: none;
-	display: block;
-}
-.box-category ul li ul li a.active {
-	font-weight: bold;
-}
-.box-product {
-	width: 100%;
-	overflow: auto;
-	zoom: 1;
-}
-.box-product div {
-	width: 116px;
-	vertical-align: top;	
-	zoom: 1;
-	display: inline;
-	margin-right: 35px;
-	margin-bottom: 15px;
-}
-.box-product div div {
-	zoom: 0;
-	float: none;
-	margin-right: 0px;
-	margin-bottom: 0px;
-}
-#content .content {
-	zoom: 1;
-}
-.category-info {
-	zoom: 1;
-}
-.category-list {
-	zoom: 1;
-}
-.category-list ul {
-	list-style: none;
-	margin: 0;
-	padding: 0;
-	width: 25%;
-}
-/* manufacturer */
-.manufacturer-list {
-	zoom: 1;
-}
-/* product list */
-.product-filter {
-	zoom: 1;
-}
-.product-list div {
-	zoom: 1;
-}
-.product-list div div {
-	zoom: 0;
-}
-/* product grid */
-.product-grid {
-	width: auto;
-}
-.product-grid div {
-	width: 116px;
-	vertical-align: top;	
-	zoom: 1;
-	display: inline;
-	margin-right: 35px;
-	margin-bottom: 15px;
-}
-.product-grid div div {
-	zoom: 0;
-	float: none;
-	margin-right: 0px;
-	margin-bottom: 0px;
-}
-/* Product */
-.product-info {
-	zoom: 1;
-}
-.product-info .left {
-	zoom: 1;
-	float: left;
-	margin-right: 15px;
-}
-.product-info .left + .right {
-	zoom: 1;
-	margin-left: 265px;
-}
-.product-info .right {
-	zoom: 1;
-	margin-left: 265px;
-}
-.product-info .image-additional {
-	width: 270px;
-	margin-left: -20px;
-}
-.product-info .price {
-	zoom: 1;
-}
-.product-info .cart {
-	zoom: 1;
-}
-.product-info .review {
-	zoom: 1;
-}
-.product-info .review div {
-	zoom: 1;
-	padding: 8px;
-	border-bottom: 1px solid #E7E7E7;
-	line-height: 20px;
-}
-.product-info .review div div {
-	zoom: 0;
-	border-bottom: 0;
-	line-height: normal;
-}
-.product-info .review .share {
-	zoom: 1;
-}
-.htabs {
-	zoom: 1;
-	margin-bottom: -1px;
-}
-.htabs a:visited {
-	text-decoration: none;
-	color: #000000;
-}
-.tab-content {
-	zoom: 1;
-}
-/* footer */ 
-#footer {
-	zoom: 1;
-}
diff --git a/catalog/view/theme/default/stylesheet/ie7.css b/catalog/view/theme/default/stylesheet/ie7.css
index 96d19a5..42afb60 100644
--- a/catalog/view/theme/default/stylesheet/ie7.css
+++ b/catalog/view/theme/default/stylesheet/ie7.css
@@ -45,7 +45,7 @@
 	display: inline;
 }
 /* button */
-.prduct-info a.button span {
+.product-info a.button span {
 	line-height: 12px;
 	display: block;
 }
\ No newline at end of file
diff --git a/catalog/view/theme/default/stylesheet/slideshow.css b/catalog/view/theme/default/stylesheet/slideshow.css
index 4655ee8..58b81b9 100644
--- a/catalog/view/theme/default/stylesheet/slideshow.css
+++ b/catalog/view/theme/default/stylesheet/slideshow.css
@@ -5,7 +5,7 @@
  * Copyright 2011, Gilbert Pellegrom
  * Free to use and abuse under the MIT license.
  * http://www.opensource.org/licenses/mit-license.php
- * 
+ *
  * March 2010
  */
 /* The Nivo Slider styles */
diff --git a/catalog/view/theme/default/stylesheet/stylesheet.css b/catalog/view/theme/default/stylesheet/stylesheet.css
index c1f21f9..295300d 100644
--- a/catalog/view/theme/default/stylesheet/stylesheet.css
+++ b/catalog/view/theme/default/stylesheet/stylesheet.css
@@ -1,5 +1,5 @@
 html {
-	overflow: -moz-scrollbars-vertical;
+	overflow-y: scroll;
 	margin: 0;
 	padding: 0;
 }
@@ -15,7 +15,7 @@ body, td, th, input, textarea, select, a {
 }
 h1, .welcome {
 	color: #636E75;
-	font: Verdana;
+	font-family: Verdana;
 	margin-top: 0px;
 	margin-bottom: 20px;
 	font-size: 32px;
@@ -104,13 +104,14 @@ label {
 #language {
 	position: absolute;
 	top: 15px;
-	left: 335px;
-	width: 75px;
+	left: 320px;
+	width: 80px;
 	color: #999;
 	line-height: 17px;
 }
 #language img {
 	cursor: pointer;
+	margin-right: 5px;
 }
 #currency {
 	width: 75px;
@@ -495,7 +496,6 @@ table.list thead td a, .list thead td {
 	font-weight: bold;
 }
 table.list tbody td {
-	vertical-align: top;
 	padding: 0px 5px;
 }
 table.list .left {
@@ -516,20 +516,20 @@ table.radio {
 }
 table.radio td {
 	padding: 5px;
-	vertical-align: middle;
+}
+table.radio td label {
+	display: block;
 }
 table.radio tr td:first-child {
 	width: 1px;
 }
+table.radio tr td:first-child input {
+	margin-top: 1px;
+}
 table.radio tr.highlight:hover td {
 	background: #F1FFDD;
 	cursor: pointer;
 }
-table.radio label {
-	width: 100%;
-	height: 15px;
-	display: inline-block;
-}
 .pagination {
 	border-top: 1px solid #EEEEEE;
 	padding-top: 8px;
@@ -567,15 +567,15 @@ a.button, input.button {
 	line-height: 12px;
 	font-family: Arial, Helvetica, sans-serif;
 	font-size: 12px;
-	font-weight: bold;	
-	background: url('../image/button.png') top left repeat-x;
+	font-weight: bold;
+	background: url('../image/button.png') repeat-x;
 	-webkit-border-radius: 7px 7px 7px 7px;
 	-moz-border-radius: 7px 7px 7px 7px;
 	-khtml-border-radius: 7px 7px 7px 7px;
 	border-radius: 7px 7px 7px 7px;
 	-webkit-box-shadow: 0px 2px 2px #DDDDDD;
 	-moz-box-shadow: 0px 2px 2px #DDDDDD;
-	box-shadow: 0px 2px 2px #DDDDDD;	
+	box-shadow: 0px 2px 2px #DDDDDD;
 }
 a.button {
 	display: inline-block;
@@ -589,7 +589,7 @@ input.button {
 	padding: 0px 12px 0px 12px;
 }
 a.button:hover, input.button:hover {
-	background: url('../image/button-active.png') repeat-x;
+	background-position: 0px -24px;
 }
 .buttons {
 	background: #FFFFFF;
@@ -722,43 +722,59 @@ a.button:hover, input.button:hover {
 	margin-bottom: 4px;
 }
 /* box category */
-.box-category {
-	margin-top: -5px;
-}
-.box-category ul {
+ul.box-category, ul.box-category ul {
 	list-style: none;
 	margin: 0;
 	padding: 0;
 }
-.box-category > ul > li {
+ul.box-category > li:first-child {
+	padding: 0px 8px 8px 0px;
+}
+ul.box-category > li {
 	padding: 8px 8px 8px 0px;
 }
-.box-category > ul > li + li {
+ul.box-category > li + li {
 	border-top: 1px solid #EEEEEE;
 }
-.box-category > ul > li > a {
+ul.box-category > li > a {
 	text-decoration: none;
 	color: #333;
 }
-.box-category > ul > li ul {
+ul.box-category > li ul {
 	display: none;
 }
-.box-category > ul > li a.active {
+ul.box-category > li a.active {
 	font-weight: bold;
 }
-.box-category > ul > li a.active + ul {
+ul.box-category > li a.active + ul {
 	display: block;
 }
-.box-category > ul > li ul > li {
+ul.box-category > li ul > li {
 	padding: 5px 5px 0px 10px;
 }
-.box-category > ul > li ul > li > a {
+ul.box-category > li ul > li > a {
 	text-decoration: none;
 	display: block;
 }
-.box-category > ul > li ul > li > a.active {
+ul.box-category > li ul > li > a.active {
 	font-weight: bold;
 }
+/* box filter */
+ul.box-filter, ul.box-filter ul {
+	list-style: none;
+	margin: 0;
+	padding: 0;
+}
+ul.box-filter span {
+	font-weight: bold;
+	border-bottom: 1px solid #EEEEEE;
+	display: block;
+	padding-bottom: 5px;
+	margin-bottom: 8px;
+}
+ul.box-filter > li ul {
+	padding-bottom: 10px;
+}
 /* content */
 #content .content {
 	padding: 10px;
@@ -793,10 +809,6 @@ a.button:hover, input.button:hover {
 	float: left;
 	width: 18%;
 }
-.category-list .div a {
-	text-decoration: underline;
-	font-weight: bold;
-}
 /* manufacturer */
 .manufacturer-list {
 	border: 1px solid #DBDEE1;
@@ -1107,22 +1119,18 @@ a.button:hover, input.button:hover {
 	padding: 0px 5px 10px 5px;
 	margin-bottom: 20px;
 	color: #4D4D4D;
-	overflow: auto;
-}
-.product-info .cart div {
-	float: left;
-	vertical-align: middle;
 }
 .product-info .cart div > span {
-	padding-top: 7px;
-	display: block;
 	color: #999;
 }
+.product-info .cart .links {
+	display: inline-block;
+	vertical-align: middle;
+}
 .product-info .cart .minimum {
 	padding-top: 5px;
 	font-size: 11px;
 	color: #999;
-	clear: both;
 }
 .product-info .review {
 	color: #4D4D4D;
@@ -1146,6 +1154,23 @@ a.button:hover, input.button:hover {
 .product-info .review .share a {
 	text-decoration: none;
 }
+.review-list {
+	padding: 10px;
+	overflow: auto;
+	margin-bottom: 20px;
+	border: 1px solid #EEEEEE;
+}
+.review-list .author {
+	float: left;
+	margin-bottom: 20px;
+}
+.review-list .rating {
+	float: right;
+	margin-bottom: 20px;
+}
+.review-list .text {
+	clear: both;
+}
 .attribute {
 	border-collapse: collapse;
 	width: 100%;
diff --git a/catalog/view/theme/default/template/account/account.tpl b/catalog/view/theme/default/template/account/account.tpl
index f7eb1ba..96d6f0c 100644
--- a/catalog/view/theme/default/template/account/account.tpl
+++ b/catalog/view/theme/default/template/account/account.tpl
@@ -38,4 +38,4 @@
     </ul>
   </div>
   <?php echo $content_bottom; ?></div>
-<?php echo $footer; ?> 
\ No newline at end of file
+<?php echo $footer; ?>
\ No newline at end of file
diff --git a/catalog/view/theme/default/template/account/address_form.tpl b/catalog/view/theme/default/template/account/address_form.tpl
index 98e3a23..c8134b7 100644
--- a/catalog/view/theme/default/template/account/address_form.tpl
+++ b/catalog/view/theme/default/template/account/address_form.tpl
@@ -47,7 +47,7 @@
             <?php } ?></td>
         </tr>
         <tr>
-          <td><span class="required">*</span> <?php echo $entry_postcode; ?></td>
+          <td><span id="postcode-required" class="required">*</span> <?php echo $entry_postcode; ?></td>
           <td><input type="text" name="postcode" value="<?php echo $postcode; ?>" />
             <?php if ($error_postcode) { ?>
             <span class="error"><?php echo $error_postcode; ?></span>
@@ -55,7 +55,7 @@
         </tr>
         <tr>
           <td><span class="required">*</span> <?php echo $entry_country; ?></td>
-          <td><select name="country_id" onchange="$('select[name=\'zone_id\']').load('index.php?route=account/address/zone&country_id=' + this.value + '&zone_id=<?php echo $zone_id; ?>');">
+          <td><select name="country_id">
               <option value=""><?php echo $text_select; ?></option>
               <?php foreach ($countries as $country) { ?>
               <?php if ($country['country_id'] == $country_id) { ?>
@@ -95,11 +95,54 @@
     </div>
     <div class="buttons">
       <div class="left"><a href="<?php echo $back; ?>" class="button"><?php echo $button_back; ?></a></div>
-      <div class="right"><input type="submit" value="<?php echo $button_continue; ?>" class="button" /></div>
+      <div class="right">
+        <input type="submit" value="<?php echo $button_continue; ?>" class="button" />
+      </div>
     </div>
   </form>
   <?php echo $content_bottom; ?></div>
 <script type="text/javascript"><!--
-$('select[name=\'zone_id\']').load('index.php?route=account/address/zone&country_id=<?php echo $country_id; ?>&zone_id=<?php echo $zone_id; ?>');
-//--></script> 
+$('select[name=\'country_id\']').on('change', function() {
+	$.ajax({
+		url: 'index.php?route=account/address/country&country_id=' + this.value,
+		dataType: 'json',
+		beforeSend: function() {
+			$('select[name=\'country_id\']').after('<img src="catalog/view/theme/default/image/loading.gif" class="loading" style="padding-left: 5px;" />');
+		},
+		complete: function() {
+			$('.loading').remove();
+		},
+		success: function(json) {
+			if (json['postcode_required'] == '1') {
+				$('#postcode-required').show();
+			} else {
+				$('#postcode-required').hide();
+			}
+
+			html = '<option value=""><?php echo $text_select; ?></option>';
+
+			if (json['zone'] != '') {
+				for (i = 0; i < json['zone'].length; i++) {
+        			html += '<option value="' + json['zone'][i]['zone_id'] + '"';
+
+					if (json['zone'][i]['zone_id'] == '<?php echo $zone_id; ?>') {
+	      				html += ' selected="selected"';
+	    			}
+
+	    			html += '>' + json['zone'][i]['name'] + '</option>';
+				}
+			} else {
+				html += '<option value="0" selected="selected"><?php echo $text_none; ?></option>';
+			}
+
+			$('select[name=\'zone_id\']').html(html);
+		},
+		error: function(xhr, ajaxOptions, thrownError) {
+			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+		}
+	});
+});
+
+$('select[name=\'country_id\']').trigger('change');
+//--></script>
 <?php echo $footer; ?>
\ No newline at end of file
diff --git a/catalog/view/theme/default/template/account/edit.tpl b/catalog/view/theme/default/template/account/edit.tpl
index 4d14335..60dcbc2 100644
--- a/catalog/view/theme/default/template/account/edit.tpl
+++ b/catalog/view/theme/default/template/account/edit.tpl
@@ -1,8 +1,4 @@
-<?php echo $header; ?>
-<?php if ($error_warning) { ?>
-<div class="warning"><?php echo $error_warning; ?></div>
-<?php } ?>
-<?php echo $column_left; ?><?php echo $column_right; ?>
+<?php echo $header; ?><?php echo $column_left; ?><?php echo $column_right; ?>
 <div id="content"><?php echo $content_top; ?>
   <div class="breadcrumb">
     <?php foreach ($breadcrumbs as $breadcrumb) { ?>
@@ -10,50 +6,86 @@
     <?php } ?>
   </div>
   <h1><?php echo $heading_title; ?></h1>
-  <form action="<?php echo $action; ?>" method="post" enctype="multipart/form-data">
-    <h2><?php echo $text_your_details; ?></h2>
-    <div class="content">
-      <table class="form">
-        <tr>
-          <td><span class="required">*</span> <?php echo $entry_firstname; ?></td>
-          <td><input type="text" name="firstname" value="<?php echo $firstname; ?>" />
-            <?php if ($error_firstname) { ?>
-            <span class="error"><?php echo $error_firstname; ?></span>
-            <?php } ?></td>
-        </tr>
-        <tr>
-          <td><span class="required">*</span> <?php echo $entry_lastname; ?></td>
-          <td><input type="text" name="lastname" value="<?php echo $lastname; ?>" />
-            <?php if ($error_lastname) { ?>
-            <span class="error"><?php echo $error_lastname; ?></span>
-            <?php } ?></td>
-        </tr>
-        <tr>
-          <td><span class="required">*</span> <?php echo $entry_email; ?></td>
-          <td><input type="text" name="email" value="<?php echo $email; ?>" />
-            <?php if ($error_email) { ?>
-            <span class="error"><?php echo $error_email; ?></span>
-            <?php } ?></td>
-        </tr>
-        <tr>
-          <td><span class="required">*</span> <?php echo $entry_telephone; ?></td>
-          <td><input type="text" name="telephone" value="<?php echo $telephone; ?>" />
-            <?php if ($error_telephone) { ?>
-            <span class="error"><?php echo $error_telephone; ?></span>
-            <?php } ?></td>
-        </tr>
-        <tr>
-          <td><?php echo $entry_fax; ?></td>
-          <td><input type="text" name="fax" value="<?php echo $fax; ?>" /></td>
-        </tr>
-      </table>
-    </div>
-    <div class="buttons">
-      <div class="left"><a href="<?php echo $back; ?>" class="button"><?php echo $button_back; ?></a></div>
-      <div class="right">
-        <input type="submit" value="<?php echo $button_continue; ?>" class="button" />
-      </div>
+  <h2><?php echo $text_your_details; ?></h2>
+  <div class="content">
+    <table class="form">
+      <tr>
+        <td><span class="required">*</span> <?php echo $entry_firstname; ?></td>
+        <td><input type="text" name="firstname" value="<?php echo $firstname; ?>" /></td>
+      </tr>
+      <tr>
+        <td><span class="required">*</span> <?php echo $entry_lastname; ?></td>
+        <td><input type="text" name="lastname" value="<?php echo $lastname; ?>" /></td>
+      </tr>
+      <tr>
+        <td><span class="required">*</span> <?php echo $entry_email; ?></td>
+        <td><input type="text" name="email" value="<?php echo $email; ?>" /></td>
+      </tr>
+      <tr>
+        <td><span class="required">*</span> <?php echo $entry_telephone; ?></td>
+        <td><input type="text" name="telephone" value="<?php echo $telephone; ?>" /></td>
+      </tr>
+      <tr>
+        <td><?php echo $entry_fax; ?></td>
+        <td><input type="text" name="fax" value="<?php echo $fax; ?>" /></td>
+      </tr>
+    </table>
+  </div>
+  <div class="buttons">
+    <div class="left"><a href="<?php echo $back; ?>" class="button"><?php echo $button_back; ?></a></div>
+    <div class="right">
+      <input type="button" value="<?php echo $button_continue; ?>" id="button-edit" class="button" />
     </div>
-  </form>
+  </div>
   <?php echo $content_bottom; ?></div>
+<script type="text/javascript"><!--
+$('#button-edit').on('click', function() {
+	$.ajax({
+		url: 'index.php?route=account/edit/save',
+		type: 'post',
+		data: $('input[type=\'text\'], input[type=\'password\'], input[type=\'checkbox\']:checked, input[type=\'radio\']:checked, input[type=\'hidden\'], select'),
+		dataType: 'json',
+		beforeSend: function() {
+			$('#button-edit').attr('disabled', true);
+			$('#button-edit').after('<img src="catalog/view/theme/default/image/loading.gif" class="loading" style="padding-left: 5px;" />');
+		},
+		complete: function() {
+			$('#button-edit').attr('disabled', false);
+			$('.loading').remove();
+		},
+		success: function(json) {
+			$('.warning, .error').remove();
+
+			if (json['redirect']) {
+				location = json['redirect'];
+			} else if (json['error']) {
+				if (json['error']['warning']) {
+					$('#notification').html('<div class="warning" style="display: none;">' + json['error']['warning'] + '<img src="catalog/view/theme/default/image/close.png" alt="" class="close" /></div>');
+
+					$('.warning').fadeIn('slow');
+				}
+
+				if (json['error']['firstname']) {
+					$('input[name=\'firstname\']').after('<span class="error">' + json['error']['firstname'] + '</span>');
+				}
+
+				if (json['error']['lastname']) {
+					$('input[name=\'lastname\']').after('<span class="error">' + json['error']['lastname'] + '</span>');
+				}
+
+				if (json['error']['email']) {
+					$('input[name=\'email\']').after('<span class="error">' + json['error']['email'] + '</span>');
+				}
+
+				if (json['error']['telephone']) {
+					$('input[name=\'telephone\']').after('<span class="error">' + json['error']['telephone'] + '</span>');
+				}
+			}
+		},
+		error: function(xhr, ajaxOptions, thrownError) {
+			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+		}
+	});
+});
+//--></script>
 <?php echo $footer; ?>
\ No newline at end of file
diff --git a/catalog/view/theme/default/template/account/login.tpl b/catalog/view/theme/default/template/account/login.tpl
index 7ca671b..0e7a704 100644
--- a/catalog/view/theme/default/template/account/login.tpl
+++ b/catalog/view/theme/default/template/account/login.tpl
@@ -27,11 +27,11 @@
         <div class="content">
           <p><?php echo $text_i_am_returning_customer; ?></p>
           <b><?php echo $entry_email; ?></b><br />
-          <input type="text" name="email" value="" />
+          <input type="text" name="email" value="<?php echo $email; ?>" />
           <br />
           <br />
           <b><?php echo $entry_password; ?></b><br />
-          <input type="password" name="password" value="" />
+          <input type="password" name="password" value="<?php echo $password; ?>" />
           <br />
           <a href="<?php echo $forgotten; ?>"><?php echo $text_forgotten; ?></a><br />
           <br />
@@ -50,5 +50,5 @@ $('#login input').keydown(function(e) {
 		$('#login').submit();
 	}
 });
-//--></script> 
+//--></script>
 <?php echo $footer; ?>
\ No newline at end of file
diff --git a/catalog/view/theme/default/template/account/order_info.tpl b/catalog/view/theme/default/template/account/order_info.tpl
index 6173992..3a6abc3 100644
--- a/catalog/view/theme/default/template/account/order_info.tpl
+++ b/catalog/view/theme/default/template/account/order_info.tpl
@@ -139,4 +139,4 @@
     <div class="right"><a href="<?php echo $continue; ?>" class="button"><?php echo $button_continue; ?></a></div>
   </div>
   <?php echo $content_bottom; ?></div>
-<?php echo $footer; ?> 
\ No newline at end of file
+<?php echo $footer; ?>
\ No newline at end of file
diff --git a/catalog/view/theme/default/template/account/register.tpl b/catalog/view/theme/default/template/account/register.tpl
index 66800ab..6800ef9 100644
--- a/catalog/view/theme/default/template/account/register.tpl
+++ b/catalog/view/theme/default/template/account/register.tpl
@@ -1,8 +1,4 @@
-<?php echo $header; ?>
-<?php if ($error_warning) { ?>
-<div class="warning"><?php echo $error_warning; ?></div>
-<?php } ?>
-<?php echo $column_left; ?><?php echo $column_right; ?>
+<?php echo $header; ?><?php echo $column_left; ?><?php echo $column_right; ?>
 <div id="content"><?php echo $content_top; ?>
   <div class="breadcrumb">
     <?php foreach ($breadcrumbs as $breadcrumb) { ?>
@@ -11,167 +7,421 @@
   </div>
   <h1><?php echo $heading_title; ?></h1>
   <p><?php echo $text_account_already; ?></p>
-  <form action="<?php echo $action; ?>" method="post" enctype="multipart/form-data">
-    <h2><?php echo $text_your_details; ?></h2>
-    <div class="content">
-      <table class="form">
-        <tr>
-          <td><span class="required">*</span> <?php echo $entry_firstname; ?></td>
-          <td><input type="text" name="firstname" value="<?php echo $firstname; ?>" />
-            <?php if ($error_firstname) { ?>
-            <span class="error"><?php echo $error_firstname; ?></span>
-            <?php } ?></td>
-        </tr>
-        <tr>
-          <td><span class="required">*</span> <?php echo $entry_lastname; ?></td>
-          <td><input type="text" name="lastname" value="<?php echo $lastname; ?>" />
-            <?php if ($error_lastname) { ?>
-            <span class="error"><?php echo $error_lastname; ?></span>
-            <?php } ?></td>
-        </tr>
-        <tr>
-          <td><span class="required">*</span> <?php echo $entry_email; ?></td>
-          <td><input type="text" name="email" value="<?php echo $email; ?>" />
-            <?php if ($error_email) { ?>
-            <span class="error"><?php echo $error_email; ?></span>
-            <?php } ?></td>
-        </tr>
-        <tr>
-          <td><span class="required">*</span> <?php echo $entry_telephone; ?></td>
-          <td><input type="text" name="telephone" value="<?php echo $telephone; ?>" />
-            <?php if ($error_telephone) { ?>
-            <span class="error"><?php echo $error_telephone; ?></span>
-            <?php } ?></td>
-        </tr>
-        <tr>
-          <td><?php echo $entry_fax; ?></td>
-          <td><input type="text" name="fax" value="<?php echo $fax; ?>" /></td>
-        </tr>
-      </table>
-    </div>
-    <h2><?php echo $text_your_address; ?> </h2>
-    <div class="content">
-      <table class="form">
-        <tr>
-          <td><?php echo $entry_company; ?></td>
-          <td><input type="text" name="company" value="<?php echo $company; ?>" /></td>
-        </tr>
-        <tr>
-          <td><span class="required">*</span> <?php echo $entry_address_1; ?></td>
-          <td><input type="text" name="address_1" value="<?php echo $address_1; ?>" />
-            <?php if ($error_address_1) { ?>
-            <span class="error"><?php echo $error_address_1; ?></span>
-            <?php } ?></td>
-        </tr>
-        <tr>
-          <td><?php echo $entry_address_2; ?></td>
-          <td><input type="text" name="address_2" value="<?php echo $address_2; ?>" /></td>
-        </tr>
-        <tr>
-          <td><span class="required">*</span> <?php echo $entry_city; ?></td>
-          <td><input type="text" name="city" value="<?php echo $city; ?>" />
-            <?php if ($error_city) { ?>
-            <span class="error"><?php echo $error_city; ?></span>
-            <?php } ?></td>
-        </tr>
-        <tr>
-          <td><span class="required">*</span> <?php echo $entry_postcode; ?></td>
-          <td><input type="text" name="postcode" value="<?php echo $postcode; ?>" />
-            <?php if ($error_postcode) { ?>
-            <span class="error"><?php echo $error_postcode; ?></span>
-            <?php } ?></td>
-        </tr>
-        <tr>
-          <td><span class="required">*</span> <?php echo $entry_country; ?></td>
-          <td><select name="country_id" onchange="$('select[name=\'zone_id\']').load('index.php?route=account/register/zone&country_id=' + this.value + '&zone_id=<?php echo $zone_id; ?>');">
-              <option value=""><?php echo $text_select; ?></option>
-              <?php foreach ($countries as $country) { ?>
-              <?php if ($country['country_id'] == $country_id) { ?>
-              <option value="<?php echo $country['country_id']; ?>" selected="selected"><?php echo $country['name']; ?></option>
-              <?php } else { ?>
-              <option value="<?php echo $country['country_id']; ?>"><?php echo $country['name']; ?></option>
-              <?php } ?>
-              <?php } ?>
-            </select>
-            <?php if ($error_country) { ?>
-            <span class="error"><?php echo $error_country; ?></span>
-            <?php } ?></td>
-        </tr>
-        <tr>
-          <td><span class="required">*</span> <?php echo $entry_zone; ?></td>
-          <td><select name="zone_id">
-            </select>
-            <?php if ($error_zone) { ?>
-            <span class="error"><?php echo $error_zone; ?></span>
-            <?php } ?></td>
-        </tr>
-      </table>
-    </div>
-    <h2><?php echo $text_your_password; ?></h2>
-    <div class="content">
-      <table class="form">
-        <tr>
-          <td><span class="required">*</span> <?php echo $entry_password; ?></td>
-          <td><input type="password" name="password" value="<?php echo $password; ?>" />
-            <?php if ($error_password) { ?>
-            <span class="error"><?php echo $error_password; ?></span>
-            <?php } ?></td>
-        </tr>
-        <tr>
-          <td><span class="required">*</span> <?php echo $entry_confirm; ?></td>
-          <td><input type="password" name="confirm" value="<?php echo $confirm; ?>" />
-            <?php if ($error_confirm) { ?>
-            <span class="error"><?php echo $error_confirm; ?></span>
-            <?php } ?></td>
-        </tr>
-      </table>
-    </div>
-    <h2><?php echo $text_newsletter; ?></h2>
-    <div class="content">
-      <table class="form">
-        <tr>
-          <td><?php echo $entry_newsletter; ?></td>
-          <td><?php if ($newsletter == 1) { ?>
-            <input type="radio" name="newsletter" value="1" checked="checked" />
-            <?php echo $text_yes; ?>
-            <input type="radio" name="newsletter" value="0" />
-            <?php echo $text_no; ?>
+  <h2><?php echo $text_your_details; ?></h2>
+  <div class="content">
+    <table class="form">
+      <tr>
+        <td><span class="required">*</span> <?php echo $entry_firstname; ?></td>
+        <td><input type="text" name="firstname" value="" /></td>
+      </tr>
+      <tr>
+        <td><span class="required">*</span> <?php echo $entry_lastname; ?></td>
+        <td><input type="text" name="lastname" value="" /></td>
+      </tr>
+      <tr>
+        <td><span class="required">*</span> <?php echo $entry_email; ?></td>
+        <td><input type="text" name="email" value="" /></td>
+      </tr>
+      <tr>
+        <td><span class="required">*</span> <?php echo $entry_telephone; ?></td>
+        <td><input type="text" name="telephone" value="" /></td>
+      </tr>
+      <tr>
+        <td><?php echo $entry_fax; ?></td>
+        <td><input type="text" name="fax" value="" /></td>
+      </tr>
+    </table>
+  </div>
+  <h2><?php echo $text_your_address; ?></h2>
+  <div class="content">
+    <table class="form">
+      <tr>
+        <td><?php echo $entry_company; ?></td>
+        <td><input type="text" name="company" value="" /></td>
+      </tr>
+      <tr style="display: <?php echo (count($customer_groups) > 1 ? 'table-row' : 'none'); ?>;">
+        <td><?php echo $entry_customer_group; ?></td>
+        <td><select name="customer_group_id">
+            <?php foreach ($customer_groups as $customer_group) { ?>
+            <?php if ($customer_group['customer_group_id'] == $customer_group_id) { ?>
+            <option value="<?php echo $customer_group['customer_group_id']; ?>" selected="selected"><?php echo $customer_group['name']; ?></option>
             <?php } else { ?>
-            <input type="radio" name="newsletter" value="1" />
-            <?php echo $text_yes; ?>
-            <input type="radio" name="newsletter" value="0" checked="checked" />
-            <?php echo $text_no; ?>
-            <?php } ?></td>
-        </tr>
-      </table>
-    </div>
-    <?php if ($text_agree) { ?>
-    <div class="buttons">
-      <div class="right"><?php echo $text_agree; ?>
-        <?php if ($agree) { ?>
-        <input type="checkbox" name="agree" value="1" checked="checked" />
-        <?php } else { ?>
-        <input type="checkbox" name="agree" value="1" />
-        <?php } ?>
-        <input type="submit" value="<?php echo $button_continue; ?>" class="button" />
-      </div>
+            <option value="<?php echo $customer_group['customer_group_id']; ?>"><?php echo $customer_group['name']; ?></option>
+            <?php } ?>
+            <?php } ?>
+          </select></td>
+      </tr>
+      <tr>
+        <td><span class="required">*</span> <?php echo $entry_address_1; ?></td>
+        <td><input type="text" name="address_1" value="" /></td>
+      </tr>
+      <tr>
+        <td><?php echo $entry_address_2; ?></td>
+        <td><input type="text" name="address_2" value="" /></td>
+      </tr>
+      <tr>
+        <td><span class="required">*</span> <?php echo $entry_city; ?></td>
+        <td><input type="text" name="city" value="" /></td>
+      </tr>
+      <tr>
+        <td><span id="postcode-required" class="required">*</span> <?php echo $entry_postcode; ?></td>
+        <td><input type="text" name="postcode" value="<?php echo $postcode; ?>" /></td>
+      </tr>
+      <tr>
+        <td><span class="required">*</span> <?php echo $entry_country; ?></td>
+        <td><select name="country_id">
+            <option value=""><?php echo $text_select; ?></option>
+            <?php foreach ($countries as $country) { ?>
+            <?php if ($country['country_id'] == $country_id) { ?>
+            <option value="<?php echo $country['country_id']; ?>" selected="selected"><?php echo $country['name']; ?></option>
+            <?php } else { ?>
+            <option value="<?php echo $country['country_id']; ?>"><?php echo $country['name']; ?></option>
+            <?php } ?>
+            <?php } ?>
+          </select></td>
+      </tr>
+      <tr>
+        <td><span class="required">*</span> <?php echo $entry_zone; ?></td>
+        <td><select name="zone_id">
+          </select></td>
+      </tr>
+    </table>
+  </div>
+  <h2><?php echo $text_your_password; ?></h2>
+  <div class="content">
+    <table class="form">
+      <tr>
+        <td><span class="required">*</span> <?php echo $entry_password; ?></td>
+        <td><input type="password" name="password" value="" /></td>
+      </tr>
+      <tr>
+        <td><span class="required">*</span> <?php echo $entry_confirm; ?></td>
+        <td><input type="password" name="confirm" value="" /></td>
+      </tr>
+    </table>
+  </div>
+  <h2><?php echo $text_newsletter; ?></h2>
+  <div class="content">
+    <table class="form">
+      <tr>
+        <td><?php echo $entry_newsletter; ?></td>
+        <td><input type="radio" name="newsletter" value="1" />
+          <?php echo $text_yes; ?>
+          <input type="radio" name="newsletter" value="0" checked="checked" />
+          <?php echo $text_no; ?></td>
+      </tr>
+    </table>
+  </div>
+  <?php if ($text_agree) { ?>
+  <div class="buttons">
+    <div class="right"><?php echo $text_agree; ?>
+      <input type="checkbox" name="agree" value="1" />
+      <input type="button" value="<?php echo $button_continue; ?>" id="button-register" class="button" />
     </div>
-    <?php } else { ?>
-    <div class="buttons">
-      <div class="right">
-        <input type="submit" value="<?php echo $button_continue; ?>" class="button" />
-      </div>
+  </div>
+  <?php } else { ?>
+  <div class="buttons">
+    <div class="right">
+      <input type="button" value="<?php echo $button_continue; ?>" id="button-register" class="button" />
     </div>
-    <?php } ?>
-  </form>
+  </div>
+  <?php } ?>
   <?php echo $content_bottom; ?></div>
+<div style="display: none;">
+  <form enctype="multipart/form-data">
+    <input type="file" name="file" id="file" />
+  </form>
+</div>
 <script type="text/javascript"><!--
-$('select[name=\'zone_id\']').load('index.php?route=account/register/zone&country_id=<?php echo $country_id; ?>&zone_id=<?php echo $zone_id; ?>');
-//--></script> 
+$('#button-register').on('click', function() {
+	$.ajax({
+		url: 'index.php?route=account/register/save',
+		type: 'post',
+		data: $('input[type=\'text\'], input[type=\'password\'], input[type=\'checkbox\']:checked, input[type=\'radio\']:checked, input[type=\'hidden\'], select'),
+		dataType: 'json',
+		beforeSend: function() {
+			$('#button-register').attr('disabled', true);
+			$('#button-register').after('<img src="catalog/view/theme/default/image/loading.gif" class="loading" style="padding-left: 5px;" />');
+		},
+		complete: function() {
+			$('#button-register').attr('disabled', false);
+			$('.loading').remove();
+		},
+		success: function(json) {
+			$('.warning, .error').remove();
+
+			if (json['redirect']) {
+				location = json['redirect'];
+			} else if (json['error']) {
+				if (json['error']['warning']) {
+					$('#notification').html('<div class="warning" style="display: none;">' + json['error']['warning'] + '<img src="catalog/view/theme/default/image/close.png" alt="" class="close" /></div>');
+
+					$('.warning').fadeIn('slow');
+				}
+
+				if (json['error']['firstname']) {
+					$('input[name=\'firstname\']').after('<span class="error">' + json['error']['firstname'] + '</span>');
+				}
+
+				if (json['error']['lastname']) {
+					$('input[name=\'lastname\']').after('<span class="error">' + json['error']['lastname'] + '</span>');
+				}
+
+				if (json['error']['email']) {
+					$('input[name=\'email\']').after('<span class="error">' + json['error']['email'] + '</span>');
+				}
+
+				if (json['error']['telephone']) {
+					$('input[name=\'telephone\']').after('<span class="error">' + json['error']['telephone'] + '</span>');
+				}
+
+				if (json['error']['address_1']) {
+					$('input[name=\'address_1\']').after('<span class="error">' + json['error']['address_1'] + '</span>');
+				}
+
+				if (json['error']['city']) {
+					$('input[name=\'city\']').after('<span class="error">' + json['error']['city'] + '</span>');
+				}
+
+				if (json['error']['postcode']) {
+					$('input[name=\'postcode\']').after('<span class="error">' + json['error']['postcode'] + '</span>');
+				}
+
+				if (json['error']['country']) {
+					$('select[name=\'country_id\']').after('<span class="error">' + json['error']['country'] + '</span>');
+				}
+
+				if (json['error']['zone']) {
+					$('select[name=\'zone_id\']').after('<span class="error">' + json['error']['zone'] + '</span>');
+				}
+
+				if (json['error']['password']) {
+					$('input[name=\'password\']').after('<span class="error">' + json['error']['password'] + '</span>');
+				}
+
+				if (json['error']['confirm']) {
+					$('input[name=\'confirm\']').after('<span class="error">' + json['error']['confirm'] + '</span>');
+				}
+			}
+		},
+		error: function(xhr, ajaxOptions, thrownError) {
+			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+		}
+	});
+});
+
+$('select[name=\'customer_group_id\']').on('change', function() {
+	$.ajax({
+		url: 'index.php?route=account/register/custom_field&customer_group_id=' + this.value,
+		dataType: 'json',
+		beforeSend: function() {
+			$('select[name=\'customer_group_id\']').after('<img src="catalog/view/theme/default/image/loading.gif" class="loading" style="padding-left: 5px;" />');
+		},
+		complete: function() {
+			$('.loading').remove();
+		},
+		success: function(json) {
+			$('.custom-field').remove();
+
+			for (i = 0; i < json.length; i++) {
+				custom_field = json[i];
+
+				html  = '<tr class="custom-field">';
+				html += '  <td>';
+
+				if (custom_field['required'] == 1) {
+					html += '<span id="customer-field-required' + custom_field['custom_field_id'] + '" class="required">*</span> ';
+				}
+
+				html += custom_field['name'] += '</td>';
+
+				// Select
+				if (custom_field['type'] == 'select') {
+					html += '<td><select name="custom_field[' + custom_field['custom_field_id'] + ']">';
+					html += '<option value=""><?php echo $text_select; ?></option>';
+
+					for (j = 0; j < custom_field['custom_field_value'].length; j++) {
+						html += '<option value="' + custom_field['custom_field_value'][j]['custom_field_value_id'] + '">' + custom_field['custom_field_value'][j]['name'] + '</option>';
+					}
+
+					html += '</select></td>';
+				}
+
+				// Radio
+				if (custom_field['type'] == 'radio') {
+					html += '<td>';
+
+					for (j = 0; j < custom_field['custom_field_value'].length; j++) {
+						html += '<input type="radio" name="custom_field[' + custom_field['custom_field_value'][j]['custom_field_value_id'] + ']" id="custom-field-value' + custom_field['custom_field_value'][j]['custom_field_value_id'] + '"><label for="custom-field-value' + custom_field['custom_field_value'][j]['custom_field_value_id'] + '">' + custom_field['custom_field_value'][j]['name'] + '</label><br />';
+					}
+
+					html += '</td>';
+				}
+
+				// Checkbox
+				if (custom_field['type'] == 'checkbox') {
+					html += '<td>';
+
+					for (j = 0; j < custom_field['custom_field_value'].length; j++) {
+						html += '<input type="checkbox" name="custom_field[' + custom_field['custom_field_value'][j]['custom_field_value_id'] + '][]" id="custom-field-value' + custom_field['custom_field_value'][j]['custom_field_value_id'] + '"> <label for="custom-field-value' + custom_field['custom_field_value'][j]['custom_field_value_id'] + '">' + custom_field['custom_field_value'][j]['name'] + '</label><br />';
+					}
+
+					html += '</td>';
+				}
+
+				// Text
+				if (custom_field['type'] == 'text') {
+					html += '<td><input type="text" name="custom_field[' + custom_field['custom_field_id'] + ']" value="' + custom_field['value'] + '" /></td>'
+				}
+
+				// Textarea
+				if (custom_field['type'] == 'textarea') {
+					html += '<td><textarea name="custom_field[' + custom_field['custom_field_id'] + ']" cols="40" rows="5">' + custom_field['value'] + '</textarea></td>'
+				}
+
+				// File
+				if (custom_field['type'] == 'file') {
+					html += '<td><input type="button" value="<?php echo $button_upload; ?>" id="button-custom-field' + custom_field['custom_field_id'] + '" class="button" onclick="upload(\'' + custom_field['custom_field_id'] + '\');" /><input type="hidden" name="custom_field[' + custom_field['custom_field_id'] + ']" value="" /></td>';
+				}
+
+				// Date
+				if (custom_field['type'] == 'date') {
+					html += '<td><input type="text" name="custom_field[' + custom_field['custom_field_id'] + ']" value="' + custom_field['value'] + '" class="date" /></td>';
+				}
+
+				// Datetime
+				if (custom_field['type'] == 'datetime') {
+					html += '<td><input type="text" name="custom_field[' + custom_field['custom_field_id'] + ']" value="' + custom_field['value'] + '" class="datetime" /></td>';
+				}
+
+				// Time
+				if (custom_field['type'] == 'time') {
+					html += '<td><input type="text" name="custom_field[' + custom_field['custom_field_id'] + ']" value="' + custom_field['value'] + '" class="time" /></td>';
+				}
+
+				html += '<tr>';
+
+				if (custom_field['position'] == 'begining') {
+					$('input[name=\'firstname\']').parent().parent().before(html);
+				} else if (custom_field['position'] == 'customer_group_id' || custom_field['position'] == 'country_id' || custom_field['position'] == 'zone_id') {
+					$('select[name=\'' + custom_field['position'] + '\']').parent().parent().after(html)
+				} else {
+					$('input[name=\'' + custom_field['position'] + '\']').parent().parent().after(html);
+				}
+			}
+
+			if ($.browser.msie && $.browser.version == 6) {
+				$('.date, .datetime, .time').bgIframe();
+			}
+
+			$('.date').datepicker({dateFormat: 'yy-mm-dd'});
+			$('.datetime').datetimepicker({
+				dateFormat: 'yy-mm-dd',
+				timeFormat: 'h:m'
+			});
+
+			$('.time').timepicker({timeFormat: 'h:m'});
+		},
+		error: function(xhr, ajaxOptions, thrownError) {
+			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+		}
+	});
+});
+
+$('select[name=\'customer_group_id\']').trigger('change');
+
+function upload(custom_field_id) {
+	$('#file').off();
+
+	$('#file').on('change', function() {
+		$.ajax({
+			url: 'index.php?route=account/register/upload',
+			type: 'post',
+			dataType: 'json',
+			data: new FormData($(this).parent()[0]),
+			beforeSend: function() {
+				$('#button-custom-field' + custom_field_id).after('<img src="catalog/view/theme/default/image/loading.gif" class="loading" style="padding-left: 5px;" />');
+				$('#button-custom-field' + custom_field_id).attr('disabled', true);
+				$('#custom-field' + custom_field_id + ' + .error').remove();
+			},
+			complete: function() {
+				$('.loading').remove();
+				$('#button-custom-field' + custom_field_id).attr('disabled', false);
+			},
+			success: function(json) {
+				if (json['error']) {
+					$('#custom-field' + custom_field_id).after('<span class="error">' + json['error'] + '</span>');
+				}
+
+				if (json['success']) {
+					alert(json['success']);
+
+					$('input[name=\'custom_field[' + custom_field_id + ']\']').attr('value', json['file']);
+				}
+			},
+			error: function(xhr, ajaxOptions, thrownError) {
+				alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+			},
+			cache: false,
+			contentType: false,
+			processData: false
+		});
+	});
+
+	$('input[name=\'file\']').click();
+}
+//--></script>
+<script type="text/javascript"><!--
+$('select[name=\'country_id\']').on('change', function() {
+	$.ajax({
+		url: 'index.php?route=account/register/country&country_id=' + this.value,
+		dataType: 'json',
+		beforeSend: function() {
+			$('select[name=\'country_id\']').after('<img src="catalog/view/theme/default/image/loading.gif" class="loading" style="padding-left: 5px;" />');
+		},
+		complete: function() {
+			$('.loading').remove();
+		},
+		success: function(json) {
+			if (json['postcode_required'] == '1') {
+				$('#postcode-required').show();
+			} else {
+				$('#postcode-required').hide();
+			}
+
+			html = '<option value=""><?php echo $text_select; ?></option>';
+
+			if (json['zone'] != '') {
+				for (i = 0; i < json['zone'].length; i++) {
+        			html += '<option value="' + json['zone'][i]['zone_id'] + '"';
+
+					if (json['zone'][i]['zone_id'] == '<?php echo $zone_id; ?>') {
+	      				html += ' selected="selected"';
+	    			}
+
+	    			html += '>' + json['zone'][i]['name'] + '</option>';
+				}
+			} else {
+				html += '<option value="0" selected="selected"><?php echo $text_none; ?></option>';
+			}
+
+			$('select[name=\'zone_id\']').html(html);
+		},
+		error: function(xhr, ajaxOptions, thrownError) {
+			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+		}
+	});
+});
+
+$('select[name=\'country_id\']').trigger('change');
+//--></script>
+<script type="text/javascript" src="catalog/view/javascript/jquery/ui/jquery-ui-timepicker-addon.js"></script>
 <script type="text/javascript"><!--
-$('.colorbox').colorbox({
-	width: 560,
-	height: 560
+$(document).ready(function() {
+	$('.colorbox').colorbox({
+		width: 640,
+		height: 480
+	});
 });
-//--></script> 
+//--></script>
 <?php echo $footer; ?>
\ No newline at end of file
diff --git a/catalog/view/theme/default/template/account/return_form.tpl b/catalog/view/theme/default/template/account/return_form.tpl
index 9beacc6..4c1efb4 100644
--- a/catalog/view/theme/default/template/account/return_form.tpl
+++ b/catalog/view/theme/default/template/account/return_form.tpl
@@ -127,17 +127,39 @@
         </div>
       </div>
     </div>
+    <?php if ($text_agree) { ?>
+    <div class="buttons">
+      <div class="left"><a href="<?php echo $back; ?>" class="button"><?php echo $button_back; ?></a></div>
+      <div class="right"><?php echo $text_agree; ?>
+        <?php if ($agree) { ?>
+        <input type="checkbox" name="agree" value="1" checked="checked" />
+        <?php } else { ?>
+        <input type="checkbox" name="agree" value="1" />
+        <?php } ?>
+        <input type="submit" value="<?php echo $button_continue; ?>" class="button" />
+      </div>
+    </div>
+    <?php } else { ?>
     <div class="buttons">
       <div class="left"><a href="<?php echo $back; ?>" class="button"><?php echo $button_back; ?></a></div>
       <div class="right">
         <input type="submit" value="<?php echo $button_continue; ?>" class="button" />
       </div>
     </div>
+    <?php } ?>
   </form>
   <?php echo $content_bottom; ?></div>
 <script type="text/javascript"><!--
 $(document).ready(function() {
 	$('.date').datepicker({dateFormat: 'yy-mm-dd'});
 });
-//--></script> 
+//--></script>
+<script type="text/javascript"><!--
+$(document).ready(function() {
+	$('.colorbox').colorbox({
+		width: 640,
+		height: 480
+	});
+});
+//--></script>
 <?php echo $footer; ?>
\ No newline at end of file
diff --git a/catalog/view/theme/default/template/account/return_info.tpl b/catalog/view/theme/default/template/account/return_info.tpl
index 603c0b0..96b87fa 100644
--- a/catalog/view/theme/default/template/account/return_info.tpl
+++ b/catalog/view/theme/default/template/account/return_info.tpl
@@ -54,8 +54,8 @@
       </tr>
     </tbody>
   </table>
+  <?php if ($comment) { ?>
   <table class="list">
-    <?php if ($comment) { ?>
     <thead>
       <tr>
         <td class="left"><?php echo $text_comment; ?></td>
diff --git a/catalog/view/theme/default/template/affiliate/edit.tpl b/catalog/view/theme/default/template/affiliate/edit.tpl
index ab7ee43..7e30689 100644
--- a/catalog/view/theme/default/template/affiliate/edit.tpl
+++ b/catalog/view/theme/default/template/affiliate/edit.tpl
@@ -78,7 +78,7 @@
             <?php } ?></td>
         </tr>
         <tr>
-          <td><span class="required">*</span> <?php echo $entry_postcode; ?></td>
+          <td><span id="postcode-required" class="required">*</span> <?php echo $entry_postcode; ?></td>
           <td><input type="text" name="postcode" value="<?php echo $postcode; ?>" />
             <?php if ($error_postcode) { ?>
             <span class="error"><?php echo $error_postcode; ?></span>
@@ -86,7 +86,7 @@
         </tr>
         <tr>
           <td><span class="required">*</span> <?php echo $entry_country; ?></td>
-          <td><select name="country_id" onchange="$('select[name=\'zone_id\']').load('index.php?route=affiliate/edit/zone&country_id=' + this.value + '&zone_id=<?php echo $zone_id; ?>');">
+          <td><select name="country_id">
               <option value="false"><?php echo $text_select; ?></option>
               <?php foreach ($countries as $country) { ?>
               <?php if ($country['country_id'] == $country_id) { ?>
@@ -119,6 +119,47 @@
   </form>
   <?php echo $content_bottom; ?></div>
 <script type="text/javascript"><!--
-$('select[name=\'zone_id\']').load('index.php?route=affiliate/edit/zone&country_id=<?php echo $country_id; ?>&zone_id=<?php echo $zone_id; ?>');
-//--></script> 
+$('select[name=\'country_id\']').on('change', function() {
+	$.ajax({
+		url: 'index.php?route=affiliate/edit/country&country_id=' + this.value,
+		dataType: 'json',
+		beforeSend: function() {
+			$('select[name=\'country_id\']').after('<img src="catalog/view/theme/default/image/loading.gif" class="loading" style="padding-left: 5px;" />');
+		},
+		complete: function() {
+			$('.loading').remove();
+		},
+		success: function(json) {
+			if (json['postcode_required'] == '1') {
+				$('#postcode-required').show();
+			} else {
+				$('#postcode-required').hide();
+			}
+
+			html = '<option value=""><?php echo $text_select; ?></option>';
+
+			if (json['zone'] != '') {
+				for (i = 0; i < json['zone'].length; i++) {
+        			html += '<option value="' + json['zone'][i]['zone_id'] + '"';
+
+					if (json['zone'][i]['zone_id'] == '<?php echo $zone_id; ?>') {
+	      				html += ' selected="selected"';
+	    			}
+
+	    			html += '>' + json['zone'][i]['name'] + '</option>';
+				}
+			} else {
+				html += '<option value="0" selected="selected"><?php echo $text_none; ?></option>';
+			}
+
+			$('select[name=\'zone_id\']').html(html);
+		},
+		error: function(xhr, ajaxOptions, thrownError) {
+			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+		}
+	});
+});
+
+$('select[name=\'country_id\']').trigger('change');
+//--></script>
 <?php echo $footer; ?>
\ No newline at end of file
diff --git a/catalog/view/theme/default/template/affiliate/login.tpl b/catalog/view/theme/default/template/affiliate/login.tpl
index a2974ca..fc895e3 100644
--- a/catalog/view/theme/default/template/affiliate/login.tpl
+++ b/catalog/view/theme/default/template/affiliate/login.tpl
@@ -25,11 +25,11 @@
         <div class="content">
           <p><?php echo $text_i_am_returning_affiliate; ?></p>
           <b><?php echo $entry_email; ?></b><br />
-          <input type="text" name="email" value="" />
+          <input type="text" name="email" value="<?php echo $email; ?>" />
           <br />
           <br />
           <b><?php echo $entry_password; ?></b><br />
-          <input type="password" name="password" value="" />
+          <input type="password" name="password" value="<?php echo $password; ?>" />
           <br />
           <a href="<?php echo $forgotten; ?>"><?php echo $text_forgotten; ?></a><br />
           <br />
diff --git a/catalog/view/theme/default/template/affiliate/payment.tpl b/catalog/view/theme/default/template/affiliate/payment.tpl
index b71ef84..8d3b94a 100644
--- a/catalog/view/theme/default/template/affiliate/payment.tpl
+++ b/catalog/view/theme/default/template/affiliate/payment.tpl
@@ -80,12 +80,12 @@
   </form>
   <?php echo $content_bottom; ?></div>
 <script type="text/javascript"><!--
-$('input[name=\'payment\']').bind('change', function() {
+$('input[name=\'payment\']').on('change', function() {
 	$('.payment').hide();
-	
+
 	$('#payment-' + this.value).show();
 });
 
 $('input[name=\'payment\']:checked').trigger('change');
-//--></script> 
-<?php echo $footer; ?> 
\ No newline at end of file
+//--></script>
+<?php echo $footer; ?>
\ No newline at end of file
diff --git a/catalog/view/theme/default/template/affiliate/register.tpl b/catalog/view/theme/default/template/affiliate/register.tpl
index 9e886ca..b7d2d26 100644
--- a/catalog/view/theme/default/template/affiliate/register.tpl
+++ b/catalog/view/theme/default/template/affiliate/register.tpl
@@ -80,7 +80,7 @@
             <?php } ?></td>
         </tr>
         <tr>
-          <td><span class="required">*</span> <?php echo $entry_postcode; ?></td>
+          <td><span id="postcode-required" class="required">*</span> <?php echo $entry_postcode; ?></td>
           <td><input type="text" name="postcode" value="<?php echo $postcode; ?>" />
             <?php if ($error_postcode) { ?>
             <span class="error"><?php echo $error_postcode; ?></span>
@@ -88,7 +88,7 @@
         </tr>
         <tr>
           <td><span class="required">*</span> <?php echo $entry_country; ?></td>
-          <td><select name="country_id" onchange="$('select[name=\'zone_id\']').load('index.php?route=account/register/zone&country_id=' + this.value + '&zone_id=<?php echo $zone_id; ?>');">
+          <td><select name="country_id">
               <option value="false"><?php echo $text_select; ?></option>
               <?php foreach ($countries as $country) { ?>
               <?php if ($country['country_id'] == $country_id) { ?>
@@ -218,21 +218,64 @@
   </form>
   <?php echo $content_bottom; ?></div>
 <script type="text/javascript"><!--
-$('select[name=\'zone_id\']').load('index.php?route=account/register/zone&country_id=<?php echo $country_id; ?>&zone_id=<?php echo $zone_id; ?>');
-//--></script> 
+$('select[name=\'country_id\']').on('change', function() {
+	$.ajax({
+		url: 'index.php?route=affiliate/register/country&country_id=' + this.value,
+		dataType: 'json',
+		beforeSend: function() {
+			$('select[name=\'country_id\']').after('<img src="catalog/view/theme/default/image/loading.gif" class="loading" style="padding-left: 5px;" />');
+		},
+		complete: function() {
+			$('.loading').remove();
+		},
+		success: function(json) {
+			if (json['postcode_required'] == '1') {
+				$('#postcode-required').show();
+			} else {
+				$('#postcode-required').hide();
+			}
+
+			html = '<option value=""><?php echo $text_select; ?></option>';
+
+			if (json['zone'] != '') {
+				for (i = 0; i < json['zone'].length; i++) {
+        			html += '<option value="' + json['zone'][i]['zone_id'] + '"';
+
+					if (json['zone'][i]['zone_id'] == '<?php echo $zone_id; ?>') {
+	      				html += ' selected="selected"';
+	    			}
+
+	    			html += '>' + json['zone'][i]['name'] + '</option>';
+				}
+			} else {
+				html += '<option value="0" selected="selected"><?php echo $text_none; ?></option>';
+			}
+
+			$('select[name=\'zone_id\']').html(html);
+		},
+		error: function(xhr, ajaxOptions, thrownError) {
+			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+		}
+	});
+});
+
+$('select[name=\'country_id\']').trigger('change');
+//--></script>
 <script type="text/javascript"><!--
-$('input[name=\'payment\']').bind('change', function() {
+$('input[name=\'payment\']').on('change', function() {
 	$('.payment').hide();
-	
+
 	$('#payment-' + this.value).show();
 });
 
 $('input[name=\'payment\']:checked').trigger('change');
-//--></script> 
+//--></script>
 <script type="text/javascript"><!--
-$('.colorbox').colorbox({
-	width: 560,
-	height: 560
+$(document).ready(function() {
+	$('.colorbox').colorbox({
+		width: 640,
+		height: 480
+	});
 });
-//--></script> 
+//--></script>
 <?php echo $footer; ?>
\ No newline at end of file
diff --git a/catalog/view/theme/default/template/affiliate/tracking.tpl b/catalog/view/theme/default/template/affiliate/tracking.tpl
index 2eb550c..2d70e08 100644
--- a/catalog/view/theme/default/template/affiliate/tracking.tpl
+++ b/catalog/view/theme/default/template/affiliate/tracking.tpl
@@ -22,12 +22,12 @@
   <?php echo $content_bottom; ?></div>
 <script type="text/javascript"><!--
 $('input[name=\'product\']').autocomplete({
-	delay: 0,
+	delay: 500,
 	source: function(request, response) {
 		$.ajax({
 			url: 'index.php?route=affiliate/tracking/autocomplete&filter_name=' +  encodeURIComponent(request.term),
 			dataType: 'json',
-			success: function(json) {		
+			success: function(json) {
 				response($.map(json, function(item) {
 					return {
 						label: item.name,
@@ -40,9 +40,12 @@ $('input[name=\'product\']').autocomplete({
 	select: function(event, ui) {
 		$('input[name=\'product\']').attr('value', ui.item.label);
 		$('textarea[name=\'link\']').attr('value', ui.item.value);
-						
+
 		return false;
-	}
+	},
+	focus: function(event, ui) {
+      return false;
+   }
 });
-//--></script> 
+//--></script>
 <?php echo $footer; ?>
\ No newline at end of file
diff --git a/catalog/view/theme/default/template/checkout/cart.tpl b/catalog/view/theme/default/template/checkout/cart.tpl
index c5243c0..7920c93 100644
--- a/catalog/view/theme/default/template/checkout/cart.tpl
+++ b/catalog/view/theme/default/template/checkout/cart.tpl
@@ -66,7 +66,7 @@
             <td class="name"><?php echo $vouchers['description']; ?></td>
             <td class="model"></td>
             <td class="quantity"><input type="text" name="" value="1" size="1" disabled="disabled" />
-              &nbsp;<a href="<?php echo $vouchers['remove']; ?>"><img src="catalog/view/theme/default/image/remove.png" alt="<?php echo $text_remove; ?>" title="<?php echo $button_remove; ?>" /></a></td>
+              &nbsp;<a href="<?php echo $vouchers['remove']; ?>"><img src="catalog/view/theme/default/image/remove.png" alt="<?php echo $button_remove; ?>" title="<?php echo $button_remove; ?>" /></a></td>
             <td class="price"><?php echo $vouchers['amount']; ?></td>
             <td class="total"><?php echo $vouchers['amount']; ?></td>
           </tr>
@@ -82,32 +82,48 @@
     <table class="radio">
       <?php if ($coupon_status) { ?>
       <tr class="highlight">
-        <td><input type="radio" name="next" value="coupon" id="use_coupon" /></td>
+        <td><?php if ($next == 'coupon') { ?>
+          <input type="radio" name="next" value="coupon" id="use_coupon" checked="checked" />
+          <?php } else { ?>
+          <input type="radio" name="next" value="coupon" id="use_coupon" />
+          <?php } ?></td>
         <td><label for="use_coupon"><?php echo $text_use_coupon; ?></label></td>
       </tr>
       <?php } ?>
       <?php if ($voucher_status) { ?>
       <tr class="highlight">
-        <td><input type="radio" name="next" value="voucher" id="use_voucher" /></td>
+        <td><?php if ($next == 'voucher') { ?>
+          <input type="radio" name="next" value="voucher" id="use_voucher" checked="checked" />
+          <?php } else { ?>
+          <input type="radio" name="next" value="voucher" id="use_voucher" />
+          <?php } ?></td>
         <td><label for="use_voucher"><?php echo $text_use_voucher; ?></label></td>
       </tr>
       <?php } ?>
       <?php if ($reward_status) { ?>
       <tr class="highlight">
-        <td><input type="radio" name="next" value="reward" id="use_reward" /></td>
+        <td><?php if ($next == 'reward') { ?>
+          <input type="radio" name="next" value="reward" id="use_reward" checked="checked" />
+          <?php } else { ?>
+          <input type="radio" name="next" value="reward" id="use_reward" />
+          <?php } ?></td>
         <td><label for="use_reward"><?php echo $text_use_reward; ?></label></td>
       </tr>
       <?php } ?>
       <?php if ($shipping_status) { ?>
       <tr class="highlight">
-        <td><input type="radio" name="next" value="shipping" id="shipping_estimate" /></td>
+        <td><?php if ($next == 'shipping') { ?>
+          <input type="radio" name="next" value="shipping" id="shipping_estimate" checked="checked" />
+          <?php } else { ?>
+          <input type="radio" name="next" value="shipping" id="shipping_estimate" />
+          <?php } ?></td>
         <td><label for="shipping_estimate"><?php echo $text_shipping_estimate; ?></label></td>
       </tr>
       <?php } ?>
     </table>
   </div>
   <div class="cart-module">
-    <div id="coupon" class="content">
+    <div id="coupon" class="content" style="display: <?php echo ($next == 'coupon' ? 'block' : 'none'); ?>;">
       <form action="<?php echo $action; ?>" method="post" enctype="multipart/form-data">
         <?php echo $entry_coupon; ?>&nbsp;
         <input type="text" name="coupon" value="<?php echo $coupon; ?>" />
@@ -116,7 +132,7 @@
         <input type="submit" value="<?php echo $button_coupon; ?>" class="button" />
       </form>
     </div>
-    <div id="voucher" class="content">
+    <div id="voucher" class="content" style="display: <?php echo ($next == 'voucher' ? 'block' : 'none'); ?>;">
       <form action="<?php echo $action; ?>" method="post" enctype="multipart/form-data">
         <?php echo $entry_voucher; ?>&nbsp;
         <input type="text" name="voucher" value="<?php echo $voucher; ?>" />
@@ -125,7 +141,7 @@
         <input type="submit" value="<?php echo $button_voucher; ?>" class="button" />
       </form>
     </div>
-    <div id="reward" class="content">
+    <div id="reward" class="content" style="display: <?php echo ($next == 'reward' ? 'block' : 'none'); ?>;">
       <form action="<?php echo $action; ?>" method="post" enctype="multipart/form-data">
         <?php echo $entry_reward; ?>&nbsp;
         <input type="text" name="reward" value="<?php echo $reward; ?>" />
@@ -134,12 +150,12 @@
         <input type="submit" value="<?php echo $button_reward; ?>" class="button" />
       </form>
     </div>
-    <div id="shipping" class="content">
+    <div id="shipping" class="content" style="display: <?php echo ($next == 'shipping' ? 'block' : 'none'); ?>;">
       <p><?php echo $text_shipping_detail; ?></p>
       <table>
         <tr>
           <td><span class="required">*</span> <?php echo $entry_country; ?></td>
-          <td><select name="country_id" onchange="$('select[name=\'zone_id\']').load('index.php?route=checkout/cart/zone&country_id=' + this.value + '&zone_id=<?php echo $zone_id; ?>');">
+          <td><select name="country_id">
               <option value=""><?php echo $text_select; ?></option>
               <?php foreach ($countries as $country) { ?>
               <?php if ($country['country_id'] == $country_id) { ?>
@@ -156,48 +172,36 @@
             </select></td>
         </tr>
         <tr>
-          <td><span class="required">*</span> <?php echo $entry_postcode; ?></td>
+          <td><span id="postcode-required" class="required">*</span> <?php echo $entry_postcode; ?></td>
           <td><input type="text" name="postcode" value="<?php echo $postcode; ?>" /></td>
         </tr>
       </table>
       <input type="button" value="<?php echo $button_quote; ?>" id="button-quote" class="button" />
     </div>
-    <?php } ?>
   </div>
+  <?php } ?>
   <div class="cart-total">
     <table id="total">
       <?php foreach ($totals as $total) { ?>
       <tr>
-        <td colspan="5" class="right"><b><?php echo $total['title']; ?>:</b></td>
+        <td class="right"><b><?php echo $total['title']; ?>:</b></td>
         <td class="right"><?php echo $total['text']; ?></td>
       </tr>
       <?php } ?>
     </table>
   </div>
+  <?php echo $google_checkout; ?>
   <div class="buttons">
     <div class="right"><a href="<?php echo $checkout; ?>" class="button"><?php echo $button_checkout; ?></a></div>
     <div class="center"><a href="<?php echo $continue; ?>" class="button"><?php echo $button_shopping; ?></a></div>
   </div>
   <?php echo $content_bottom; ?></div>
 <script type="text/javascript"><!--
-$('input[name=\'next\']').bind('change', function() {
+$('input[name=\'next\']').on('change', function() {
 	$('.cart-module > div').hide();
-	
+
 	$('#' + this.value).show();
 });
-
-<?php if ($next == 'coupon') { ?>
-$('#use_coupon').trigger('click');
-<?php } ?>
-<?php if ($next == 'voucher') { ?>
-$('#use_voucher').trigger('click');
-<?php } ?>
-<?php if ($next == 'reward') { ?>
-$('#use_reward').trigger('click');
-<?php } ?>
-<?php if ($next == 'shipping') { ?>
-$('#shipping_estimate').trigger('click');
-<?php } ?>
 //--></script>
 <?php if ($shipping_status) { ?>
 <script type="text/javascript"><!--
@@ -206,77 +210,83 @@ $('#button-quote').live('click', function() {
 		url: 'index.php?route=checkout/cart/quote',
 		type: 'post',
 		data: 'country_id=' + $('select[name=\'country_id\']').val() + '&zone_id=' + $('select[name=\'zone_id\']').val() + '&postcode=' + encodeURIComponent($('input[name=\'postcode\']').val()),
-		dataType: 'json',		
+		dataType: 'json',
 		beforeSend: function() {
 			$('#button-quote').attr('disabled', true);
-			$('#button-quote').after('<span class="wait">&nbsp;<img src="catalog/view/theme/default/image/loading.gif" alt="" /></span>');
+			$('#button-quote').after('<img src="catalog/view/theme/default/image/loading.gif" class="loading" style="padding-left: 5px;" />');
 		},
 		complete: function() {
 			$('#button-quote').attr('disabled', false);
-			$('.wait').remove();
-		},		
+			$('.loading').remove();
+		},
 		success: function(json) {
-			$('.success, .warning, .attention, .error').remove();			
-						
+			$('.success, .warning, .attention, .error').remove();
+
 			if (json['error']) {
 				if (json['error']['warning']) {
 					$('#notification').html('<div class="warning" style="display: none;">' + json['error']['warning'] + '<img src="catalog/view/theme/default/image/close.png" alt="" class="close" /></div>');
-					
+
 					$('.warning').fadeIn('slow');
-					
-					$('html, body').animate({ scrollTop: 0 }, 'slow'); 
-				}	
-							
+
+					$('html, body').animate({ scrollTop: 0 }, 'slow');
+				}
+
 				if (json['error']['country']) {
 					$('select[name=\'country_id\']').after('<span class="error">' + json['error']['country'] + '</span>');
-				}	
-				
+				}
+
 				if (json['error']['zone']) {
 					$('select[name=\'zone_id\']').after('<span class="error">' + json['error']['zone'] + '</span>');
 				}
-				
+
 				if (json['error']['postcode']) {
 					$('input[name=\'postcode\']').after('<span class="error">' + json['error']['postcode'] + '</span>');
-				}					
+				}
 			}
-			
+
 			if (json['shipping_method']) {
 				html  = '<h2><?php echo $text_shipping_method; ?></h2>';
 				html += '<form action="<?php echo $action; ?>" method="post" enctype="multipart/form-data">';
 				html += '  <table class="radio">';
-				
+
 				for (i in json['shipping_method']) {
 					html += '<tr>';
 					html += '  <td colspan="3"><b>' + json['shipping_method'][i]['title'] + '</b></td>';
 					html += '</tr>';
-				
+
 					if (!json['shipping_method'][i]['error']) {
 						for (j in json['shipping_method'][i]['quote']) {
 							html += '<tr class="highlight">';
-							
+
 							if (json['shipping_method'][i]['quote'][j]['code'] == '<?php echo $shipping_method; ?>') {
 								html += '<td><input type="radio" name="shipping_method" value="' + json['shipping_method'][i]['quote'][j]['code'] + '" id="' + json['shipping_method'][i]['quote'][j]['code'] + '" checked="checked" /></td>';
 							} else {
 								html += '<td><input type="radio" name="shipping_method" value="' + json['shipping_method'][i]['quote'][j]['code'] + '" id="' + json['shipping_method'][i]['quote'][j]['code'] + '" /></td>';
 							}
-								
+
 							html += '  <td><label for="' + json['shipping_method'][i]['quote'][j]['code'] + '">' + json['shipping_method'][i]['quote'][j]['title'] + '</label></td>';
 							html += '  <td style="text-align: right;"><label for="' + json['shipping_method'][i]['quote'][j]['code'] + '">' + json['shipping_method'][i]['quote'][j]['text'] + '</label></td>';
 							html += '</tr>';
-						}		
+						}
 					} else {
 						html += '<tr>';
 						html += '  <td colspan="3"><div class="error">' + json['shipping_method'][i]['error'] + '</div></td>';
-						html += '</tr>';						
+						html += '</tr>';
 					}
 				}
-				
+
 				html += '  </table>';
 				html += '  <br />';
 				html += '  <input type="hidden" name="next" value="shipping" />';
-				html += '  <input type="submit" value="<?php echo $button_shipping; ?>" class="button" />';				
+
+				<?php if ($shipping_method) { ?>
+				html += '  <input type="submit" value="<?php echo $button_shipping; ?>" id="button-shipping" class="button" />';
+				<?php } else { ?>
+				html += '  <input type="submit" value="<?php echo $button_shipping; ?>" id="button-shipping" class="button" disabled="disabled" />';
+				<?php } ?>
+
 				html += '</form>';
-				
+
 				$.colorbox({
 					overlayClose: true,
 					opacity: 0.5,
@@ -285,13 +295,58 @@ $('#button-quote').live('click', function() {
 					href: false,
 					html: html
 				});
+
+				$('input[name=\'shipping_method\']').on('change', function() {
+					$('#button-shipping').attr('disabled', false);
+				});
 			}
 		}
 	});
 });
-//--></script> 
+//--></script>
 <script type="text/javascript"><!--
-$('select[name=\'zone_id\']').load('index.php?route=checkout/cart/zone&country_id=<?php echo $country_id; ?>&zone_id=<?php echo $zone_id; ?>');
+$('select[name=\'country_id\']').on('change', function() {
+	$.ajax({
+		url: 'index.php?route=checkout/cart/country&country_id=' + this.value,
+		dataType: 'json',
+		beforeSend: function() {
+			$('select[name=\'country_id\']').after('<img src="catalog/view/theme/default/image/loading.gif" class="loading" style="padding-left: 5px;" />');
+		},
+		complete: function() {
+			$('.loading').remove();
+		},
+		success: function(json) {
+			if (json['postcode_required'] == '1') {
+				$('#postcode-required').show();
+			} else {
+				$('#postcode-required').hide();
+			}
+
+			html = '<option value=""><?php echo $text_select; ?></option>';
+
+			if (json['zone'] != '') {
+				for (i = 0; i < json['zone'].length; i++) {
+        			html += '<option value="' + json['zone'][i]['zone_id'] + '"';
+
+					if (json['zone'][i]['zone_id'] == '<?php echo $zone_id; ?>') {
+	      				html += ' selected="selected"';
+	    			}
+
+	    			html += '>' + json['zone'][i]['name'] + '</option>';
+				}
+			} else {
+				html += '<option value="0" selected="selected"><?php echo $text_none; ?></option>';
+			}
+
+			$('select[name=\'zone_id\']').html(html);
+		},
+		error: function(xhr, ajaxOptions, thrownError) {
+			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+		}
+	});
+});
+
+$('select[name=\'country_id\']').trigger('change');
 //--></script>
 <?php } ?>
 <?php echo $footer; ?>
\ No newline at end of file
diff --git a/catalog/view/theme/default/template/checkout/checkout.tpl b/catalog/view/theme/default/template/checkout/checkout.tpl
index dc66faf..43ebca5 100644
--- a/catalog/view/theme/default/template/checkout/checkout.tpl
+++ b/catalog/view/theme/default/template/checkout/checkout.tpl
@@ -43,845 +43,40 @@
   </div>
   <?php echo $content_bottom; ?></div>
 <script type="text/javascript"><!--
-$('#checkout .checkout-content input[name=\'account\']').live('change', function() {
-	if ($(this).attr('value') == 'register') {
-		$('#payment-address .checkout-heading span').html('<?php echo $text_checkout_account; ?>');
-	} else {
-		$('#payment-address .checkout-heading span').html('<?php echo $text_checkout_payment_address; ?>');
-	}
-});
-
-$('.checkout-heading a').live('click', function() {
-	$('.checkout-content').slideUp('slow');
-	
-	$(this).parent().parent().find('.checkout-content').slideDown('slow');
-});
-<?php if (!$logged) { ?> 
 $(document).ready(function() {
+	<?php if (!$logged) { ?>
 	$.ajax({
 		url: 'index.php?route=checkout/login',
 		dataType: 'html',
 		success: function(html) {
 			$('#checkout .checkout-content').html(html);
-				
+
 			$('#checkout .checkout-content').slideDown('slow');
 		},
 		error: function(xhr, ajaxOptions, thrownError) {
 			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
 		}
-	});	
-});		
+	});
 <?php } else { ?>
-$(document).ready(function() {
 	$.ajax({
 		url: 'index.php?route=checkout/payment_address',
 		dataType: 'html',
 		success: function(html) {
 			$('#payment-address .checkout-content').html(html);
-				
-			$('#payment-address .checkout-content').slideDown('slow');
-		},
-		error: function(xhr, ajaxOptions, thrownError) {
-			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
-		}
-	});	
-});
-<?php } ?>
 
-// Checkout
-$('#button-account').live('click', function() {
-	$.ajax({
-		url: 'index.php?route=checkout/' + $('input[name=\'account\']:checked').attr('value'),
-		dataType: 'html',
-		beforeSend: function() {
-			$('#button-account').attr('disabled', true);
-			$('#button-account').after('<span class="wait">&nbsp;<img src="catalog/view/theme/default/image/loading.gif" alt="" /></span>');
-		},		
-		complete: function() {
-			$('#button-account').attr('disabled', false);
-			$('.wait').remove();
-		},			
-		success: function(html) {
-			$('.warning').remove();
-			
-			$('#payment-address .checkout-content').html(html);
-				
-			$('#checkout .checkout-content').slideUp('slow');
-				
 			$('#payment-address .checkout-content').slideDown('slow');
-				
-			$('.checkout-heading a').remove();
-				
-			$('#checkout .checkout-heading').append('<a><?php echo $text_modify; ?></a>');
 		},
 		error: function(xhr, ajaxOptions, thrownError) {
 			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
 		}
 	});
+<?php } ?>
 });
 
-// Login
-$('#button-login').live('click', function() {
-	$.ajax({
-		url: 'index.php?route=checkout/login/validate',
-		type: 'post',
-		data: $('#checkout #login :input'),
-		dataType: 'json',
-		beforeSend: function() {
-			$('#button-login').attr('disabled', true);
-			$('#button-login').after('<span class="wait">&nbsp;<img src="catalog/view/theme/default/image/loading.gif" alt="" /></span>');
-		},	
-		complete: function() {
-			$('#button-login').attr('disabled', false);
-			$('.wait').remove();
-		},				
-		success: function(json) {
-			$('.warning').remove();
-			
-			if (json['redirect']) {
-				location = json['redirect'];
-			}
-									
-			if (json['error']) {
-				$('#checkout .checkout-content').prepend('<div class="warning" style="display: none;">' + json['error']['warning'] + '</div>');
-				
-				$('.warning').fadeIn('slow');
-			}
-		},
-		error: function(xhr, ajaxOptions, thrownError) {
-			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
-		}
-	});	
-});
-
-// Register
-$('#button-register').live('click', function() {
-	$.ajax({
-		url: 'index.php?route=checkout/register/validate',
-		type: 'post',
-		data: $('#payment-address input[type=\'text\'], #payment-address input[type=\'password\'], #payment-address input[type=\'checkbox\']:checked, #payment-address input[type=\'radio\']:checked, #payment-address input[type=\'hidden\'], #payment-address select'),
-		dataType: 'json',
-		beforeSend: function() {
-			$('#button-register').attr('disabled', true);
-			$('#button-register').after('<span class="wait">&nbsp;<img src="catalog/view/theme/default/image/loading.gif" alt="" /></span>');
-		},	
-		complete: function() {
-			$('#button-register').attr('disabled', false); 
-			$('.wait').remove();
-		},			
-		success: function(json) {
-			$('.warning, .error').remove();
-						
-			if (json['redirect']) {
-				location = json['redirect'];
-			}
-						
-			if (json['error']) {
-				if (json['error']['warning']) {
-					$('#payment-address .checkout-content').prepend('<div class="warning" style="display: none;">' + json['error']['warning'] + '</div>');
-					
-					$('.warning').fadeIn('slow');
-				}
-				
-				if (json['error']['firstname']) {
-					$('#payment-address input[name=\'firstname\'] + br').after('<span class="error">' + json['error']['firstname'] + '</span>');
-				}
-				
-				if (json['error']['lastname']) {
-					$('#payment-address input[name=\'lastname\'] + br').after('<span class="error">' + json['error']['lastname'] + '</span>');
-				}	
-				
-				if (json['error']['email']) {
-					$('#payment-address input[name=\'email\'] + br').after('<span class="error">' + json['error']['email'] + '</span>');
-				}
-				
-				if (json['error']['telephone']) {
-					$('#payment-address input[name=\'telephone\'] + br').after('<span class="error">' + json['error']['telephone'] + '</span>');
-				}		
-										
-				if (json['error']['address_1']) {
-					$('#payment-address input[name=\'address_1\'] + br').after('<span class="error">' + json['error']['address_1'] + '</span>');
-				}	
-				
-				if (json['error']['city']) {
-					$('#payment-address input[name=\'city\'] + br').after('<span class="error">' + json['error']['city'] + '</span>');
-				}	
-				
-				if (json['error']['postcode']) {
-					$('#payment-address input[name=\'postcode\'] + br').after('<span class="error">' + json['error']['postcode'] + '</span>');
-				}	
-				
-				if (json['error']['country']) {
-					$('#payment-address select[name=\'country_id\'] + br').after('<span class="error">' + json['error']['country'] + '</span>');
-				}	
-				
-				if (json['error']['zone']) {
-					$('#payment-address select[name=\'zone_id\'] + br').after('<span class="error">' + json['error']['zone'] + '</span>');
-				}
-				
-				if (json['error']['password']) {
-					$('#payment-address input[name=\'password\'] + br').after('<span class="error">' + json['error']['password'] + '</span>');
-				}	
-				
-				if (json['error']['confirm']) {
-					$('#payment-address input[name=\'confirm\'] + br').after('<span class="error">' + json['error']['confirm'] + '</span>');
-				}																																	
-			} else {
-				<?php if ($shipping_required) { ?>				
-				var shipping_address = $('#payment-address input[name=\'shipping_address\']:checked').attr('value');
-				
-				if (shipping_address) {
-					$.ajax({
-						url: 'index.php?route=checkout/shipping_method',
-						dataType: 'html',
-						success: function(html) {
-							$('#shipping-method .checkout-content').html(html);
-							
-							$('#payment-address .checkout-content').slideUp('slow');
-							
-							$('#shipping-method .checkout-content').slideDown('slow');
-							
-							$('#checkout .checkout-heading a').remove();
-							$('#payment-address .checkout-heading a').remove();
-							$('#shipping-address .checkout-heading a').remove();
-							$('#shipping-method .checkout-heading a').remove();
-							$('#payment-method .checkout-heading a').remove();											
-							
-							$('#shipping-address .checkout-heading').append('<a><?php echo $text_modify; ?></a>');									
-							$('#payment-address .checkout-heading').append('<a><?php echo $text_modify; ?></a>');	
-
-							$.ajax({
-								url: 'index.php?route=checkout/shipping_address',
-								dataType: 'html',
-								success: function(html) {
-									$('#shipping-address .checkout-content').html(html);
-								},
-								error: function(xhr, ajaxOptions, thrownError) {
-									alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
-								}
-							});	
-						},
-						error: function(xhr, ajaxOptions, thrownError) {
-							alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
-						}
-					});	
-				} else {
-					$.ajax({
-						url: 'index.php?route=checkout/shipping_address',
-						dataType: 'html',
-						success: function(html) {
-							$('#shipping-address .checkout-content').html(html);
-							
-							$('#payment-address .checkout-content').slideUp('slow');
-							
-							$('#shipping-address .checkout-content').slideDown('slow');
-							
-							$('#checkout .checkout-heading a').remove();
-							$('#payment-address .checkout-heading a').remove();
-							$('#shipping-address .checkout-heading a').remove();
-							$('#shipping-method .checkout-heading a').remove();
-							$('#payment-method .checkout-heading a').remove();							
-
-							$('#payment-address .checkout-heading').append('<a><?php echo $text_modify; ?></a>');	
-						},
-						error: function(xhr, ajaxOptions, thrownError) {
-							alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
-						}
-					});			
-				}
-				<?php } else { ?>
-				$.ajax({
-					url: 'index.php?route=checkout/payment_method',
-					dataType: 'html',
-					success: function(html) {
-						$('#payment-method .checkout-content').html(html);
-						
-						$('#payment-address .checkout-content').slideUp('slow');
-						
-						$('#payment-method .checkout-content').slideDown('slow');
-						
-						$('#checkout .checkout-heading a').remove();
-						$('#payment-address .checkout-heading a').remove();
-						$('#payment-method .checkout-heading a').remove();								
-						
-						$('#payment-address .checkout-heading').append('<a><?php echo $text_modify; ?></a>');	
-					},
-					error: function(xhr, ajaxOptions, thrownError) {
-						alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
-					}
-				});					
-				<?php } ?>
-				
-				$.ajax({
-					url: 'index.php?route=checkout/payment_address',
-					dataType: 'html',
-					success: function(html) {
-						$('#payment-address .checkout-content').html(html);
-							
-						$('#payment-address .checkout-heading span').html('<?php echo $text_checkout_payment_address; ?>');
-					},
-					error: function(xhr, ajaxOptions, thrownError) {
-						alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
-					}
-				});
-			}	 
-		},
-		error: function(xhr, ajaxOptions, thrownError) {
-			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
-		}
-	});	
-});
-
-// Payment Address	
-$('#button-payment-address').live('click', function() {
-	$.ajax({
-		url: 'index.php?route=checkout/payment_address/validate',
-		type: 'post',
-		data: $('#payment-address input[type=\'text\'], #payment-address input[type=\'password\'], #payment-address input[type=\'checkbox\']:checked, #payment-address input[type=\'radio\']:checked, #payment-address input[type=\'hidden\'], #payment-address select'),
-		dataType: 'json',
-		beforeSend: function() {
-			$('#button-payment-address').attr('disabled', true);
-			$('#button-payment-address').after('<span class="wait">&nbsp;<img src="catalog/view/theme/default/image/loading.gif" alt="" /></span>');
-		},	
-		complete: function() {
-			$('#button-payment-address').attr('disabled', false);
-			$('.wait').remove();
-		},			
-		success: function(json) {
-			$('.error').remove();
-			
-			if (json['redirect']) {
-				location = json['redirect'];
-			}
-			
-			if (json['error']) {
-				if (json['error']['firstname']) {
-					$('#payment-address input[name=\'firstname\']').after('<span class="error">' + json['error']['firstname'] + '</span>');
-				}
-				
-				if (json['error']['lastname']) {
-					$('#payment-address input[name=\'lastname\']').after('<span class="error">' + json['error']['lastname'] + '</span>');
-				}	
-				
-				if (json['error']['telephone']) {
-					$('#payment-address input[name=\'telephone\']').after('<span class="error">' + json['error']['telephone'] + '</span>');
-				}		
-										
-				if (json['error']['address_1']) {
-					$('#payment-address input[name=\'address_1\']').after('<span class="error">' + json['error']['address_1'] + '</span>');
-				}	
-				
-				if (json['error']['city']) {
-					$('#payment-address input[name=\'city\']').after('<span class="error">' + json['error']['city'] + '</span>');
-				}	
-				
-				if (json['error']['postcode']) {
-					$('#payment-address input[name=\'postcode\']').after('<span class="error">' + json['error']['postcode'] + '</span>');
-				}	
-				
-				if (json['error']['country']) {
-					$('#payment-address select[name=\'country_id\']').after('<span class="error">' + json['error']['country'] + '</span>');
-				}	
-				
-				if (json['error']['zone']) {
-					$('#payment-address select[name=\'zone_id\']').after('<span class="error">' + json['error']['zone'] + '</span>');
-				}
-			} else {
-				<?php if ($shipping_required) { ?>
-				$.ajax({
-					url: 'index.php?route=checkout/shipping_address',
-					dataType: 'html',
-					success: function(html) {
-						$('#shipping-address .checkout-content').html(html);
-					
-						$('#payment-address .checkout-content').slideUp('slow');
-						
-						$('#shipping-address .checkout-content').slideDown('slow');
-						
-						$('#payment-address .checkout-heading a').remove();
-						$('#shipping-address .checkout-heading a').remove();
-						$('#shipping-method .checkout-heading a').remove();
-						$('#payment-method .checkout-heading a').remove();
-						
-						$('#payment-address .checkout-heading').append('<a><?php echo $text_modify; ?></a>');	
-					},
-					error: function(xhr, ajaxOptions, thrownError) {
-						alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
-					}
-				});
-				<?php } else { ?>
-				$.ajax({
-					url: 'index.php?route=checkout/payment_method',
-					dataType: 'html',
-					success: function(html) {
-						$('#payment-method .checkout-content').html(html);
-					
-						$('#payment-address .checkout-content').slideUp('slow');
-						
-						$('#payment-method .checkout-content').slideDown('slow');
-						
-						$('#payment-address .checkout-heading a').remove();
-						$('#payment-method .checkout-heading a').remove();
-													
-						$('#payment-address .checkout-heading').append('<a><?php echo $text_modify; ?></a>');	
-					},
-					error: function(xhr, ajaxOptions, thrownError) {
-						alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
-					}
-				});	
-				<?php } ?>
-				
-				$.ajax({
-					url: 'index.php?route=checkout/payment_address',
-					dataType: 'html',
-					success: function(html) {
-						$('#payment-address .checkout-content').html(html);
-					},
-					error: function(xhr, ajaxOptions, thrownError) {
-						alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
-					}
-				});					
-			}	  
-		},
-		error: function(xhr, ajaxOptions, thrownError) {
-			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
-		}
-	});	
-});
-
-// Shipping Address			
-$('#button-shipping-address').live('click', function() {
-	$.ajax({
-		url: 'index.php?route=checkout/shipping_address/validate',
-		type: 'post',
-		data: $('#shipping-address input[type=\'text\'], #shipping-address input[type=\'password\'], #shipping-address input[type=\'checkbox\']:checked, #shipping-address input[type=\'radio\']:checked, #shipping-address select'),
-		dataType: 'json',
-		beforeSend: function() {
-			$('#button-shipping-address').attr('disabled', true);
-			$('#button-shipping-address').after('<span class="wait">&nbsp;<img src="catalog/view/theme/default/image/loading.gif" alt="" /></span>');
-		},	
-		complete: function() {
-			$('#button-shipping-address').attr('disabled', false);
-			$('.wait').remove();
-		},			
-		success: function(json) {
-			$('.error').remove();
-			
-			if (json['redirect']) {
-				location = json['redirect'];
-			}
-			
-			if (json['error']) {
-				if (json['error']['firstname']) {
-					$('#shipping-address input[name=\'firstname\']').after('<span class="error">' + json['error']['firstname'] + '</span>');
-				}
-				
-				if (json['error']['lastname']) {
-					$('#shipping-address input[name=\'lastname\']').after('<span class="error">' + json['error']['lastname'] + '</span>');
-				}	
-				
-				if (json['error']['email']) {
-					$('#shipping-address input[name=\'email\']').after('<span class="error">' + json['error']['email'] + '</span>');
-				}
-				
-				if (json['error']['telephone']) {
-					$('#shipping-address input[name=\'telephone\']').after('<span class="error">' + json['error']['telephone'] + '</span>');
-				}		
-										
-				if (json['error']['address_1']) {
-					$('#shipping-address input[name=\'address_1\']').after('<span class="error">' + json['error']['address_1'] + '</span>');
-				}	
-				
-				if (json['error']['city']) {
-					$('#shipping-address input[name=\'city\']').after('<span class="error">' + json['error']['city'] + '</span>');
-				}	
-				
-				if (json['error']['postcode']) {
-					$('#shipping-address input[name=\'postcode\']').after('<span class="error">' + json['error']['postcode'] + '</span>');
-				}	
-				
-				if (json['error']['country']) {
-					$('#shipping-address select[name=\'country_id\']').after('<span class="error">' + json['error']['country'] + '</span>');
-				}	
-				
-				if (json['error']['zone']) {
-					$('#shipping-address select[name=\'zone_id\']').after('<span class="error">' + json['error']['zone'] + '</span>');
-				}
-			} else {
-				$.ajax({
-					url: 'index.php?route=checkout/shipping_method',
-					dataType: 'html',
-					success: function(html) {
-						$('#shipping-method .checkout-content').html(html);
-						
-						$('#shipping-address .checkout-content').slideUp('slow');
-						
-						$('#shipping-method .checkout-content').slideDown('slow');
-						
-						$('#shipping-address .checkout-heading a').remove();
-						$('#shipping-method .checkout-heading a').remove();
-						$('#payment-method .checkout-heading a').remove();
-						
-						$('#shipping-address .checkout-heading').append('<a><?php echo $text_modify; ?></a>');							
-						
-						$.ajax({
-							url: 'index.php?route=checkout/shipping_address',
-							dataType: 'html',
-							success: function(html) {
-								$('#shipping-address .checkout-content').html(html);
-							},
-							error: function(xhr, ajaxOptions, thrownError) {
-								alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
-							}
-						});						
-					},
-					error: function(xhr, ajaxOptions, thrownError) {
-						alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
-					}
-				});	
-			}  
-		},
-		error: function(xhr, ajaxOptions, thrownError) {
-			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
-		}
-	});	
-});
-
-// Guest
-$('#button-guest').live('click', function() {
-	$.ajax({
-		url: 'index.php?route=checkout/guest/validate',
-		type: 'post',
-		data: $('#payment-address input[type=\'text\'], #payment-address input[type=\'checkbox\']:checked, #payment-address select'),
-		dataType: 'json',
-		beforeSend: function() {
-			$('#button-guest').attr('disabled', true);
-			$('#button-guest').after('<span class="wait">&nbsp;<img src="catalog/view/theme/default/image/loading.gif" alt="" /></span>');
-		},	
-		complete: function() {
-			$('#button-guest').attr('disabled', false); 
-			$('.wait').remove();
-		},			
-		success: function(json) {
-			$('.error').remove();
-			
-			if (json['redirect']) {
-				location = json['redirect'];
-			}
-			
-			if (json['error']) {
-				if (json['error']['firstname']) {
-					$('#payment-address input[name=\'firstname\'] + br').after('<span class="error">' + json['error']['firstname'] + '</span>');
-				}
-				
-				if (json['error']['lastname']) {
-					$('#payment-address input[name=\'lastname\'] + br').after('<span class="error">' + json['error']['lastname'] + '</span>');
-				}	
-				
-				if (json['error']['email']) {
-					$('#payment-address input[name=\'email\'] + br').after('<span class="error">' + json['error']['email'] + '</span>');
-				}
-				
-				if (json['error']['telephone']) {
-					$('#payment-address input[name=\'telephone\'] + br').after('<span class="error">' + json['error']['telephone'] + '</span>');
-				}		
-										
-				if (json['error']['address_1']) {
-					$('#payment-address input[name=\'address_1\'] + br').after('<span class="error">' + json['error']['address_1'] + '</span>');
-				}	
-				
-				if (json['error']['city']) {
-					$('#payment-address input[name=\'city\'] + br').after('<span class="error">' + json['error']['city'] + '</span>');
-				}	
-				
-				if (json['error']['postcode']) {
-					$('#payment-address input[name=\'postcode\'] + br').after('<span class="error">' + json['error']['postcode'] + '</span>');
-				}	
-				
-				if (json['error']['country']) {
-					$('#payment-address select[name=\'country_id\'] + br').after('<span class="error">' + json['error']['country'] + '</span>');
-				}	
-				
-				if (json['error']['zone']) {
-					$('#payment-address select[name=\'zone_id\'] + br').after('<span class="error">' + json['error']['zone'] + '</span>');
-				}
-			} else {
-				<?php if ($shipping_required) { ?>	
-				var shipping_address = $('#payment-address input[name=\'shipping_address\']:checked').attr('value');
-				
-				if (shipping_address) {
-					$.ajax({
-						url: 'index.php?route=checkout/shipping_method',
-						dataType: 'html',
-						success: function(html) {
-							$('#shipping-method .checkout-content').html(html);
-							
-							$('#payment-address .checkout-content').slideUp('slow');
-							
-							$('#shipping-method .checkout-content').slideDown('slow');
-							
-							$('#payment-address .checkout-heading a').remove();
-							$('#shipping-address .checkout-heading a').remove();
-							$('#shipping-method .checkout-heading a').remove();
-							$('#payment-method .checkout-heading a').remove();		
-															
-							$('#payment-address .checkout-heading').append('<a><?php echo $text_modify; ?></a>');	
-							$('#shipping-address .checkout-heading').append('<a><?php echo $text_modify; ?></a>');									
-							
-							$.ajax({
-								url: 'index.php?route=checkout/guest_shipping',
-								dataType: 'html',
-								success: function(html) {
-									$('#shipping-address .checkout-content').html(html);
-								},
-								error: function(xhr, ajaxOptions, thrownError) {
-									alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
-								}
-							});
-						},
-						error: function(xhr, ajaxOptions, thrownError) {
-							alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
-						}
-					});					
-				} else {
-					$.ajax({
-						url: 'index.php?route=checkout/guest_shipping',
-						dataType: 'html',
-						success: function(html) {
-							$('#shipping-address .checkout-content').html(html);
-							
-							$('#payment-address .checkout-content').slideUp('slow');
-							
-							$('#shipping-address .checkout-content').slideDown('slow');
-							
-							$('#payment-address .checkout-heading a').remove();
-							$('#shipping-address .checkout-heading a').remove();
-							$('#shipping-method .checkout-heading a').remove();
-							$('#payment-method .checkout-heading a').remove();
-							
-							$('#payment-address .checkout-heading').append('<a><?php echo $text_modify; ?></a>');	
-						},
-						error: function(xhr, ajaxOptions, thrownError) {
-							alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
-						}
-					});
-				}
-				<?php } else { ?>				
-				$.ajax({
-					url: 'index.php?route=checkout/payment_method',
-					dataType: 'html',
-					success: function(html) {
-						$('#payment-method .checkout-content').html(html);
-						
-						$('#payment-address .checkout-content').slideUp('slow');
-							
-						$('#payment-method .checkout-content').slideDown('slow');
-							
-						$('#payment-address .checkout-heading a').remove();
-						$('#payment-method .checkout-heading a').remove();
-														
-						$('#payment-address .checkout-heading').append('<a><?php echo $text_modify; ?></a>');
-					},
-					error: function(xhr, ajaxOptions, thrownError) {
-						alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
-					}
-				});				
-				<?php } ?>
-			}	 
-		},
-		error: function(xhr, ajaxOptions, thrownError) {
-			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
-		}
-	});	
-});
-
-// Guest Shipping
-$('#button-guest-shipping').live('click', function() {
-	$.ajax({
-		url: 'index.php?route=checkout/guest_shipping/validate',
-		type: 'post',
-		data: $('#shipping-address input[type=\'text\'], #shipping-address select'),
-		dataType: 'json',
-		beforeSend: function() {
-			$('#button-guest-shipping').attr('disabled', true);
-			$('#button-guest-shipping').after('<span class="wait">&nbsp;<img src="catalog/view/theme/default/image/loading.gif" alt="" /></span>');
-		},	
-		complete: function() {
-			$('#button-guest-shipping').attr('disabled', false); 
-			$('.wait').remove();
-		},			
-		success: function(json) {
-			$('.error').remove();
-			
-			if (json['redirect']) {
-				location = json['redirect'];
-			}
-			
-			if (json['error']) {
-				if (json['error']['firstname']) {
-					$('#shipping-address input[name=\'firstname\']').after('<span class="error">' + json['error']['firstname'] + '</span>');
-				}
-				
-				if (json['error']['lastname']) {
-					$('#shipping-address input[name=\'lastname\']').after('<span class="error">' + json['error']['lastname'] + '</span>');
-				}	
-										
-				if (json['error']['address_1']) {
-					$('#shipping-address input[name=\'address_1\']').after('<span class="error">' + json['error']['address_1'] + '</span>');
-				}	
-				
-				if (json['error']['city']) {
-					$('#shipping-address input[name=\'city\']').after('<span class="error">' + json['error']['city'] + '</span>');
-				}	
-				
-				if (json['error']['postcode']) {
-					$('#shipping-address input[name=\'postcode\']').after('<span class="error">' + json['error']['postcode'] + '</span>');
-				}	
-				
-				if (json['error']['country']) {
-					$('#shipping-address select[name=\'country_id\']').after('<span class="error">' + json['error']['country'] + '</span>');
-				}	
-				
-				if (json['error']['zone']) {
-					$('#shipping-address select[name=\'zone_id\']').after('<span class="error">' + json['error']['zone'] + '</span>');
-				}
-			} else {
-				$.ajax({
-					url: 'index.php?route=checkout/shipping_method',
-					dataType: 'html',
-					success: function(html) {
-						$('#shipping-method .checkout-content').html(html);
-						
-						$('#shipping-address .checkout-content').slideUp('slow');
-						
-						$('#shipping-method .checkout-content').slideDown('slow');
-						
-						$('#shipping-address .checkout-heading a').remove();
-						$('#shipping-method .checkout-heading a').remove();
-						$('#payment-method .checkout-heading a').remove();
-							
-						$('#shipping-address .checkout-heading').append('<a><?php echo $text_modify; ?></a>');
-					},
-					error: function(xhr, ajaxOptions, thrownError) {
-						alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
-					}
-				});				
-			}	 
-		},
-		error: function(xhr, ajaxOptions, thrownError) {
-			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
-		}
-	});	
-});
-
-$('#button-shipping-method').live('click', function() {
-	$.ajax({
-		url: 'index.php?route=checkout/shipping_method/validate',
-		type: 'post',
-		data: $('#shipping-method input[type=\'radio\']:checked, #shipping-method textarea'),
-		dataType: 'json',
-		beforeSend: function() {
-			$('#button-shipping-method').attr('disabled', true);
-			$('#button-shipping-method').after('<span class="wait">&nbsp;<img src="catalog/view/theme/default/image/loading.gif" alt="" /></span>');
-		},	
-		complete: function() {
-			$('#button-shipping-method').attr('disabled', false);
-			$('.wait').remove();
-		},			
-		success: function(json) {
-			$('.warning').remove();
-			
-			if (json['redirect']) {
-				location = json['redirect'];
-			}
-			
-			if (json['error']) {
-				if (json['error']['warning']) {
-					$('#shipping-method .checkout-content').prepend('<div class="warning" style="display: none;">' + json['error']['warning'] + '</div>');
-					
-					$('.warning').fadeIn('slow');
-				}			
-			} else {
-				$.ajax({
-					url: 'index.php?route=checkout/payment_method',
-					dataType: 'html',
-					success: function(html) {
-						$('#payment-method .checkout-content').html(html);
-						
-						$('#shipping-method .checkout-content').slideUp('slow');
-						
-						$('#payment-method .checkout-content').slideDown('slow');
-
-						$('#shipping-method .checkout-heading a').remove();
-						$('#payment-method .checkout-heading a').remove();
-						
-						$('#shipping-method .checkout-heading').append('<a><?php echo $text_modify; ?></a>');	
-
-					},
-					error: function(xhr, ajaxOptions, thrownError) {
-						alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
-					}
-				});					
-			}
-		},
-		error: function(xhr, ajaxOptions, thrownError) {
-			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
-		}
-	});	
-});
+$('.checkout-heading a').live('click', function() {
+	$('.checkout-content').slideUp('slow');
 
-$('#button-payment-method').live('click', function() {
-	$.ajax({
-		url: 'index.php?route=checkout/payment_method/validate', 
-		type: 'post',
-		data: $('#payment-method input[type=\'radio\']:checked, #payment-method input[type=\'checkbox\']:checked, #payment-method textarea'),
-		dataType: 'json',
-		beforeSend: function() {
-			$('#button-payment-method').attr('disabled', true);
-			$('#button-payment-method').after('<span class="wait">&nbsp;<img src="catalog/view/theme/default/image/loading.gif" alt="" /></span>');
-		},	
-		complete: function() {
-			$('#button-payment-method').attr('disabled', false);
-			$('.wait').remove();
-		},			
-		success: function(json) {
-			$('.warning').remove();
-			
-			if (json['redirect']) {
-				location = json['redirect'];
-			}
-			
-			if (json['error']) {
-				if (json['error']['warning']) {
-					$('#payment-method .checkout-content').prepend('<div class="warning" style="display: none;">' + json['error']['warning'] + '</div>');
-					
-					$('.warning').fadeIn('slow');
-				}			
-			} else {
-				$.ajax({
-					url: 'index.php?route=checkout/confirm',
-					dataType: 'html',
-					success: function(html) {
-						$('#confirm .checkout-content').html(html);
-						
-						$('#payment-method .checkout-content').slideUp('slow');
-						
-						$('#confirm .checkout-content').slideDown('slow');
-						
-						$('#payment-method .checkout-heading a').remove();
-						
-						$('#payment-method .checkout-heading').append('<a><?php echo $text_modify; ?></a>');	
-					},
-					error: function(xhr, ajaxOptions, thrownError) {
-						alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
-					}
-				});					
-			}
-		},
-		error: function(xhr, ajaxOptions, thrownError) {
-			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
-		}
-	});	
+	$(this).parent().parent().find('.checkout-content').slideDown('slow');
 });
-//--></script> 
+//--></script>
 <?php echo $footer; ?>
\ No newline at end of file
diff --git a/catalog/view/theme/default/template/checkout/confirm.tpl b/catalog/view/theme/default/template/checkout/confirm.tpl
index f52a834..a43fe3e 100644
--- a/catalog/view/theme/default/template/checkout/confirm.tpl
+++ b/catalog/view/theme/default/template/checkout/confirm.tpl
@@ -48,5 +48,5 @@
 <?php } else { ?>
 <script type="text/javascript"><!--
 location = '<?php echo $redirect; ?>';
-//--></script> 
+//--></script>
 <?php } ?>
\ No newline at end of file
diff --git a/catalog/view/theme/default/template/checkout/guest.tpl b/catalog/view/theme/default/template/checkout/guest.tpl
index bacad78..c7c9ac1 100644
--- a/catalog/view/theme/default/template/checkout/guest.tpl
+++ b/catalog/view/theme/default/template/checkout/guest.tpl
@@ -27,6 +27,19 @@
   <input type="text" name="company" value="<?php echo $company; ?>" class="large-field" />
   <br />
   <br />
+  <div style="display: <?php echo (count($customer_groups) > 1 ? 'table-row' : 'none'); ?>;"><?php echo $entry_customer_group; ?><br />
+    <select name="customer_group_id" class="large-field">
+      <?php foreach ($customer_groups as $customer_group) { ?>
+      <?php if ($customer_group['customer_group_id'] == $customer_group_id) { ?>
+      <option value="<?php echo $customer_group['customer_group_id']; ?>" selected="selected"><?php echo $customer_group['name']; ?></option>
+      <?php } else { ?>
+      <option value="<?php echo $customer_group['customer_group_id']; ?>"><?php echo $customer_group['name']; ?></option>
+      <?php } ?>
+      <?php } ?>
+    </select>
+    <br />
+    <br />
+  </div>
   <span class="required">*</span> <?php echo $entry_address_1; ?><br />
   <input type="text" name="address_1" value="<?php echo $address_1; ?>" class="large-field" />
   <br />
@@ -39,12 +52,12 @@
   <input type="text" name="city" value="<?php echo $city; ?>" class="large-field" />
   <br />
   <br />
-  <span class="required">*</span> <?php echo $entry_postcode; ?><br />
+  <span id="payment-postcode-required" class="required">*</span> <?php echo $entry_postcode; ?><br />
   <input type="text" name="postcode" value="<?php echo $postcode; ?>" class="large-field" />
   <br />
   <br />
   <span class="required">*</span> <?php echo $entry_country; ?><br />
-  <select name="country_id" class="large-field" onchange="$('#payment-address select[name=\'zone_id\']').load('index.php?route=checkout/guest/zone&country_id=' + this.value);">
+  <select name="country_id" class="large-field">
     <option value=""><?php echo $text_select; ?></option>
     <?php foreach ($countries as $country) { ?>
     <?php if ($country['country_id'] == $country_id) { ?>
@@ -77,8 +90,210 @@
 </div>
 <?php } ?>
 <div class="buttons">
-  <div class="right"><input type="button" value="<?php echo $button_continue; ?>" id="button-guest" class="button" /></div>
+  <div class="right">
+    <input type="button" value="<?php echo $button_continue; ?>" id="button-guest" class="button" />
+  </div>
 </div>
 <script type="text/javascript"><!--
-$('#payment-address select[name=\'zone_id\']').load('index.php?route=checkout/guest/zone&country_id=<?php echo $country_id; ?>&zone_id=<?php echo $zone_id; ?>');
-//--></script> 
\ No newline at end of file
+$('#payment-address select[name=\'customer_group_id\']').off().on('change', function() {
+});
+
+$('#payment-address input[name=\'customer_group_id\']:checked').trigger('change');
+//--></script>
+<script type="text/javascript"><!--
+// Guest
+$('#button-guest').off().on('click', function() {
+	$.ajax({
+		url: 'index.php?route=checkout/guest/save',
+		type: 'post',
+		data: $('#payment-address input[type=\'text\'], #payment-address input[type=\'checkbox\']:checked, #payment-address input[type=\'radio\']:checked, #payment-address input[type=\'hidden\'], #payment-address select'),
+		dataType: 'json',
+		beforeSend: function() {
+			$('#button-guest').attr('disabled', true);
+			$('#button-guest').after('<img src="catalog/view/theme/default/image/loading.gif" class="loading" style="padding-left: 5px;" />');
+		},
+		complete: function() {
+			$('#button-guest').attr('disabled', false);
+			$('.loading').remove();
+		},
+		success: function(json) {
+			$('.warning, .error').remove();
+
+			if (json['redirect']) {
+				location = json['redirect'];
+			} else if (json['error']) {
+				if (json['error']['warning']) {
+					$('#payment-address .checkout-content').prepend('<div class="warning" style="display: none;">' + json['error']['warning'] + '<img src="catalog/view/theme/default/image/close.png" alt="" class="close" /></div>');
+
+					$('.warning').fadeIn('slow');
+				}
+
+				if (json['error']['firstname']) {
+					$('#payment-address input[name=\'firstname\'] + br').after('<span class="error">' + json['error']['firstname'] + '</span>');
+				}
+
+				if (json['error']['lastname']) {
+					$('#payment-address input[name=\'lastname\'] + br').after('<span class="error">' + json['error']['lastname'] + '</span>');
+				}
+
+				if (json['error']['email']) {
+					$('#payment-address input[name=\'email\'] + br').after('<span class="error">' + json['error']['email'] + '</span>');
+				}
+
+				if (json['error']['telephone']) {
+					$('#payment-address input[name=\'telephone\'] + br').after('<span class="error">' + json['error']['telephone'] + '</span>');
+				}
+
+				if (json['error']['address_1']) {
+					$('#payment-address input[name=\'address_1\'] + br').after('<span class="error">' + json['error']['address_1'] + '</span>');
+				}
+
+				if (json['error']['city']) {
+					$('#payment-address input[name=\'city\'] + br').after('<span class="error">' + json['error']['city'] + '</span>');
+				}
+
+				if (json['error']['postcode']) {
+					$('#payment-address input[name=\'postcode\'] + br').after('<span class="error">' + json['error']['postcode'] + '</span>');
+				}
+
+				if (json['error']['country']) {
+					$('#payment-address select[name=\'country_id\'] + br').after('<span class="error">' + json['error']['country'] + '</span>');
+				}
+
+				if (json['error']['zone']) {
+					$('#payment-address select[name=\'zone_id\'] + br').after('<span class="error">' + json['error']['zone'] + '</span>');
+				}
+			} else {
+				<?php if ($shipping_required) { ?>
+				var shipping_address = $('#payment-address input[name=\'shipping_address\']:checked').attr('value');
+
+				if (shipping_address) {
+					$.ajax({
+						url: 'index.php?route=checkout/shipping_method',
+						dataType: 'html',
+						success: function(html) {
+							$('#shipping-method .checkout-content').html(html);
+
+							$('#payment-address .checkout-content').slideUp('slow');
+
+							$('#shipping-method .checkout-content').slideDown('slow');
+
+							$('#payment-address .checkout-heading a').remove();
+							$('#shipping-address .checkout-heading a').remove();
+							$('#shipping-method .checkout-heading a').remove();
+							$('#payment-method .checkout-heading a').remove();
+
+							$('#payment-address .checkout-heading').append('<a><?php echo $text_modify; ?></a>');
+							$('#shipping-address .checkout-heading').append('<a><?php echo $text_modify; ?></a>');
+
+							$.ajax({
+								url: 'index.php?route=checkout/guest_shipping',
+								dataType: 'html',
+								success: function(html) {
+									$('#shipping-address .checkout-content').html(html);
+								},
+								error: function(xhr, ajaxOptions, thrownError) {
+									alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+								}
+							});
+						},
+						error: function(xhr, ajaxOptions, thrownError) {
+							alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+						}
+					});
+				} else {
+					$.ajax({
+						url: 'index.php?route=checkout/guest_shipping',
+						dataType: 'html',
+						success: function(html) {
+							$('#shipping-address .checkout-content').html(html);
+
+							$('#payment-address .checkout-content').slideUp('slow');
+
+							$('#shipping-address .checkout-content').slideDown('slow');
+
+							$('#payment-address .checkout-heading a').remove();
+							$('#shipping-address .checkout-heading a').remove();
+							$('#shipping-method .checkout-heading a').remove();
+							$('#payment-method .checkout-heading a').remove();
+
+							$('#payment-address .checkout-heading').append('<a><?php echo $text_modify; ?></a>');
+						},
+						error: function(xhr, ajaxOptions, thrownError) {
+							alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+						}
+					});
+				}
+				<?php } else { ?>
+				$.ajax({
+					url: 'index.php?route=checkout/payment_method',
+					dataType: 'html',
+					success: function(html) {
+						$('#payment-method .checkout-content').html(html);
+
+						$('#payment-address .checkout-content').slideUp('slow');
+
+						$('#payment-method .checkout-content').slideDown('slow');
+
+						$('#payment-address .checkout-heading a').remove();
+						$('#payment-method .checkout-heading a').remove();
+
+						$('#payment-address .checkout-heading').append('<a><?php echo $text_modify; ?></a>');
+					},
+					error: function(xhr, ajaxOptions, thrownError) {
+						alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+					}
+				});
+				<?php } ?>
+			}
+		},
+		error: function(xhr, ajaxOptions, thrownError) {
+			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+		}
+	});
+});
+
+$('#payment-address select[name=\'country_id\']').off().on('change', function() {
+	if (this.value == '') return;
+	$.ajax({
+		url: 'index.php?route=checkout/checkout/country&country_id=' + this.value,
+		dataType: 'json',
+		beforeSend: function() {
+			$('#payment-address select[name=\'country_id\']').after('<img src="catalog/view/theme/default/image/loading.gif" class="loading" style="padding-left: 5px;" />');
+		},
+		complete: function() {
+			$('.loading').remove();
+		},
+		success: function(json) {
+			if (json['postcode_required'] == '1') {
+				$('#payment-postcode-required').show();
+			} else {
+				$('#payment-postcode-required').hide();
+			}
+
+			html = '<option value=""><?php echo $text_select; ?></option>';
+
+			if (json['zone'] != '') {
+				for (i = 0; i < json['zone'].length; i++) {
+        			html += '<option value="' + json['zone'][i]['zone_id'] + '"';
+
+					if (json['zone'][i]['zone_id'] == '<?php echo $zone_id; ?>') {
+	      				html += ' selected="selected"';
+	    			}
+
+	    			html += '>' + json['zone'][i]['name'] + '</option>';
+				}
+			} else {
+				html += '<option value="0" selected="selected"><?php echo $text_none; ?></option>';
+			}
+
+			$('#payment-address select[name=\'zone_id\']').html(html);
+		},
+		error: function(xhr, ajaxOptions, thrownError) {
+			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+		}
+	});
+});
+
+$('#payment-address select[name=\'country_id\']').trigger('change');
+//--></script>
\ No newline at end of file
diff --git a/catalog/view/theme/default/template/checkout/guest_shipping.tpl b/catalog/view/theme/default/template/checkout/guest_shipping.tpl
index 95178df..857bc35 100644
--- a/catalog/view/theme/default/template/checkout/guest_shipping.tpl
+++ b/catalog/view/theme/default/template/checkout/guest_shipping.tpl
@@ -24,12 +24,12 @@
     <td><input type="text" name="city" value="<?php echo $city; ?>" class="large-field" /></td>
   </tr>
   <tr>
-    <td><span class="required">*</span> <?php echo $entry_postcode; ?></td>
+    <td><span id="shipping-postcode-required" class="required">*</span> <?php echo $entry_postcode; ?></td>
     <td><input type="text" name="postcode" value="<?php echo $postcode; ?>" class="large-field" /></td>
   </tr>
   <tr>
     <td><span class="required">*</span> <?php echo $entry_country; ?></td>
-    <td><select name="country_id" class="large-field" onchange="$('#shipping-address select[name=\'zone_id\']').load('index.php?route=checkout/guest_shipping/zone&country_id=' + this.value);">
+    <td><select name="country_id" class="large-field">
         <option value=""><?php echo $text_select; ?></option>
         <?php foreach ($countries as $country) { ?>
         <?php if ($country['country_id'] == $country_id) { ?>
@@ -51,5 +51,130 @@
   <div class="right"><input type="button" value="<?php echo $button_continue; ?>" id="button-guest-shipping" class="button" /></div>
 </div>
 <script type="text/javascript"><!--
-$('#shipping-address select[name=\'zone_id\']').load('index.php?route=checkout/guest_shipping/zone&country_id=<?php echo $country_id; ?>&zone_id=<?php echo $zone_id; ?>');
-//--></script> 
\ No newline at end of file
+// Guest Shipping
+$('#button-guest-shipping').off().on('click', function() {
+	$.ajax({
+		url: 'index.php?route=checkout/guest_shipping/save',
+		type: 'post',
+		data: $('#shipping-address input[type=\'text\'], #shipping-address select'),
+		dataType: 'json',
+		beforeSend: function() {
+			$('#button-guest-shipping').attr('disabled', true);
+			$('#button-guest-shipping').after('<img src="catalog/view/theme/default/image/loading.gif" class="loading" style="padding-left: 5px;" />');
+		},
+		complete: function() {
+			$('#button-guest-shipping').attr('disabled', false);
+			$('.loading').remove();
+		},
+		success: function(json) {
+			$('.warning, .error').remove();
+
+			if (json['redirect']) {
+				location = json['redirect'];
+			} else if (json['error']) {
+				if (json['error']['warning']) {
+					$('#shipping-address .checkout-content').prepend('<div class="warning" style="display: none;">' + json['error']['warning'] + '<img src="catalog/view/theme/default/image/close.png" alt="" class="close" /></div>');
+
+					$('.warning').fadeIn('slow');
+				}
+
+				if (json['error']['firstname']) {
+					$('#shipping-address input[name=\'firstname\']').after('<span class="error">' + json['error']['firstname'] + '</span>');
+				}
+
+				if (json['error']['lastname']) {
+					$('#shipping-address input[name=\'lastname\']').after('<span class="error">' + json['error']['lastname'] + '</span>');
+				}
+
+				if (json['error']['address_1']) {
+					$('#shipping-address input[name=\'address_1\']').after('<span class="error">' + json['error']['address_1'] + '</span>');
+				}
+
+				if (json['error']['city']) {
+					$('#shipping-address input[name=\'city\']').after('<span class="error">' + json['error']['city'] + '</span>');
+				}
+
+				if (json['error']['postcode']) {
+					$('#shipping-address input[name=\'postcode\']').after('<span class="error">' + json['error']['postcode'] + '</span>');
+				}
+
+				if (json['error']['country']) {
+					$('#shipping-address select[name=\'country_id\']').after('<span class="error">' + json['error']['country'] + '</span>');
+				}
+
+				if (json['error']['zone']) {
+					$('#shipping-address select[name=\'zone_id\']').after('<span class="error">' + json['error']['zone'] + '</span>');
+				}
+			} else {
+				$.ajax({
+					url: 'index.php?route=checkout/shipping_method',
+					dataType: 'html',
+					success: function(html) {
+						$('#shipping-method .checkout-content').html(html);
+
+						$('#shipping-address .checkout-content').slideUp('slow');
+
+						$('#shipping-method .checkout-content').slideDown('slow');
+
+						$('#shipping-address .checkout-heading a').remove();
+						$('#shipping-method .checkout-heading a').remove();
+						$('#payment-method .checkout-heading a').remove();
+
+						$('#shipping-address .checkout-heading').append('<a><?php echo $text_modify; ?></a>');
+					},
+					error: function(xhr, ajaxOptions, thrownError) {
+						alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+					}
+				});
+			}
+		},
+		error: function(xhr, ajaxOptions, thrownError) {
+			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+		}
+	});
+});
+
+$('#shipping-address select[name=\'country_id\']').off().on('change', function() {
+	if (this.value == '') return;
+	$.ajax({
+		url: 'index.php?route=checkout/checkout/country&country_id=' + this.value,
+		dataType: 'json',
+		beforeSend: function() {
+			$('#shipping-address select[name=\'country_id\']').after('<img src="catalog/view/theme/default/image/loading.gif" class="loading" style="padding-left: 5px;" />');
+		},
+		complete: function() {
+			$('.loading').remove();
+		},
+		success: function(json) {
+			if (json['postcode_required'] == '1') {
+				$('#shipping-postcode-required').show();
+			} else {
+				$('#shipping-postcode-required').hide();
+			}
+
+			html = '<option value=""><?php echo $text_select; ?></option>';
+
+			if (json['zone'] != '') {
+				for (i = 0; i < json['zone'].length; i++) {
+        			html += '<option value="' + json['zone'][i]['zone_id'] + '"';
+
+					if (json['zone'][i]['zone_id'] == '<?php echo $zone_id; ?>') {
+	      				html += ' selected="selected"';
+	    			}
+
+	    			html += '>' + json['zone'][i]['name'] + '</option>';
+				}
+			} else {
+				html += '<option value="0" selected="selected"><?php echo $text_none; ?></option>';
+			}
+
+			$('#shipping-address select[name=\'zone_id\']').html(html);
+		},
+		error: function(xhr, ajaxOptions, thrownError) {
+			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+		}
+	});
+});
+
+$('#shipping-address select[name=\'country_id\']').trigger('change');
+//--></script>
\ No newline at end of file
diff --git a/catalog/view/theme/default/template/checkout/login.tpl b/catalog/view/theme/default/template/checkout/login.tpl
index bf298d3..345795d 100644
--- a/catalog/view/theme/default/template/checkout/login.tpl
+++ b/catalog/view/theme/default/template/checkout/login.tpl
@@ -39,4 +39,77 @@
   <br />
   <input type="button" value="<?php echo $button_login; ?>" id="button-login" class="button" /><br />
   <br />
-</div>
\ No newline at end of file
+</div>
+<script type="text/javascript"><!--
+$('#checkout .checkout-content input[name=\'account\']').off().on('change', function() {
+	if ($(this).attr('value') == 'register') {
+		$('#payment-address .checkout-heading span').html('<?php echo $text_checkout_account; ?>');
+	} else {
+		$('#payment-address .checkout-heading span').html('<?php echo $text_checkout_payment_address; ?>');
+	}
+});
+
+// Checkout
+$('#button-account').off().on('click', function() {
+	$.ajax({
+		url: 'index.php?route=checkout/' + $('input[name=\'account\']:checked').attr('value'),
+		dataType: 'html',
+		beforeSend: function() {
+			$('#button-account').attr('disabled', true);
+			$('#button-account').after('<img src="catalog/view/theme/default/image/loading.gif" class="loading" style="padding-left: 5px;" />');
+		},
+		complete: function() {
+			$('#button-account').attr('disabled', false);
+			$('.loading').remove();
+		},
+		success: function(html) {
+			$('.warning, .error').remove();
+
+			$('#payment-address .checkout-content').html(html);
+
+			$('#checkout .checkout-content').slideUp('slow');
+
+			$('#payment-address .checkout-content').slideDown('slow');
+
+			$('.checkout-heading a').remove();
+
+			$('#checkout .checkout-heading').append('<a><?php echo $text_modify; ?></a>');
+		},
+		error: function(xhr, ajaxOptions, thrownError) {
+			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+		}
+	});
+});
+
+// Login
+$('#button-login').off().on('click', function() {
+	$.ajax({
+		url: 'index.php?route=checkout/login/save',
+		type: 'post',
+		data: $('#checkout #login :input'),
+		dataType: 'json',
+		beforeSend: function() {
+			$('#button-login').attr('disabled', true);
+			$('#button-login').after('<img src="catalog/view/theme/default/image/loading.gif" class="loading" style="padding-left: 5px;" />');
+		},
+		complete: function() {
+			$('#button-login').attr('disabled', false);
+			$('.loading').remove();
+		},
+		success: function(json) {
+			$('.warning, .error').remove();
+
+			if (json['redirect']) {
+				location = json['redirect'];
+			} else if (json['error']) {
+				$('#checkout .checkout-content').prepend('<div class="warning" style="display: none;">' + json['error']['warning'] + '</div>');
+
+				$('.warning').fadeIn('slow');
+			}
+		},
+		error: function(xhr, ajaxOptions, thrownError) {
+			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+		}
+	});
+});
+//--></script>
\ No newline at end of file
diff --git a/catalog/view/theme/default/template/checkout/payment_address.tpl b/catalog/view/theme/default/template/checkout/payment_address.tpl
index 5c6f68e..57ae2a8 100644
--- a/catalog/view/theme/default/template/checkout/payment_address.tpl
+++ b/catalog/view/theme/default/template/checkout/payment_address.tpl
@@ -12,12 +12,12 @@
     <?php } ?>
   </select>
 </div>
-<?php } ?>
 <p>
   <input type="radio" name="payment_address" value="new" id="payment-address-new" />
   <label for="payment-address-new"><?php echo $text_address_new; ?></label>
 </p>
-<div id="payment-new" style="display: none;">
+<?php } ?>
+<div id="payment-new" style="display: <?php echo ($addresses ? 'none' : 'block'); ?>;">
   <table class="form">
     <tr>
       <td><span class="required">*</span> <?php echo $entry_firstname; ?></td>
@@ -44,12 +44,12 @@
       <td><input type="text" name="city" value="" class="large-field" /></td>
     </tr>
     <tr>
-      <td><span class="required">*</span> <?php echo $entry_postcode; ?></td>
+      <td><span id="payment-postcode-required" class="required">*</span> <?php echo $entry_postcode; ?></td>
       <td><input type="text" name="postcode" value="" class="large-field" /></td>
     </tr>
     <tr>
       <td><span class="required">*</span> <?php echo $entry_country; ?></td>
-      <td><select name="country_id" class="large-field" onchange="$('#payment-address select[name=\'zone_id\']').load('index.php?route=checkout/payment_address/zone&country_id=' + this.value);">
+      <td><select name="country_id" class="large-field">
           <option value=""><?php echo $text_select; ?></option>
           <?php foreach ($countries as $country) { ?>
           <?php if ($country['country_id'] == $country_id) { ?>
@@ -69,12 +69,12 @@
 </div>
 <br />
 <div class="buttons">
-  <div class="right"><input type="button" value="<?php echo $button_continue; ?>" id="button-payment-address" class="button" /></div>
+  <div class="right">
+    <input type="button" value="<?php echo $button_continue; ?>" id="button-payment-address" class="button" />
+  </div>
 </div>
 <script type="text/javascript"><!--
-$('#payment-address select[name=\'zone_id\']').load('index.php?route=checkout/payment_address/zone&country_id=<?php echo $country_id; ?>');
-
-$('#payment-address input[name=\'payment_address\']').live('change', function() {
+$('#payment-address input[name=\'payment_address\']').off().on('change', function() {
 	if (this.value == 'new') {
 		$('#payment-existing').hide();
 		$('#payment-new').show();
@@ -83,4 +83,170 @@ $('#payment-address input[name=\'payment_address\']').live('change', function()
 		$('#payment-new').hide();
 	}
 });
-//--></script> 
\ No newline at end of file
+//--></script>
+<script type="text/javascript"><!--
+// Payment Address
+$('#button-payment-address').off().on('click', function() {
+	$.ajax({
+		url: 'index.php?route=checkout/payment_address/save',
+		type: 'post',
+		data: $('#payment-address input[type=\'text\'], #payment-address input[type=\'password\'], #payment-address input[type=\'checkbox\']:checked, #payment-address input[type=\'radio\']:checked, #payment-address input[type=\'hidden\'], #payment-address select'),
+		dataType: 'json',
+		beforeSend: function() {
+			$('#button-payment-address').attr('disabled', true);
+			$('#button-payment-address').after('<img src="catalog/view/theme/default/image/loading.gif" class="loading" style="padding-left: 5px;" />');
+		},
+		complete: function() {
+			$('#button-payment-address').attr('disabled', false);
+			$('.loading').remove();
+		},
+		success: function(json) {
+			$('.warning, .error').remove();
+
+			if (json['redirect']) {
+				location = json['redirect'];
+			} else if (json['error']) {
+				if (json['error']['warning']) {
+					$('#payment-address .checkout-content').prepend('<div class="warning" style="display: none;">' + json['error']['warning'] + '<img src="catalog/view/theme/default/image/close.png" alt="" class="close" /></div>');
+
+					$('.warning').fadeIn('slow');
+				}
+
+				if (json['error']['firstname']) {
+					$('#payment-address input[name=\'firstname\']').after('<span class="error">' + json['error']['firstname'] + '</span>');
+				}
+
+				if (json['error']['lastname']) {
+					$('#payment-address input[name=\'lastname\']').after('<span class="error">' + json['error']['lastname'] + '</span>');
+				}
+
+				if (json['error']['telephone']) {
+					$('#payment-address input[name=\'telephone\']').after('<span class="error">' + json['error']['telephone'] + '</span>');
+				}
+
+				if (json['error']['address_1']) {
+					$('#payment-address input[name=\'address_1\']').after('<span class="error">' + json['error']['address_1'] + '</span>');
+				}
+
+				if (json['error']['city']) {
+					$('#payment-address input[name=\'city\']').after('<span class="error">' + json['error']['city'] + '</span>');
+				}
+
+				if (json['error']['postcode']) {
+					$('#payment-address input[name=\'postcode\']').after('<span class="error">' + json['error']['postcode'] + '</span>');
+				}
+
+				if (json['error']['country']) {
+					$('#payment-address select[name=\'country_id\']').after('<span class="error">' + json['error']['country'] + '</span>');
+				}
+
+				if (json['error']['zone']) {
+					$('#payment-address select[name=\'zone_id\']').after('<span class="error">' + json['error']['zone'] + '</span>');
+				}
+			} else {
+				<?php if ($shipping_required) { ?>
+				$.ajax({
+					url: 'index.php?route=checkout/shipping_address',
+					dataType: 'html',
+					success: function(html) {
+						$('#shipping-address .checkout-content').html(html);
+
+						$('#payment-address .checkout-content').slideUp('slow');
+
+						$('#shipping-address .checkout-content').slideDown('slow');
+
+						$('#payment-address .checkout-heading a').remove();
+						$('#shipping-address .checkout-heading a').remove();
+						$('#shipping-method .checkout-heading a').remove();
+						$('#payment-method .checkout-heading a').remove();
+
+						$('#payment-address .checkout-heading').append('<a><?php echo $text_modify; ?></a>');
+					},
+					error: function(xhr, ajaxOptions, thrownError) {
+						alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+					}
+				});
+				<?php } else { ?>
+				$.ajax({
+					url: 'index.php?route=checkout/payment_method',
+					dataType: 'html',
+					success: function(html) {
+						$('#payment-method .checkout-content').html(html);
+
+						$('#payment-address .checkout-content').slideUp('slow');
+
+						$('#payment-method .checkout-content').slideDown('slow');
+
+						$('#payment-address .checkout-heading a').remove();
+						$('#payment-method .checkout-heading a').remove();
+
+						$('#payment-address .checkout-heading').append('<a><?php echo $text_modify; ?></a>');
+					},
+					error: function(xhr, ajaxOptions, thrownError) {
+						alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+					}
+				});
+				<?php } ?>
+
+				$.ajax({
+					url: 'index.php?route=checkout/payment_address',
+					dataType: 'html',
+					success: function(html) {
+						$('#payment-address .checkout-content').html(html);
+					},
+					error: function(xhr, ajaxOptions, thrownError) {
+						alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+					}
+				});
+			}
+		},
+		error: function(xhr, ajaxOptions, thrownError) {
+			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+		}
+	});
+});
+
+$('#payment-address select[name=\'country_id\']').off().on('change', function() {
+	if (this.value == '') return;
+	$.ajax({
+		url: 'index.php?route=checkout/checkout/country&country_id=' + this.value,
+		dataType: 'json',
+		beforeSend: function() {
+			$('#payment-address select[name=\'country_id\']').after('<img src="catalog/view/theme/default/image/loading.gif" class="loading" style="padding-left: 5px;" />');
+		},
+		complete: function() {
+			$('.loading').remove();
+		},
+		success: function(json) {
+			if (json['postcode_required'] == '1') {
+				$('#payment-postcode-required').show();
+			} else {
+				$('#payment-postcode-required').hide();
+			}
+
+			html = '<option value=""><?php echo $text_select; ?></option>';
+
+			if (json['zone'] != '') {
+				for (i = 0; i < json['zone'].length; i++) {
+        			html += '<option value="' + json['zone'][i]['zone_id'] + '"';
+
+					if (json['zone'][i]['zone_id'] == '<?php echo $zone_id; ?>') {
+	      				html += ' selected="selected"';
+	    			}
+
+	    			html += '>' + json['zone'][i]['name'] + '</option>';
+				}
+			} else {
+				html += '<option value="0" selected="selected"><?php echo $text_none; ?></option>';
+			}
+
+			$('#payment-address select[name=\'zone_id\']').html(html);
+		},
+		error: function(xhr, ajaxOptions, thrownError) {
+			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+		}
+	});
+});
+
+$('#payment-address select[name=\'country_id\']').trigger('change');
+//--></script>
\ No newline at end of file
diff --git a/catalog/view/theme/default/template/checkout/payment_method.tpl b/catalog/view/theme/default/template/checkout/payment_method.tpl
index ee9c41e..c2345af 100644
--- a/catalog/view/theme/default/template/checkout/payment_method.tpl
+++ b/catalog/view/theme/default/template/checkout/payment_method.tpl
@@ -41,8 +41,61 @@
 </div>
 <?php } ?>
 <script type="text/javascript"><!--
+$('#button-payment-method').off().on('click', function() {
+	$.ajax({
+		url: 'index.php?route=checkout/payment_method/save',
+		type: 'post',
+		data: $('#payment-method input[type=\'radio\']:checked, #payment-method input[type=\'checkbox\']:checked, #payment-method textarea'),
+		dataType: 'json',
+		beforeSend: function() {
+			$('#button-payment-method').attr('disabled', true);
+			$('#button-payment-method').after('<img src="catalog/view/theme/default/image/loading.gif" class="loading" style="padding-left: 5px;" />');
+		},
+		complete: function() {
+			$('#button-payment-method').attr('disabled', false);
+			$('.loading').remove();
+		},
+		success: function(json) {
+			$('.warning, .error').remove();
+
+			if (json['redirect']) {
+				location = json['redirect'];
+			} else if (json['error']) {
+				if (json['error']['warning']) {
+					$('#payment-method .checkout-content').prepend('<div class="warning" style="display: none;">' + json['error']['warning'] + '<img src="catalog/view/theme/default/image/close.png" alt="" class="close" /></div>');
+
+					$('.warning').fadeIn('slow');
+				}
+			} else {
+				$.ajax({
+					url: 'index.php?route=checkout/confirm',
+					dataType: 'html',
+					success: function(html) {
+						$('#confirm .checkout-content').html(html);
+
+						$('#payment-method .checkout-content').slideUp('slow');
+
+						$('#confirm .checkout-content').slideDown('slow');
+
+						$('#payment-method .checkout-heading a').remove();
+
+						$('#payment-method .checkout-heading').append('<a><?php echo $text_modify; ?></a>');
+					},
+					error: function(xhr, ajaxOptions, thrownError) {
+						alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+					}
+				});
+			}
+		},
+		error: function(xhr, ajaxOptions, thrownError) {
+			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+		}
+	});
+});
+//--></script>
+<script type="text/javascript"><!--
 $('.colorbox').colorbox({
-	width: 560,
-	height: 560
+	width: 640,
+	height: 480
 });
-//--></script> 
\ No newline at end of file
+//--></script>
\ No newline at end of file
diff --git a/catalog/view/theme/default/template/checkout/register.tpl b/catalog/view/theme/default/template/checkout/register.tpl
index b7acf9c..c0225b3 100644
--- a/catalog/view/theme/default/template/checkout/register.tpl
+++ b/catalog/view/theme/default/template/checkout/register.tpl
@@ -37,6 +37,19 @@
   <input type="text" name="company" value="" class="large-field" />
   <br />
   <br />
+  <div style="display: <?php echo (count($customer_groups) > 1 ? 'table-row' : 'none'); ?>;"> <?php echo $entry_customer_group; ?><br />
+    <select name="customer_group_id" class="large-field">
+      <?php foreach ($customer_groups as $customer_group) { ?>
+      <?php if ($customer_group['customer_group_id'] == $customer_group_id) { ?>
+      <option value="<?php echo $customer_group['customer_group_id']; ?>" selected="selected"><?php echo $customer_group['name']; ?></option>
+      <?php } else { ?>
+      <option value="<?php echo $customer_group['customer_group_id']; ?>"><?php echo $customer_group['name']; ?></option>
+      <?php } ?>
+      <?php } ?>
+    </select>
+    <br />
+    <br />
+  </div>
   <span class="required">*</span> <?php echo $entry_address_1; ?><br />
   <input type="text" name="address_1" value="" class="large-field" />
   <br />
@@ -49,12 +62,12 @@
   <input type="text" name="city" value="" class="large-field" />
   <br />
   <br />
-  <span class="required">*</span> <?php echo $entry_postcode; ?><br />
-  <input type="text" name="postcode" value="" class="large-field" />
+  <span id="payment-postcode-required" class="required">*</span> <?php echo $entry_postcode; ?><br />
+  <input type="text" name="postcode" value="<?php echo $postcode; ?>" class="large-field" />
   <br />
   <br />
   <span class="required">*</span> <?php echo $entry_country; ?><br />
-  <select name="country_id" class="large-field" onchange="$('#payment-address select[name=\'zone_id\']').load('index.php?route=checkout/register/zone&country_id=' + this.value);">
+  <select name="country_id" class="large-field">
     <option value=""><?php echo $text_select; ?></option>
     <?php foreach ($countries as $country) { ?>
     <?php if ($country['country_id'] == $country_id) { ?>
@@ -94,15 +107,244 @@
 </div>
 <?php } else { ?>
 <div class="buttons">
-  <div class="right"><input type="button" value="<?php echo $button_continue; ?>" id="button-register" class="button" /></div>
+  <div class="right">
+    <input type="button" value="<?php echo $button_continue; ?>" id="button-register" class="button" />
+  </div>
 </div>
 <?php } ?>
 <script type="text/javascript"><!--
-$('#payment-address select[name=\'zone_id\']').load('index.php?route=checkout/register/zone&country_id=<?php echo $country_id; ?>');
-//--></script> 
+// Register
+$('#button-register').off().on('click', function() {
+	$.ajax({
+		url: 'index.php?route=checkout/register/save',
+		type: 'post',
+		data: $('#payment-address input[type=\'text\'], #payment-address input[type=\'password\'], #payment-address input[type=\'checkbox\']:checked, #payment-address input[type=\'radio\']:checked, #payment-address input[type=\'hidden\'], #payment-address select'),
+		dataType: 'json',
+		beforeSend: function() {
+			$('#button-register').attr('disabled', true);
+			$('#button-register').after('<img src="catalog/view/theme/default/image/loading.gif" class="loading" style="padding-left: 5px;" />');
+		},
+		complete: function() {
+			$('#button-register').attr('disabled', false);
+			$('.loading').remove();
+		},
+		success: function(json) {
+			$('.warning, .error').remove();
+
+			if (json['redirect']) {
+				location = json['redirect'];
+			} else if (json['error']) {
+				if (json['error']['warning']) {
+					$('#payment-address .checkout-content').prepend('<div class="warning" style="display: none;">' + json['error']['warning'] + '<img src="catalog/view/theme/default/image/close.png" alt="" class="close" /></div>');
+
+					$('.warning').fadeIn('slow');
+				}
+
+				if (json['error']['firstname']) {
+					$('#payment-address input[name=\'firstname\'] + br').after('<span class="error">' + json['error']['firstname'] + '</span>');
+				}
+
+				if (json['error']['lastname']) {
+					$('#payment-address input[name=\'lastname\'] + br').after('<span class="error">' + json['error']['lastname'] + '</span>');
+				}
+
+				if (json['error']['email']) {
+					$('#payment-address input[name=\'email\'] + br').after('<span class="error">' + json['error']['email'] + '</span>');
+				}
+
+				if (json['error']['telephone']) {
+					$('#payment-address input[name=\'telephone\'] + br').after('<span class="error">' + json['error']['telephone'] + '</span>');
+				}
+
+				if (json['error']['address_1']) {
+					$('#payment-address input[name=\'address_1\'] + br').after('<span class="error">' + json['error']['address_1'] + '</span>');
+				}
+
+				if (json['error']['city']) {
+					$('#payment-address input[name=\'city\'] + br').after('<span class="error">' + json['error']['city'] + '</span>');
+				}
+
+				if (json['error']['postcode']) {
+					$('#payment-address input[name=\'postcode\'] + br').after('<span class="error">' + json['error']['postcode'] + '</span>');
+				}
+
+				if (json['error']['country']) {
+					$('#payment-address select[name=\'country_id\'] + br').after('<span class="error">' + json['error']['country'] + '</span>');
+				}
+
+				if (json['error']['zone']) {
+					$('#payment-address select[name=\'zone_id\'] + br').after('<span class="error">' + json['error']['zone'] + '</span>');
+				}
+
+				if (json['error']['password']) {
+					$('#payment-address input[name=\'password\'] + br').after('<span class="error">' + json['error']['password'] + '</span>');
+				}
+
+				if (json['error']['confirm']) {
+					$('#payment-address input[name=\'confirm\'] + br').after('<span class="error">' + json['error']['confirm'] + '</span>');
+				}
+			} else {
+				<?php if ($shipping_required) { ?>
+				var shipping_address = $('#payment-address input[name=\'shipping_address\']:checked').attr('value');
+
+				if (shipping_address) {
+					$.ajax({
+						url: 'index.php?route=checkout/shipping_method',
+						dataType: 'html',
+						success: function(html) {
+							$('#shipping-method .checkout-content').html(html);
+
+							$('#payment-address .checkout-content').slideUp('slow');
+
+							$('#shipping-method .checkout-content').slideDown('slow');
+
+							$('#checkout .checkout-heading a').remove();
+							$('#payment-address .checkout-heading a').remove();
+							$('#shipping-address .checkout-heading a').remove();
+							$('#shipping-method .checkout-heading a').remove();
+							$('#payment-method .checkout-heading a').remove();
+
+							$('#shipping-address .checkout-heading').append('<a><?php echo $text_modify; ?></a>');
+							$('#payment-address .checkout-heading').append('<a><?php echo $text_modify; ?></a>');
+
+							$.ajax({
+								url: 'index.php?route=checkout/shipping_address',
+								dataType: 'html',
+								success: function(html) {
+									$('#shipping-address .checkout-content').html(html);
+								},
+								error: function(xhr, ajaxOptions, thrownError) {
+									alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+								}
+							});
+						},
+						error: function(xhr, ajaxOptions, thrownError) {
+							alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+						}
+					});
+				} else {
+					$.ajax({
+						url: 'index.php?route=checkout/shipping_address',
+						dataType: 'html',
+						success: function(html) {
+							$('#shipping-address .checkout-content').html(html);
+
+							$('#payment-address .checkout-content').slideUp('slow');
+
+							$('#shipping-address .checkout-content').slideDown('slow');
+
+							$('#checkout .checkout-heading a').remove();
+							$('#payment-address .checkout-heading a').remove();
+							$('#shipping-address .checkout-heading a').remove();
+							$('#shipping-method .checkout-heading a').remove();
+							$('#payment-method .checkout-heading a').remove();
+
+							$('#payment-address .checkout-heading').append('<a><?php echo $text_modify; ?></a>');
+						},
+						error: function(xhr, ajaxOptions, thrownError) {
+							alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+						}
+					});
+				}
+				<?php } else { ?>
+				$.ajax({
+					url: 'index.php?route=checkout/payment_method',
+					dataType: 'html',
+					success: function(html) {
+						$('#payment-method .checkout-content').html(html);
+
+						$('#payment-address .checkout-content').slideUp('slow');
+
+						$('#payment-method .checkout-content').slideDown('slow');
+
+						$('#checkout .checkout-heading a').remove();
+						$('#payment-address .checkout-heading a').remove();
+						$('#payment-method .checkout-heading a').remove();
+
+						$('#payment-address .checkout-heading').append('<a><?php echo $text_modify; ?></a>');
+					},
+					error: function(xhr, ajaxOptions, thrownError) {
+						alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+					}
+				});
+				<?php } ?>
+
+				$.ajax({
+					url: 'index.php?route=checkout/payment_address',
+					dataType: 'html',
+					success: function(html) {
+						$('#payment-address .checkout-content').html(html);
+
+						$('#payment-address .checkout-heading span').html('<?php echo $text_checkout_payment_address; ?>');
+					},
+					error: function(xhr, ajaxOptions, thrownError) {
+						alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+					}
+				});
+			}
+		},
+		error: function(xhr, ajaxOptions, thrownError) {
+			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+		}
+	});
+});
+
+
+$('#payment-address select[name=\'customer_group_id\']').off().on('change', function() {
+
+});
+
+$('#payment-address input[name=\'customer_group_id\']:checked').trigger('change');
+//--></script>
+<script type="text/javascript"><!--
+$('#payment-address select[name=\'country_id\']').off().on('change', function() {
+	if (this.value == '') return;
+	$.ajax({
+		url: 'index.php?route=checkout/checkout/country&country_id=' + this.value,
+		dataType: 'json',
+		beforeSend: function() {
+			$('#payment-address select[name=\'country_id\']').after('<img src="catalog/view/theme/default/image/loading.gif" class="loading" style="padding-left: 5px;" />');
+		},
+		complete: function() {
+			$('.loading').remove();
+		},
+		success: function(json) {
+			if (json['postcode_required'] == '1') {
+				$('#payment-postcode-required').show();
+			} else {
+				$('#payment-postcode-required').hide();
+			}
+
+			html = '<option value=""><?php echo $text_select; ?></option>';
+
+			if (json['zone'] != '') {
+
+				for (i = 0; i < json['zone'].length; i++) {
+        			html += '<option value="' + json['zone'][i]['zone_id'] + '"';
+
+					if (json['zone'][i]['zone_id'] == '<?php echo $zone_id; ?>') {
+	      				html += ' selected="selected"';
+	    			}
+
+	    			html += '>' + json['zone'][i]['name'] + '</option>';
+				}
+			} else {
+				html += '<option value="0" selected="selected"><?php echo $text_none; ?></option>';
+			}
+
+			$('#payment-address select[name=\'zone_id\']').html(html);
+		},
+		error: function(xhr, ajaxOptions, thrownError) {
+			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+		}
+	});
+});
+
+$('#payment-address select[name=\'country_id\']').trigger('change');
+//--></script>
 <script type="text/javascript"><!--
 $('.colorbox').colorbox({
-	width: 560,
-	height: 560
+	width: 640,
+	height: 480
 });
-//--></script> 
\ No newline at end of file
+//--></script>
\ No newline at end of file
diff --git a/catalog/view/theme/default/template/checkout/shipping_address.tpl b/catalog/view/theme/default/template/checkout/shipping_address.tpl
index 7e48264..cbecd5f 100644
--- a/catalog/view/theme/default/template/checkout/shipping_address.tpl
+++ b/catalog/view/theme/default/template/checkout/shipping_address.tpl
@@ -12,12 +12,12 @@
     <?php } ?>
   </select>
 </div>
-<?php } ?>
 <p>
   <input type="radio" name="shipping_address" value="new" id="shipping-address-new" />
   <label for="shipping-address-new"><?php echo $text_address_new; ?></label>
 </p>
-<div id="shipping-new" style="display: none;">
+<?php } ?>
+<div id="shipping-new" style="display: <?php echo ($addresses ? 'none' : 'block'); ?>;">
   <table class="form">
     <tr>
       <td><span class="required">*</span> <?php echo $entry_firstname; ?></td>
@@ -44,12 +44,12 @@
       <td><input type="text" name="city" value="" class="large-field" /></td>
     </tr>
     <tr>
-      <td><span class="required">*</span> <?php echo $entry_postcode; ?></td>
-      <td><input type="text" name="postcode" value="" class="large-field" /></td>
+      <td><span id="shipping-postcode-required" class="required">*</span> <?php echo $entry_postcode; ?></td>
+      <td><input type="text" name="postcode" value="<?php echo $postcode; ?>" class="large-field" /></td>
     </tr>
     <tr>
       <td><span class="required">*</span> <?php echo $entry_country; ?></td>
-      <td><select name="country_id" class="large-field" onchange="$('#shipping-address select[name=\'zone_id\']').load('index.php?route=checkout/shipping_address/zone&country_id=' + this.value);">
+      <td><select name="country_id" class="large-field">
           <option value=""><?php echo $text_select; ?></option>
           <?php foreach ($countries as $country) { ?>
           <?php if ($country['country_id'] == $country_id) { ?>
@@ -69,11 +69,11 @@
 </div>
 <br />
 <div class="buttons">
-  <div class="right"><input type="button" value="<?php echo $button_continue; ?>" id="button-shipping-address" class="button" /></div>
+  <div class="right">
+    <input type="button" value="<?php echo $button_continue; ?>" id="button-shipping-address" class="button" />
+  </div>
 </div>
 <script type="text/javascript"><!--
-$('#shipping-address select[name=\'zone_id\']').load('index.php?route=checkout/shipping_address/zone&country_id=<?php echo $country_id; ?>');
-
 $('#shipping-address input[name=\'shipping_address\']').live('change', function() {
 	if (this.value == 'new') {
 		$('#shipping-existing').hide();
@@ -83,4 +83,162 @@ $('#shipping-address input[name=\'shipping_address\']').live('change', function(
 		$('#shipping-new').hide();
 	}
 });
-//--></script> 
\ No newline at end of file
+//--></script>
+<script type="text/javascript"><!--
+// Shipping Address
+$('#button-shipping-address').off().on('click', function() {
+	$.ajax({
+		url: 'index.php?route=checkout/shipping_address/save',
+		type: 'post',
+		data: $('#shipping-address input[type=\'text\'], #shipping-address input[type=\'password\'], #shipping-address input[type=\'checkbox\']:checked, #shipping-address input[type=\'radio\']:checked, #shipping-address select'),
+		dataType: 'json',
+		beforeSend: function() {
+			$('#button-shipping-address').attr('disabled', true);
+			$('#button-shipping-address').after('<img src="catalog/view/theme/default/image/loading.gif" class="loading" style="padding-left: 5px;" />');
+		},
+		complete: function() {
+			$('#button-shipping-address').attr('disabled', false);
+			$('.loading').remove();
+		},
+		success: function(json) {
+			$('.warning, .error').remove();
+
+			if (json['redirect']) {
+				location = json['redirect'];
+			} else if (json['error']) {
+				if (json['error']['warning']) {
+					$('#shipping-address .checkout-content').prepend('<div class="warning" style="display: none;">' + json['error']['warning'] + '<img src="catalog/view/theme/default/image/close.png" alt="" class="close" /></div>');
+
+					$('.warning').fadeIn('slow');
+				}
+
+				if (json['error']['firstname']) {
+					$('#shipping-address input[name=\'firstname\']').after('<span class="error">' + json['error']['firstname'] + '</span>');
+				}
+
+				if (json['error']['lastname']) {
+					$('#shipping-address input[name=\'lastname\']').after('<span class="error">' + json['error']['lastname'] + '</span>');
+				}
+
+				if (json['error']['email']) {
+					$('#shipping-address input[name=\'email\']').after('<span class="error">' + json['error']['email'] + '</span>');
+				}
+
+				if (json['error']['telephone']) {
+					$('#shipping-address input[name=\'telephone\']').after('<span class="error">' + json['error']['telephone'] + '</span>');
+				}
+
+				if (json['error']['address_1']) {
+					$('#shipping-address input[name=\'address_1\']').after('<span class="error">' + json['error']['address_1'] + '</span>');
+				}
+
+				if (json['error']['city']) {
+					$('#shipping-address input[name=\'city\']').after('<span class="error">' + json['error']['city'] + '</span>');
+				}
+
+				if (json['error']['postcode']) {
+					$('#shipping-address input[name=\'postcode\']').after('<span class="error">' + json['error']['postcode'] + '</span>');
+				}
+
+				if (json['error']['country']) {
+					$('#shipping-address select[name=\'country_id\']').after('<span class="error">' + json['error']['country'] + '</span>');
+				}
+
+				if (json['error']['zone']) {
+					$('#shipping-address select[name=\'zone_id\']').after('<span class="error">' + json['error']['zone'] + '</span>');
+				}
+			} else {
+				$.ajax({
+					url: 'index.php?route=checkout/shipping_method',
+					dataType: 'html',
+					success: function(html) {
+						$('#shipping-method .checkout-content').html(html);
+
+						$('#shipping-address .checkout-content').slideUp('slow');
+
+						$('#shipping-method .checkout-content').slideDown('slow');
+
+						$('#shipping-address .checkout-heading a').remove();
+						$('#shipping-method .checkout-heading a').remove();
+						$('#payment-method .checkout-heading a').remove();
+
+						$('#shipping-address .checkout-heading').append('<a><?php echo $text_modify; ?></a>');
+
+						$.ajax({
+							url: 'index.php?route=checkout/shipping_address',
+							dataType: 'html',
+							success: function(html) {
+								$('#shipping-address .checkout-content').html(html);
+							},
+							error: function(xhr, ajaxOptions, thrownError) {
+								alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+							}
+						});
+					},
+					error: function(xhr, ajaxOptions, thrownError) {
+						alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+					}
+				});
+
+				$.ajax({
+					url: 'index.php?route=checkout/payment_address',
+					dataType: 'html',
+					success: function(html) {
+						$('#payment-address .checkout-content').html(html);
+					},
+					error: function(xhr, ajaxOptions, thrownError) {
+						alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+					}
+				});
+			}
+		},
+		error: function(xhr, ajaxOptions, thrownError) {
+			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+		}
+	});
+});
+
+$('#shipping-address select[name=\'country_id\']').off().on('change', function() {
+	if (this.value == '') return;
+	$.ajax({
+		url: 'index.php?route=checkout/checkout/country&country_id=' + this.value,
+		dataType: 'json',
+		beforeSend: function() {
+			$('#shipping-address select[name=\'country_id\']').after('<img src="catalog/view/theme/default/image/loading.gif" class="loading" style="padding-left: 5px;" />');
+		},
+		complete: function() {
+			$('.loading').remove();
+		},
+		success: function(json) {
+			if (json['postcode_required'] == '1') {
+				$('#shipping-postcode-required').show();
+			} else {
+				$('#shipping-postcode-required').hide();
+			}
+
+			html = '<option value=""><?php echo $text_select; ?></option>';
+
+			if (json['zone'] != '') {
+				for (i = 0; i < json['zone'].length; i++) {
+        			html += '<option value="' + json['zone'][i]['zone_id'] + '"';
+
+					if (json['zone'][i]['zone_id'] == '<?php echo $zone_id; ?>') {
+	      				html += ' selected="selected"';
+	    			}
+
+	    			html += '>' + json['zone'][i]['name'] + '</option>';
+				}
+			} else {
+				html += '<option value="0" selected="selected"><?php echo $text_none; ?></option>';
+			}
+
+			$('#shipping-address select[name=\'zone_id\']').html(html);
+		},
+		error: function(xhr, ajaxOptions, thrownError) {
+			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+		}
+	});
+});
+
+$('#shipping-address select[name=\'country_id\']').trigger('change');
+//--></script>
\ No newline at end of file
diff --git a/catalog/view/theme/default/template/checkout/shipping_method.tpl b/catalog/view/theme/default/template/checkout/shipping_method.tpl
index 8ceabc9..c7ab667 100644
--- a/catalog/view/theme/default/template/checkout/shipping_method.tpl
+++ b/catalog/view/theme/default/template/checkout/shipping_method.tpl
@@ -39,3 +39,57 @@
     <input type="button" value="<?php echo $button_continue; ?>" id="button-shipping-method" class="button" />
   </div>
 </div>
+<script type="text/javascript"><!--
+$('#button-shipping-method').off().on('click', function() {
+	$.ajax({
+		url: 'index.php?route=checkout/shipping_method/save',
+		type: 'post',
+		data: $('#shipping-method input[type=\'radio\']:checked, #shipping-method textarea'),
+		dataType: 'json',
+		beforeSend: function() {
+			$('#button-shipping-method').attr('disabled', true);
+			$('#button-shipping-method').after('<img src="catalog/view/theme/default/image/loading.gif" class="loading" style="padding-left: 5px;" />');
+		},
+		complete: function() {
+			$('#button-shipping-method').attr('disabled', false);
+			$('.loading').remove();
+		},
+		success: function(json) {
+			$('.warning, .error').remove();
+
+			if (json['redirect']) {
+				location = json['redirect'];
+			} else if (json['error']) {
+				if (json['error']['warning']) {
+					$('#shipping-method .checkout-content').prepend('<div class="warning" style="display: none;">' + json['error']['warning'] + '<img src="catalog/view/theme/default/image/close.png" alt="" class="close" /></div>');
+
+					$('.warning').fadeIn('slow');
+				}
+			} else {
+				$.ajax({
+					url: 'index.php?route=checkout/payment_method',
+					dataType: 'html',
+					success: function(html) {
+						$('#payment-method .checkout-content').html(html);
+
+						$('#shipping-method .checkout-content').slideUp('slow');
+
+						$('#payment-method .checkout-content').slideDown('slow');
+
+						$('#shipping-method .checkout-heading a').remove();
+						$('#payment-method .checkout-heading a').remove();
+
+						$('#shipping-method .checkout-heading').append('<a><?php echo $text_modify; ?></a>');
+					},
+					error: function(xhr, ajaxOptions, thrownError) {
+						alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+					}
+				});
+			}
+		},
+		error: function(xhr, ajaxOptions, thrownError) {
+			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+		}
+	});
+});
+//--></script>
\ No newline at end of file
diff --git a/catalog/view/theme/default/template/common/column_left.tpl b/catalog/view/theme/default/template/common/column_left.tpl
index 64eea48..61c2f4d 100644
--- a/catalog/view/theme/default/template/common/column_left.tpl
+++ b/catalog/view/theme/default/template/common/column_left.tpl
@@ -4,4 +4,4 @@
   <?php echo $module; ?>
   <?php } ?>
 </div>
-<?php } ?> 
+<?php } ?>
diff --git a/catalog/view/theme/default/template/common/footer.tpl b/catalog/view/theme/default/template/common/footer.tpl
index 5fefe83..c744205 100644
--- a/catalog/view/theme/default/template/common/footer.tpl
+++ b/catalog/view/theme/default/template/common/footer.tpl
@@ -1,4 +1,5 @@
 <div id="footer">
+  <?php if ($informations) { ?>
   <div class="column">
     <h3><?php echo $text_information; ?></h3>
     <ul>
@@ -7,6 +8,7 @@
       <?php } ?>
     </ul>
   </div>
+  <?php } ?>
   <div class="column">
     <h3><?php echo $text_service; ?></h3>
     <ul>
@@ -34,12 +36,12 @@
     </ul>
   </div>
 </div>
-<!-- 
+<!--
 OpenCart is open source software and you are free to remove the powered by OpenCart if you want, but its generally accepted practise to make a small donation.
 Please donate via PayPal to donate@opencart.com
 //-->
 <div id="powered"><?php echo $powered; ?></div>
-<!-- 
+<!--
 OpenCart is open source software and you are free to remove the powered by OpenCart if you want, but its generally accepted practise to make a small donation.
 Please donate via PayPal to donate@opencart.com
 //-->
diff --git a/catalog/view/theme/default/template/common/header.tpl b/catalog/view/theme/default/template/common/header.tpl
index 63ea950..4ba86f8 100644
--- a/catalog/view/theme/default/template/common/header.tpl
+++ b/catalog/view/theme/default/template/common/header.tpl
@@ -1,7 +1,7 @@
-<?php if (isset($_SERVER['HTTP_USER_AGENT']) && !strpos($_SERVER['HTTP_USER_AGENT'], 'MSIE 6')) echo '<?xml version="1.0" encoding="UTF-8"?>'. "\n"; ?>
-<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
-<html xmlns="http://www.w3.org/1999/xhtml" dir="<?php echo $direction; ?>" lang="<?php echo $lang; ?>" xml:lang="<?php echo $lang; ?>">
+<!DOCTYPE html>
+<html dir="<?php echo $direction; ?>" lang="<?php echo $lang; ?>">
 <head>
+<meta charset="UTF-8" />
 <title><?php echo $title; ?></title>
 <base href="<?php echo $base; ?>" />
 <?php if ($description) { ?>
@@ -20,17 +20,17 @@
 <?php foreach ($styles as $style) { ?>
 <link rel="<?php echo $style['rel']; ?>" type="text/css" href="<?php echo $style['href']; ?>" media="<?php echo $style['media']; ?>" />
 <?php } ?>
+<!-- Googlemaps API
+<script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false"></script>-->
 <script type="text/javascript" src="catalog/view/javascript/jquery/jquery-1.7.1.min.js"></script>
 <script type="text/javascript" src="catalog/view/javascript/jquery/ui/jquery-ui-1.8.16.custom.min.js"></script>
 <link rel="stylesheet" type="text/css" href="catalog/view/javascript/jquery/ui/themes/ui-lightness/jquery-ui-1.8.16.custom.css" />
-<script type="text/javascript" src="catalog/view/javascript/jquery/ui/external/jquery.cookie.js"></script>
-<script type="text/javascript" src="catalog/view/javascript/jquery/colorbox/jquery.colorbox.js"></script>
-<link rel="stylesheet" type="text/css" href="catalog/view/javascript/jquery/colorbox/colorbox.css" media="screen" />
-<script type="text/javascript" src="catalog/view/javascript/jquery/tabs.js"></script>
 <script type="text/javascript" src="catalog/view/javascript/common.js"></script>
+
 <?php foreach ($scripts as $script) { ?>
 <script type="text/javascript" src="<?php echo $script; ?>"></script>
 <?php } ?>
+
 <!--[if IE 7]>
 <link rel="stylesheet" type="text/css" href="catalog/view/theme/default/stylesheet/ie7.css" />
 <![endif]-->
@@ -41,6 +41,15 @@
 DD_belatedPNG.fix('#logo img');
 </script>
 <![endif]-->
+<?php if ($stores) { ?>
+<script type="text/javascript"><!--
+$(document).ready(function() {
+<?php foreach ($stores as $store) { ?>
+$('body').prepend('<iframe src="<?php echo $store; ?>" style="display: none;"></iframe>');
+<?php } ?>
+});
+//--></script>
+<?php } ?>
 <?php echo $google_analytics; ?>
 <script type="text/javascript" src="catalog/view/javascript/jscroller-0.4.js"></script>
 <script type="text/javascript" src="catalog/view/javascript/running_line.js"></script>
@@ -57,11 +66,7 @@ DD_belatedPNG.fix('#logo img');
   <?php echo $cart; ?>
   <div id="search">
     <div class="button-search"></div>
-    <?php if ($filter_name) { ?>
-    <input type="text" name="filter_name" value="<?php echo $filter_name; ?>" />
-    <?php } else { ?>
-    <input type="text" name="filter_name" value="<?php echo $text_search; ?>" onclick="this.value = '';" onkeydown="this.style.color = '#000000';" />
-    <?php } ?>
+    <input type="text" name="search" placeholder="<?php echo $text_search; ?>" value="<?php echo $search; ?>" />
   </div>
   <div id="welcome">
     <?php if (!$logged) { ?>
diff --git a/catalog/view/theme/default/template/information/contact.tpl b/catalog/view/theme/default/template/information/contact.tpl
index 71ac1c7..4543206 100644
--- a/catalog/view/theme/default/template/information/contact.tpl
+++ b/catalog/view/theme/default/template/information/contact.tpl
@@ -1,5 +1,5 @@
 <?php echo $header; ?><?php echo $column_left; ?><?php echo $column_right; ?>
-<div id="content"><?php echo $content_top; ?>
+<div id="content"> <?php echo $content_top; ?>
   <div class="breadcrumb">
     <?php foreach ($breadcrumbs as $breadcrumb) { ?>
     <?php echo $breadcrumb['separator']; ?><a href="<?php echo $breadcrumb['href']; ?>"><?php echo $breadcrumb['text']; ?></a>
@@ -9,56 +9,143 @@
   <form action="<?php echo $action; ?>" method="post" enctype="multipart/form-data">
     <h2><?php echo $text_location; ?></h2>
     <div class="contact-info">
-      <div class="content"><div class="left"><b><?php echo $text_address; ?></b><br />
-        <?php echo $store; ?><br />
-        <?php echo $address; ?></div>
-      <div class="right">
-        <?php if ($telephone) { ?>
-        <b><?php echo $text_telephone; ?></b><br />
-        <?php echo $telephone; ?><br />
+      <div class="content">
+        <div id="map"></div>
         <br />
-        <?php } ?>
-        <?php if ($fax) { ?>
-        <b><?php echo $text_fax; ?></b><br />
-        <?php echo $fax; ?>
+
+        <?php foreach($locations as $location) { ?>
+        <div class="left"><b><?php echo $location['name']; ?></b><br />
+          <?php echo $location['address_1']; ?><br />
+          <?php echo $location['address_2']; ?><br />
+          <?php echo $location['city']; ?><br />
+          <?php echo $location['postcode'];  ?><br />
+          <br />
+
+          <?php if ($location['open']) { ?>
+          <b><?php echo $text_open; ?></b><br/>
+          <?php echo $location['open']; ?><br />
+          <br />
+          <?php } ?>
+
+          <?php if ($location['comment']) { ?>
+          <?php echo $location['comment']; ?><br />
+          <?php } ?>
+
+          <br />
+          <br />
+        </div>
         <?php } ?>
       </div>
     </div>
-    </div>
     <h2><?php echo $text_contact; ?></h2>
-    <div class="content">
-    <b><?php echo $entry_name; ?></b><br />
-    <input type="text" name="name" value="<?php echo $name; ?>" />
-    <br />
-    <?php if ($error_name) { ?>
-    <span class="error"><?php echo $error_name; ?></span>
-    <?php } ?>
-    <br />
-    <b><?php echo $entry_email; ?></b><br />
-    <input type="text" name="email" value="<?php echo $email; ?>" />
-    <br />
-    <?php if ($error_email) { ?>
-    <span class="error"><?php echo $error_email; ?></span>
-    <?php } ?>
-    <br />
-    <b><?php echo $entry_enquiry; ?></b><br />
-    <textarea name="enquiry" cols="40" rows="10" style="width: 99%;"><?php echo $enquiry; ?></textarea>
-    <br />
-    <?php if ($error_enquiry) { ?>
-    <span class="error"><?php echo $error_enquiry; ?></span>
-    <?php } ?>
-    <br />
-    <b><?php echo $entry_captcha; ?></b><br />
-    <input type="text" name="captcha" value="<?php echo $captcha; ?>" />
-    <br />
-    <img src="index.php?route=information/contact/captcha" alt="" />
-    <?php if ($error_captcha) { ?>
-    <span class="error"><?php echo $error_captcha; ?></span>
-    <?php } ?>
+    <div class="content"><b><?php echo $entry_name; ?></b><br />
+      <input type="text" name="name" value="<?php echo $name; ?>" />
+      <br />
+      <?php if ($error_name) { ?>
+      <span class="error"><?php echo $error_name; ?></span>
+      <?php } ?>
+      <br />
+      <b><?php echo $entry_email; ?></b><br />
+      <input type="text" name="email" value="<?php echo $email; ?>" />
+      <br />
+      <?php if ($error_email) { ?>
+      <span class="error"><?php echo $error_email; ?></span>
+      <?php } ?>
+      <br />
+      <b><?php echo $entry_enquiry; ?></b><br />
+      <textarea name="enquiry" cols="40" rows="10" style="width: 99%;"><?php echo $enquiry; ?></textarea>
+      <br />
+      <?php if ($error_enquiry) { ?>
+      <span class="error"><?php echo $error_enquiry; ?></span>
+      <?php } ?>
+      <br />
+      <b><?php echo $entry_captcha; ?></b><br />
+      <input type="text" name="captcha" value="<?php echo $captcha; ?>" />
+      <br />
+      <img src="index.php?route=information/contact/captcha" alt="" />
+      <?php if ($error_captcha) { ?>
+      <span class="error"><?php echo $error_captcha; ?></span>
+      <?php } ?>
     </div>
     <div class="buttons">
-      <div class="right"><input type="submit" value="<?php echo $button_continue; ?>" class="button" /></div>
+      <div class="right">
+        <input type="submit" value="<?php echo $button_continue; ?>" class="button" />
+      </div>
     </div>
   </form>
   <?php echo $content_bottom; ?></div>
+<script type="text/javascript"><!--
+var openedInfoWindow = null;
+
+function initialize() {
+	//  Create Variables for our geocodes and markers
+	<?php foreach($locations as $location) { ?>
+	var myLatlng<?php echo $location['location_id']; ?> = new google.maps.LatLng(<?php echo $location['geocode']; ?>);
+	<?php } ?>
+
+	var mapOptions = {
+	  zoom: 6,
+	  center: myLatlng<?php echo $location['location_id']; ?>,
+	  mapTypeId: google.maps.MapTypeId.ROADMAP
+	}
+
+	var map = new google.maps.Map(document.getElementById('map'), mapOptions);
+
+	var bound = new google.maps.LatLngBounds();
+
+	<?php foreach($locations as $location) { ?>
+	//  Loop through our Array and place all the markers onto the map
+	var contentString7 = '<div id="address">'+
+		'<h2><?php echo $location['name']; ?></h2>'+
+		'<div id="bodyContent">'+
+		'<p> <?php echo $location['address_1'] .   "<br />"; ?>' +
+		'<?php echo $location['address_2'] .   "<br />"; ?> '+
+		'<?php echo $location['city'] .   "<br />"; ?> '+
+		'<?php echo $location['postcode']  .   "<br />"; ?> '+
+		'</div>'+
+		'</div>';
+
+	var infowindow<?php echo $location['location_id']; ?> = new google.maps.InfoWindow({
+		content: contentString7,
+		maxWidth: 100
+	});
+
+	var marker<?php echo $location['location_id']; ?> = new google.maps.Marker({
+		position: myLatlng<?php echo $location['location_id']; ?>,
+		map: map,
+		animation: google.maps.Animation.DROP,
+		title: '<?php echo $location['name']; ?>'
+	});
+
+	google.maps.event.addListener(marker<?php echo $location['location_id']; ?>, 'click', function() {
+	  if (openedInfoWindow != null) openedInfoWindow.close();
+
+	  infowindow<?php echo $location['location_id']; ?>.open(map,marker<?php echo $location['location_id']; ?>);
+
+	  openedInfoWindow = infowindow<?php echo $location['location_id']; ?>;
+
+		google.maps.event.addListener(infowindow<?php echo $location['location_id']; ?>, 'closeclick', function() {
+			openedInfoWindow = null;
+		});
+	});
+
+	//  Setting up bounds so that it extends the viewport
+	bound.extend(marker<?php echo $location['location_id']; ?>.getPosition());
+	<?php } ?>
+
+	//  Fit map to bounds so you can see all the markers
+	map.fitBounds(bound);
+}
+
+function loadScript() {
+	//  Script for loading up within document
+	var script = document.createElement('script');
+	script.type = 'text/javascript';
+	script.src = 'https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&callback=initialize';
+
+	document.body.appendChild(script);
+}
+
+window.onload = loadScript;
+//--></script>
 <?php echo $footer; ?>
\ No newline at end of file
diff --git a/catalog/view/theme/default/template/module/account.tpl b/catalog/view/theme/default/template/module/account.tpl
index e5361c2..e864d10 100644
--- a/catalog/view/theme/default/template/module/account.tpl
+++ b/catalog/view/theme/default/template/module/account.tpl
@@ -11,6 +11,7 @@
       <li><a href="<?php echo $edit; ?>"><?php echo $text_edit; ?></a></li>
       <li><a href="<?php echo $password; ?>"><?php echo $text_password; ?></a></li>
       <?php } ?>
+      <li><a href="<?php echo $address; ?>"><?php echo $text_address; ?></a></li>
       <li><a href="<?php echo $wishlist; ?>"><?php echo $text_wishlist; ?></a></li>
       <li><a href="<?php echo $order; ?>"><?php echo $text_order; ?></a></li>
       <li><a href="<?php echo $download; ?>"><?php echo $text_download; ?></a></li>
diff --git a/catalog/view/theme/default/template/module/cart.tpl b/catalog/view/theme/default/template/module/cart.tpl
index 1c171fc..f75d858 100644
--- a/catalog/view/theme/default/template/module/cart.tpl
+++ b/catalog/view/theme/default/template/module/cart.tpl
@@ -19,7 +19,7 @@
             </div></td>
           <td class="quantity">x&nbsp;<?php echo $product['quantity']; ?></td>
           <td class="total"><?php echo $product['total']; ?></td>
-          <td class="remove"><img src="catalog/view/theme/default/image/remove-small.png" alt="<?php echo $button_remove; ?>" title="<?php echo $button_remove; ?>" onclick="$('#cart').load('index.php?route=module/cart&remove=<?php echo $product['key']; ?> #cart > *');" /></td>
+          <td class="remove"><img src="catalog/view/theme/default/image/remove-small.png" alt="<?php echo $button_remove; ?>" title="<?php echo $button_remove; ?>" onclick="(getURLVar('route') == 'checkout/cart' || getURLVar('route') == 'checkout/checkout') ? location = 'index.php?route=checkout/cart&remove=<?php echo $product['key']; ?>' : $('#cart').load('index.php?route=module/cart&remove=<?php echo $product['key']; ?>' + ' #cart > *');" /></td>
         </tr>
         <?php } ?>
         <?php foreach ($vouchers as $voucher) { ?>
@@ -28,7 +28,7 @@
           <td class="name"><?php echo $voucher['description']; ?></td>
           <td class="quantity">x&nbsp;1</td>
           <td class="total"><?php echo $voucher['amount']; ?></td>
-          <td class="remove"><img src="catalog/view/theme/default/image/remove-small.png" alt="<?php echo $button_remove; ?>" title="<?php echo $button_remove; ?>" onclick="$('#cart').load('index.php?route=module/cart&remove=<?php echo $voucher['key']; ?> #cart > *');" /></td>
+          <td class="remove"><img src="catalog/view/theme/default/image/remove-small.png" alt="<?php echo $button_remove; ?>" title="<?php echo $button_remove; ?>" onclick="(getURLVar('route') == 'checkout/cart' || getURLVar('route') == 'checkout/checkout') ? location = 'index.php?route=checkout/cart&remove=<?php echo $voucher['key']; ?>' : $('#cart').load('index.php?route=module/cart&remove=<?php echo $voucher['key']; ?>' + ' #cart > *');" /></td>
         </tr>
         <?php } ?>
       </table>
@@ -37,8 +37,8 @@
       <table>
         <?php foreach ($totals as $total) { ?>
         <tr>
-          <td align="right"><b><?php echo $total['title']; ?>:</b></td>
-          <td align="right"><?php echo $total['text']; ?></td>
+          <td class="right"><b><?php echo $total['title']; ?>:</b></td>
+          <td class="right"><?php echo $total['text']; ?></td>
         </tr>
         <?php } ?>
       </table>
@@ -48,4 +48,4 @@
     <div class="empty"><?php echo $text_empty; ?></div>
     <?php } ?>
   </div>
-</div>
+</div>
\ No newline at end of file
diff --git a/catalog/view/theme/default/template/module/category.tpl b/catalog/view/theme/default/template/module/category.tpl
index 0f97a7c..df943e9 100644
--- a/catalog/view/theme/default/template/module/category.tpl
+++ b/catalog/view/theme/default/template/module/category.tpl
@@ -1,31 +1,29 @@
 <div class="box">
   <div class="box-heading"><?php echo $heading_title; ?></div>
   <div class="box-content">
-    <div class="box-category">
-      <ul>
-        <?php foreach ($categories as $category) { ?>
-        <li>
-          <?php if ($category['category_id'] == $category_id) { ?>
-          <a href="<?php echo $category['href']; ?>" class="active"><?php echo $category['name']; ?></a>
-          <?php } else { ?>
-          <a href="<?php echo $category['href']; ?>"><?php echo $category['name']; ?></a>
-          <?php } ?>
-          <?php if ($category['children']) { ?>
-          <ul>
-            <?php foreach ($category['children'] as $child) { ?>
-            <li>
-              <?php if ($child['category_id'] == $child_id) { ?>
-              <a href="<?php echo $child['href']; ?>" class="active"> - <?php echo $child['name']; ?></a>
-              <?php } else { ?>
-              <a href="<?php echo $child['href']; ?>"> - <?php echo $child['name']; ?></a>
-              <?php } ?>
-            </li>
+    <ul class="box-category">
+      <?php foreach ($categories as $category) { ?>
+      <li>
+        <?php if ($category['category_id'] == $category_id) { ?>
+        <a href="<?php echo $category['href']; ?>" class="active"><?php echo $category['name']; ?></a>
+        <?php } else { ?>
+        <a href="<?php echo $category['href']; ?>"><?php echo $category['name']; ?></a>
+        <?php } ?>
+        <?php if ($category['children']) { ?>
+        <ul>
+          <?php foreach ($category['children'] as $child) { ?>
+          <li>
+            <?php if ($child['category_id'] == $child_id) { ?>
+            <a href="<?php echo $child['href']; ?>" class="active"> - <?php echo $child['name']; ?></a>
+            <?php } else { ?>
+            <a href="<?php echo $child['href']; ?>"> - <?php echo $child['name']; ?></a>
             <?php } ?>
-          </ul>
+          </li>
           <?php } ?>
-        </li>
+        </ul>
         <?php } ?>
-      </ul>
-    </div>
+      </li>
+      <?php } ?>
+    </ul>
   </div>
 </div>
diff --git a/catalog/view/theme/default/template/module/currency.tpl b/catalog/view/theme/default/template/module/currency.tpl
index c43e00b..2a86af1 100644
--- a/catalog/view/theme/default/template/module/currency.tpl
+++ b/catalog/view/theme/default/template/module/currency.tpl
@@ -10,9 +10,9 @@
     <?php } ?>
     <?php } else { ?>
     <?php if ($currency['symbol_left']) { ?>
-    <a title="<?php echo $currency['title']; ?>" onClick="$('input[name=\'currency_code\']').attr('value', '<?php echo $currency['code']; ?>').submit(); $(this).parent().parent().submit();"><?php echo $currency['symbol_left']; ?></a>
+    <a title="<?php echo $currency['title']; ?>" onclick="$('input[name=\'currency_code\']').attr('value', '<?php echo $currency['code']; ?>'); $(this).parent().parent().submit();"><?php echo $currency['symbol_left']; ?></a>
     <?php } else { ?>
-    <a title="<?php echo $currency['title']; ?>" onClick="$('input[name=\'currency_code\']').attr('value', '<?php echo $currency['code']; ?>').submit(); $(this).parent().parent().submit();"><?php echo $currency['symbol_right']; ?></a>
+    <a title="<?php echo $currency['title']; ?>" onclick="$('input[name=\'currency_code\']').attr('value', '<?php echo $currency['code']; ?>'); $(this).parent().parent().submit();"><?php echo $currency['symbol_right']; ?></a>
     <?php } ?>
     <?php } ?>
     <?php } ?>
diff --git a/catalog/view/theme/default/template/module/featured.tpl b/catalog/view/theme/default/template/module/featured.tpl
index 02c3180..81672fa 100644
--- a/catalog/view/theme/default/template/module/featured.tpl
+++ b/catalog/view/theme/default/template/module/featured.tpl
@@ -20,7 +20,7 @@
         <?php if ($product['rating']) { ?>
         <div class="rating"><img src="catalog/view/theme/default/image/stars-<?php echo $product['rating']; ?>.png" alt="<?php echo $product['reviews']; ?>" /></div>
         <?php } ?>
-        <div class="cart"><input type="button" value="<?php echo $button_cart; ?>" onclick="addToCart('<?php echo $product['product_id']; ?>');" class="button" /></div
+        <div class="cart"><input type="button" value="<?php echo $button_cart; ?>" onclick="addToCart('<?php echo $product['product_id']; ?>');" class="button" /></div>
       </div>
       <?php } ?>
     </div>
diff --git a/catalog/view/theme/default/template/module/filter.tpl b/catalog/view/theme/default/template/module/filter.tpl
new file mode 100644
index 0000000..3362b10
--- /dev/null
+++ b/catalog/view/theme/default/template/module/filter.tpl
@@ -0,0 +1,38 @@
+<div class="box">
+  <div class="box-heading"><?php echo $heading_title; ?></div>
+  <div class="box-content">
+    <ul class="box-filter">
+      <?php foreach ($filter_groups as $filter_group) { ?>
+      <li><span id="filter-group<?php echo $filter_group['filter_group_id']; ?>"><?php echo $filter_group['name']; ?></span>
+        <ul>
+          <?php foreach ($filter_group['filter'] as $filter) { ?>
+          <?php if (in_array($filter['filter_id'], $filter_category)) { ?>
+          <li>
+            <input type="checkbox" value="<?php echo $filter['filter_id']; ?>" id="filter<?php echo $filter['filter_id']; ?>" checked="checked" />
+            <label for="filter<?php echo $filter['filter_id']; ?>"><?php echo $filter['name']; ?></label>
+          </li>
+          <?php } else { ?>
+          <li>
+            <input type="checkbox" value="<?php echo $filter['filter_id']; ?>" id="filter<?php echo $filter['filter_id']; ?>" />
+            <label for="filter<?php echo $filter['filter_id']; ?>"><?php echo $filter['name']; ?></label>
+          </li>
+          <?php } ?>
+          <?php } ?>
+        </ul>
+      </li>
+      <?php } ?>
+    </ul>
+    <a id="button-filter" class="button"><?php echo $button_filter; ?></a>
+  </div>
+</div>
+<script type="text/javascript"><!--
+$('#button-filter').on('click', function() {
+	filter = [];
+
+	$('.box-filter input[type=\'checkbox\']:checked').each(function(element) {
+		filter.push(this.value);
+	});
+
+	location = '<?php echo $action; ?>&filter=' + filter.join(',');
+});
+//--></script>
diff --git a/catalog/view/theme/default/template/module/language.tpl b/catalog/view/theme/default/template/module/language.tpl
index 3653f4f..215b727 100644
--- a/catalog/view/theme/default/template/module/language.tpl
+++ b/catalog/view/theme/default/template/module/language.tpl
@@ -2,7 +2,7 @@
 <form action="<?php echo $action; ?>" method="post" enctype="multipart/form-data">
   <div id="language"><?php echo $text_language; ?><br />
     <?php foreach ($languages as $language) { ?>
-    &nbsp;<img src="image/flags/<?php echo $language['image']; ?>" alt="<?php echo $language['name']; ?>" title="<?php echo $language['name']; ?>" onClick="$('input[name=\'language_code\']').attr('value', '<?php echo $language['code']; ?>').submit(); $(this).parent().parent().submit();" />
+    <img src="image/flags/<?php echo $language['image']; ?>" alt="<?php echo $language['name']; ?>" title="<?php echo $language['name']; ?>" onclick="$('input[name=\'language_code\']').attr('value', '<?php echo $language['code']; ?>'); $(this).parent().parent().submit();" />
     <?php } ?>
     <input type="hidden" name="language_code" value="" />
     <input type="hidden" name="redirect" value="<?php echo $redirect; ?>" />
diff --git a/catalog/view/theme/default/template/module/store.tpl b/catalog/view/theme/default/template/module/store.tpl
index d146489..4bbb0aa 100644
--- a/catalog/view/theme/default/template/module/store.tpl
+++ b/catalog/view/theme/default/template/module/store.tpl
@@ -1,17 +1,14 @@
 <div class="box">
   <div class="box-heading"><?php echo $heading_title; ?></div>
-  <div class="box-content" style="text-align: center;">
-    <p><?php echo $text_store; ?></p>
-    <select name="store" onchange="location = this.value">
-      <?php foreach ($stores as $store) { ?>
-      <?php if ($store['store_id'] == $store_id) { ?>
-      <option value="<?php echo $store['url']; ?>" selected="selected"><?php echo $store['name']; ?></option>
-      <?php } else { ?>
-      <option value="<?php echo $store['url']; ?>"><?php echo $store['name']; ?></option>
-      <?php } ?>
-      <?php } ?>
-    </select>
-    <br />
+  <div class="box-content">
+    <p style="text-align: center;"><?php echo $text_store; ?></p>
+    <?php foreach ($stores as $store) { ?>
+    <?php if ($store['store_id'] == $store_id) { ?>
+    <a href="<?php echo $store['url']; ?>"><b><?php echo $store['name']; ?></b></a><br />
+    <?php } else { ?>
+    <a href="<?php echo $store['url']; ?>"><?php echo $store['name']; ?></a><br />
+    <?php } ?>
+    <?php } ?>
     <br />
   </div>
 </div>
diff --git a/catalog/view/theme/default/template/payment/alertpay.tpl b/catalog/view/theme/default/template/payment/alertpay.tpl
deleted file mode 100644
index 520a7af..0000000
--- a/catalog/view/theme/default/template/payment/alertpay.tpl
+++ /dev/null
@@ -1,15 +0,0 @@
-<form action="<?php echo $action; ?>" method="post">
-  <input type="hidden" name="ap_merchant" value="<?php echo $ap_merchant; ?>" />
-  <input type="hidden" name="ap_amount" value="<?php echo $ap_amount; ?>" />
-  <input type="hidden" name="ap_currency" value="<?php echo $ap_currency; ?>" />
-  <input type="hidden" name="ap_purchasetype" value="<?php echo $ap_purchasetype; ?>" />
-  <input type="hidden" name="ap_itemname" value="<?php echo $ap_itemname; ?>" />
-  <input type="hidden" name="ap_itemcode" value="<?php echo $ap_itemcode; ?>" />
-  <input type="hidden" name="ap_returnurl" value="<?php echo $ap_returnurl; ?>" />
-  <input type="hidden" name="ap_cancelurl" value="<?php echo $ap_cancelurl; ?>" />
-  <div class="buttons">
-    <div class="right">
-      <input type="submit" value="<?php echo $button_confirm; ?>" class="button" />
-    </div>
-  </div>
-</form>
diff --git a/catalog/view/theme/default/template/payment/authorizenet_aim.tpl b/catalog/view/theme/default/template/payment/authorizenet_aim.tpl
index 237d60e..b24d281 100644
--- a/catalog/view/theme/default/template/payment/authorizenet_aim.tpl
+++ b/catalog/view/theme/default/template/payment/authorizenet_aim.tpl
@@ -1,5 +1,5 @@
 <h2><?php echo $text_credit_card; ?></h2>
-<div id="payment">
+<div class="content" id="payment">
   <table class="form">
     <tr>
       <td><?php echo $entry_cc_owner; ?></td>
@@ -33,26 +33,25 @@
   <div class="right"><input type="button" value="<?php echo $button_confirm; ?>" id="button-confirm" class="button" /></div>
 </div>
 <script type="text/javascript"><!--
-$('#button-confirm').bind('click', function() {
+$('#button-confirm').on('click', function() {
 	$.ajax({
 		url: 'index.php?route=payment/authorizenet_aim/send',
 		type: 'post',
 		data: $('#payment :input'),
-		dataType: 'json',		
+		dataType: 'json',
 		beforeSend: function() {
 			$('#button-confirm').attr('disabled', true);
-			
 			$('#payment').before('<div class="attention"><img src="catalog/view/theme/default/image/loading.gif" alt="" /> <?php echo $text_wait; ?></div>');
 		},
+		complete: function() {
+			$('#button-confirm').attr('disabled', false);
+			$('.attention').remove();
+		},
 		success: function(json) {
 			if (json['error']) {
 				alert(json['error']);
-				
-				$('#button-confirm').attr('disabled', false);
 			}
-			
-			$('.attention').remove();
-			
+
 			if (json['success']) {
 				location = json['success'];
 			}
diff --git a/catalog/view/theme/default/template/payment/bank_transfer.tpl b/catalog/view/theme/default/template/payment/bank_transfer.tpl
index f0a3693..dbf3ddb 100644
--- a/catalog/view/theme/default/template/payment/bank_transfer.tpl
+++ b/catalog/view/theme/default/template/payment/bank_transfer.tpl
@@ -1,20 +1,22 @@
 <h2><?php echo $text_instruction; ?></h2>
-<p><?php echo $text_description; ?></p>
-<p><?php echo $bank; ?></p>
-<p><?php echo $text_payment; ?></p>
+<div class="content">
+  <p><?php echo $text_description; ?></p>
+  <p><?php echo $bank; ?></p>
+  <p><?php echo $text_payment; ?></p>
+</div>
 <div class="buttons">
   <div class="right">
     <input type="button" value="<?php echo $button_confirm; ?>" id="button-confirm" class="button" />
   </div>
 </div>
 <script type="text/javascript"><!--
-$('#button-confirm').bind('click', function() {
-	$.ajax({ 
-		type: 'GET',
+$('#button-confirm').on('click', function() {
+	$.ajax({
+		type: 'get',
 		url: 'index.php?route=payment/bank_transfer/confirm',
 		success: function() {
 			location = '<?php echo $continue; ?>';
-		}		
+		}
 	});
 });
-//--></script> 
+//--></script>
diff --git a/catalog/view/theme/default/template/payment/cheque.tpl b/catalog/view/theme/default/template/payment/cheque.tpl
index 249ea57..7bee1ea 100644
--- a/catalog/view/theme/default/template/payment/cheque.tpl
+++ b/catalog/view/theme/default/template/payment/cheque.tpl
@@ -1,22 +1,24 @@
 <h2><?php echo $text_instruction; ?></h2>
-<p><b><?php echo $text_payable; ?></b></p>
-<p><?php echo $payable; ?></p>
-<b><?php echo $text_address; ?></b><br />
-<p><?php echo $address; ?></p>
-<p><?php echo $text_payment; ?></p>
+<div class="content">
+  <p><b><?php echo $text_payable; ?></b></p>
+  <p><?php echo $payable; ?></p>
+  <b><?php echo $text_address; ?></b><br />
+  <p><?php echo $address; ?></p>
+  <p><?php echo $text_payment; ?></p>
+</div>
 <div class="buttons">
   <div class="right">
     <input type="button" value="<?php echo $button_confirm; ?>" id="button-confirm" class="button" />
   </div>
 </div>
 <script type="text/javascript"><!--
-$('#button-confirm').bind('click', function() {
-	$.ajax({ 
-		type: 'GET',
+$('#button-confirm').on('click', function() {
+	$.ajax({
+		type: 'get',
 		url: 'index.php?route=payment/cheque/confirm',
 		success: function() {
 			location = '<?php echo $continue; ?>';
-		}		
+		}
 	});
 });
-//--></script> 
+//--></script>
diff --git a/catalog/view/theme/default/template/payment/cod.tpl b/catalog/view/theme/default/template/payment/cod.tpl
index f455688..9e96ebb 100644
--- a/catalog/view/theme/default/template/payment/cod.tpl
+++ b/catalog/view/theme/default/template/payment/cod.tpl
@@ -4,13 +4,13 @@
   </div>
 </div>
 <script type="text/javascript"><!--
-$('#button-confirm').bind('click', function() {
-	$.ajax({ 
-		type: 'GET',
+$('#button-confirm').on('click', function() {
+	$.ajax({
+		type: 'get',
 		url: 'index.php?route=payment/cod/confirm',
 		success: function() {
 			location = '<?php echo $continue; ?>';
-		}		
+		}
 	});
 });
-//--></script> 
+//--></script>
diff --git a/catalog/view/theme/default/template/payment/free_checkout.tpl b/catalog/view/theme/default/template/payment/free_checkout.tpl
index f5fcbec..89a2a32 100644
--- a/catalog/view/theme/default/template/payment/free_checkout.tpl
+++ b/catalog/view/theme/default/template/payment/free_checkout.tpl
@@ -4,13 +4,13 @@
   </div>
 </div>
 <script type="text/javascript"><!--
-$('#button-confirm').bind('click', function() {
-	$.ajax({ 
-		type: 'GET',
+$('#button-confirm').on('click', function() {
+	$.ajax({
+		type: 'get',
 		url: 'index.php?route=payment/free_checkout/confirm',
 		success: function() {
 			location = '<?php echo $continue; ?>';
-		}		
+		}
 	});
 });
-//--></script> 
+//--></script>
diff --git a/catalog/view/theme/default/template/payment/google_checkout.tpl b/catalog/view/theme/default/template/payment/google_checkout.tpl
index 6239add..f02ca04 100644
--- a/catalog/view/theme/default/template/payment/google_checkout.tpl
+++ b/catalog/view/theme/default/template/payment/google_checkout.tpl
@@ -1,7 +1,40 @@
-<div style="text-align: right; clear: both;">
-  <form action="<?php echo $action; ?>" method="post" id="payment">
-    <input type="hidden" name="cart" value="<?php echo $cart; ?>">
-    <input type="hidden" name="signature" value="<?php echo $signature; ?>">
-    <input type="image" name="Google Checkout" alt="Fast checkout through Google" src="<?php echo $button; ?>" height="46" width="180">
-  </form>
-</div>
+<form action="<?php echo $action; ?>" method="post" id="google-checkout">
+  <input type="hidden" name="cart" value="<?php echo $cart; ?>">
+  <input type="hidden" name="signature" value="<?php echo $signature; ?>">
+  <div class="buttons">
+    <div class="right">
+       <img alt="Fast checkout through Google" src="http://sandbox.google.com/checkout/buttons/checkout.gif?merchant_id=<?php echo $merchant; ?>&w=180&h=46&style=white&variant=text&loc=en_US" height="46" width="180" id="button-paypal" />
+    </div>
+  </div>
+</form>
+<script type="text/javascript"><!--
+$('#button-paypal').on('click', function() {
+	$.ajax({
+		url: 'index.php?route=payment/google_checkout/send',
+		type: 'post',
+		data: $('#payment :input'),
+		dataType: 'json',
+		beforeSend: function() {
+			$('#button-paypal').attr('disabled', true);
+			$('#button-paypal').after('<img src="catalog/view/theme/default/image/loading.gif" class="loading" style="padding-left: 5px;" />');
+		},
+		complete: function() {
+			$('#button-paypal').attr('disabled', false);
+			$('.loading').remove();
+		},
+		success: function(json) {
+			if (json['error']) {
+				alert(json['error']);
+			}
+
+			if (json['cart']) {
+				$('input[name=\'cart\']').attr('value', json['cart']);
+				$('input[name=\'signature\']').attr('value', json['signature']);
+
+				$('#google-checkout').submit();
+
+			}
+		}
+	});
+});
+//--></script>
\ No newline at end of file
diff --git a/catalog/view/theme/default/template/payment/klarna.tpl b/catalog/view/theme/default/template/payment/klarna.tpl
deleted file mode 100644
index 8f73ae2..0000000
--- a/catalog/view/theme/default/template/payment/klarna.tpl
+++ /dev/null
@@ -1,51 +0,0 @@
-<?php if ($testmode) { ?>
-<div class="warning"><?php echo $text_testmode; ?></div>
-<?php } ?>
-<form action="<?php echo $action; ?>" method="post">
-  <input type="hidden" name="cmd" value="_cart" />
-  <input type="hidden" name="upload" value="1" />
-  <input type="hidden" name="business" value="<?php echo $business; ?>" />
-  <?php $i = 1; ?>
-  <?php foreach ($products as $product) { ?>
-  <input type="hidden" name="item_name_<?php echo $i; ?>" value="<?php echo $product['name']; ?>" />
-  <input type="hidden" name="item_number_<?php echo $i; ?>" value="<?php echo $product['model']; ?>" />
-  <input type="hidden" name="amount_<?php echo $i; ?>" value="<?php echo $product['price']; ?>" />
-  <input type="hidden" name="quantity_<?php echo $i; ?>" value="<?php echo $product['quantity']; ?>" />
-  <input type="hidden" name="weight_<?php echo $i; ?>" value="<?php echo $product['weight']; ?>" />
-  <?php $j = 0; ?>
-  <?php foreach ($product['option'] as $option) { ?>
-  <input type="hidden" name="on<?php echo $j; ?>_<?php echo $i; ?>" value="<?php echo $option['name']; ?>" />
-  <input type="hidden" name="os<?php echo $j; ?>_<?php echo $i; ?>" value="<?php echo $option['value']; ?>" />
-  <?php $j++; ?>
-  <?php } ?>
-  <?php $i++; ?>
-  <?php } ?>
-  <?php if ($discount_amount_cart) { ?>
-  <input type="hidden" name="discount_amount_cart" value="<?php echo $discount_amount_cart; ?>" />
-  <?php } ?>
-  <input type="hidden" name="currency_code" value="<?php echo $currency_code; ?>" />
-  <input type="hidden" name="first_name" value="<?php echo $first_name; ?>" />
-  <input type="hidden" name="last_name" value="<?php echo $last_name; ?>" />
-  <input type="hidden" name="address1" value="<?php echo $address1; ?>" />
-  <input type="hidden" name="address2" value="<?php echo $address2; ?>" />
-  <input type="hidden" name="city" value="<?php echo $city; ?>" />
-  <input type="hidden" name="zip" value="<?php echo $zip; ?>" />
-  <input type="hidden" name="country" value="<?php echo $country; ?>" />
-  <input type="hidden" name="address_override" value="0" />
-  <input type="hidden" name="email" value="<?php echo $email; ?>" />
-  <input type="hidden" name="invoice" value="<?php echo $invoice; ?>" />
-  <input type="hidden" name="lc" value="<?php echo $lc; ?>" />
-  <input type="hidden" name="rm" value="2" />
-  <input type="hidden" name="no_note" value="1" />
-  <input type="hidden" name="charset" value="utf-8" />
-  <input type="hidden" name="return" value="<?php echo $return; ?>" />
-  <input type="hidden" name="notify_url" value="<?php echo $notify_url; ?>" />
-  <input type="hidden" name="cancel_return" value="<?php echo $cancel_return; ?>" />
-  <input type="hidden" name="paymentaction" value="<?php echo $paymentaction; ?>" />
-  <input type="hidden" name="custom" value="<?php echo $custom; ?>" />
-  <div class="buttons">
-    <div class="right">
-      <input type="submit" value="<?php echo $button_confirm; ?>" class="button" />
-    </div>
-  </div>
-</form>
diff --git a/catalog/view/theme/default/template/payment/klarna_account.tpl b/catalog/view/theme/default/template/payment/klarna_account.tpl
new file mode 100644
index 0000000..b220655
--- /dev/null
+++ b/catalog/view/theme/default/template/payment/klarna_account.tpl
@@ -0,0 +1,134 @@
+<?php if ($error_warning) { ?>
+<div class="warning"><?php echo $error_warning; ?></div>
+<?php } ?>
+<div style="margin-bottom: 10px;"><img src="https://cdn.klarna.com/public/images/<?php echo $iso_code_2; ?>/badges/v1/account/<?php echo $iso_code_2; ?>_account_badge_std_blue.png?width=150&eid=<?php echo $merchant; ?>" /></div>
+<div id="payment">
+  <div style="margin-bottom: 3px;"><b><?php echo $text_payment_option; ?></b></div>
+  <div class="content">
+    <table class="radio">
+      <?php foreach ($payment_options as $payment_option) { ?>
+      <tr class="highlight">
+        <td><?php if (!isset($code)) { ?>
+          <?php $code = $payment_option['code']; ?>
+          <input type="radio" name="code" value="<?php echo $payment_option['code']; ?>" id="plan-id<?php echo $payment_option['code']; ?>" checked="checked" />
+          <?php } else { ?>
+          <input type="radio" name="code" value="<?php echo $payment_option['code']; ?>" id="plan-id<?php echo $payment_option['code']; ?>" />
+          <?php } ?></td>
+        <td><label for="plan-id<?php echo $payment_option['code']; ?>"><?php echo $payment_option['title']; ?></label></td>
+        <td style="width: 1%;"><?php if ($iso_code_3 == 'NLD') { ?>
+          <img src="catalog/view/theme/default/image/klarna_nld_banner.png" />
+          <?php } ?></td>
+      </tr>
+      <?php } ?>
+    </table>
+  </div>
+  <div style="margin-bottom: 3px;"><b><?php echo $text_additional; ?></b></div>
+  <div class="content">
+    <table class="form">
+      <?php if (!$company) { ?>
+      <?php if ($iso_code_3 == 'DEU' || $iso_code_3 == 'NLD') { ?>
+      <tr>
+        <td><?php echo $entry_dob; ?></td>
+        <td><select name="pno_day">
+            <option value=""><?php echo $text_day; ?></option>
+            <?php foreach ($days as $day) { ?>
+            <option value="<?php echo $day['value']; ?>"><?php echo $day['text']; ?></option>
+            <?php } ?>
+          </select>
+          <select name="pno_month">
+            <option value=""><?php echo $text_month; ?></option>
+            <?php foreach ($months as $month) { ?>
+            <option value="<?php echo $month['value']; ?>"><?php echo $month['text']; ?></option>
+            <?php } ?>
+          </select>
+          <select name="pno_year">
+            <option value=""><?php echo $text_year; ?></option>
+            <?php foreach ($years as $year) { ?>
+            <option value="<?php echo $year['value']; ?>"><?php echo $year['text']; ?></option>
+            <?php } ?>
+          </select></td>
+      </tr>
+      <?php } else { ?>
+      <tr>
+        <td><?php echo $entry_pno; ?></td>
+        <td><input type="text" name="pno" value="" /></td>
+      </tr>
+      <?php } ?>
+      <?php } else { ?>
+      <tr>
+        <td><?php echo $entry_company; ?></td>
+        <td><input type="text" name="pno" value="" /></td>
+      </tr>
+      <?php } ?>
+      <?php if ($iso_code_3 == 'DEU' || $iso_code_3 == 'NLD') { ?>
+      <tr>
+        <td><?php echo $entry_gender; ?></td>
+        <td><input type="radio" name="gender" value="1" id="male" />
+          <label for="male"><?php echo $text_male; ?></label>
+          <input type="radio" name="gender" value="0" id="female" />
+          <label for="female"><?php echo $text_female; ?></label></td>
+      </tr>
+      <tr>
+        <td><?php echo $entry_street; ?></td>
+        <td><input type="text" name="street" value="<?php echo $street; ?>" /></td>
+      </tr>
+      <tr>
+        <td><?php echo $entry_house_no; ?></td>
+        <td><input type="text" name="house_no" value="<?php echo $street_number; ?>" /></td>
+      </tr>
+      <?php } ?>
+      <?php if ($iso_code_3 == 'NLD') { ?>
+      <tr>
+        <td><?php echo $entry_house_ext; ?></td>
+        <td><input type="text" name="house_ext" value="<?php echo $street_extension; ?>" /></td>
+      </tr>
+      <?php } ?>
+      <tr>
+        <td><?php echo $entry_phone_no; ?></td>
+        <td><input type="text" name="phone_no" value="<?php echo $phone_number; ?>" /></td>
+      </tr>
+      <?php if ($iso_code_3 == 'DEU') { ?>
+      <tr>
+        <td colspan="2"><input type="checkbox" name="deu_terms" value="1" />
+          Mit der Übermittlung der für die Abwicklung des Rechnungskaufes und einer Identitäts - und Bonitätsprüfung erforderlichen
+          Daten an Klarna bin ich einverstanden. Meine <a href="https://online.klarna.com/consent_de.yaws" target="_blank">Einwilligung</a> kann ich jederzeit mit Wirkung für die Zukunft widerrufen.</td>
+      </tr>
+      <?php } ?>
+    </table>
+  </div>
+</div>
+<div class="buttons">
+  <div class="right">
+    <input type="button" value="<?php echo $button_confirm; ?>" id="button-confirm" class="button" />
+  </div>
+</div>
+<script type="text/javascript"><!--
+$('#button-confirm').on('click', function() {
+	$.ajax({
+		url: 'index.php?route=payment/klarna_account/send',
+		type: 'post',
+		data: $('#payment input[type=\'text\'], #payment input[type=\'checkbox\']:checked, #payment input[type=\'radio\']:checked, #payment select'),
+		dataType: 'json',
+		beforeSend: function() {
+			$('#button-confirm').attr('disabled', true);
+
+			$('.warning, .error').remove();
+
+			$('#payment').before('<div class="attention"><img src="catalog/view/theme/default/image/loading.gif" alt="" /> <?php echo $text_wait; ?></div>');
+		},
+		complete: function() {
+			$('#button-confirm').attr('disabled', false);
+			$('.attention').remove();
+		},
+		success: function(json) {
+			if (json['error']) {
+				$('#payment').before('<div class="warning">' + json['error'] + '</div>');
+			}
+
+			if (json['redirect']) {
+				location = json['redirect'];
+			}
+		}
+	});
+});
+//--></script>
\ No newline at end of file
diff --git a/catalog/view/theme/default/template/payment/klarna_invoice.tpl b/catalog/view/theme/default/template/payment/klarna_invoice.tpl
new file mode 100644
index 0000000..784c108
--- /dev/null
+++ b/catalog/view/theme/default/template/payment/klarna_invoice.tpl
@@ -0,0 +1,115 @@
+<?php if ($error_warning) { ?>
+<div class="warning"><?php echo $error_warning; ?></div>
+<?php } ?>
+<div style="margin-bottom: 10px;"><img src="https://cdn.klarna.com/public/images/<?php echo $iso_code_2; ?>/badges/v1/invoice/<?php echo $iso_code_2; ?>_invoice_badge_std_blue.png?width=150&eid=<?php echo $merchant ?>" /></div>
+<div id="payment">
+  <div style="margin-bottom: 3px;"><b><?php echo $text_additional; ?></b></div>
+  <div class="content">
+    <table class="form">
+      <?php if (!$company) { ?>
+      <?php if ($iso_code_3 == 'DEU' || $iso_code_3 == 'NLD') { ?>
+      <tr>
+        <td><?php echo $entry_dob; ?></td>
+        <td><select name="pno_day">
+            <option value=""><?php echo $text_day; ?></option>
+            <?php foreach ($days as $day) { ?>
+            <option value="<?php echo $day['value']; ?>"><?php echo $day['text']; ?></option>
+            <?php } ?>
+          </select>
+          <select name="pno_month">
+            <option value=""><?php echo $text_month; ?></option>
+            <?php foreach ($months as $month) { ?>
+            <option value="<?php echo $month['value']; ?>"><?php echo $month['text']; ?></option>
+            <?php } ?>
+          </select>
+          <select name="pno_year">
+            <option value=""><?php echo $text_year; ?></option>
+            <?php foreach ($years as $year) { ?>
+            <option value="<?php echo $year['value']; ?>"><?php echo $year['text']; ?></option>
+            <?php } ?>
+          </select></td>
+      </tr>
+      <?php } else { ?>
+      <tr>
+        <td><?php echo $entry_pno; ?></td>
+        <td><input type="text" name="pno" value="" /></td>
+      </tr>
+      <?php } ?>
+      <?php } else { ?>
+      <tr>
+        <td><?php echo $entry_company; ?></td>
+        <td><input type="text" name="pno" value="" /></td>
+      </tr>
+      <?php } ?>
+      <?php if ($iso_code_3 == 'DEU' || $iso_code_3 == 'NLD') { ?>
+      <tr>
+        <td><?php echo $entry_gender; ?></td>
+        <td><input type="radio" name="gender" value="1" id="male" />
+          <label for="male"><?php echo $text_male; ?></label>
+          <input type="radio" name="gender" value="0" id="female" />
+          <label for="female"><?php echo $text_female; ?></label></td>
+      </tr>
+      <tr>
+        <td><?php echo $entry_street; ?></td>
+        <td><input type="text" name="street" value="<?php echo $street; ?>" /></td>
+      </tr>
+      <tr>
+        <td><?php echo $entry_house_no; ?></td>
+        <td><input type="text" name="house_no" value="<?php echo $street_number; ?>" /></td>
+      </tr>
+      <?php } ?>
+      <?php if ($iso_code_3 == 'NLD') { ?>
+      <tr>
+        <td><?php echo $entry_house_ext; ?></td>
+        <td><input type="text" name="house_ext" value="<?php echo $street_extension; ?>" /></td>
+      </tr>
+      <?php } ?>
+      <tr>
+        <td><?php echo $entry_phone_no; ?></td>
+        <td><input type="text" name="phone_no" value="<?php echo $phone_number; ?>" /></td>
+      </tr>
+      <?php if ($iso_code_3 == 'DEU') { ?>
+      <tr>
+        <td colspan="2"><input type="checkbox" name="deu_terms" value="1" />
+          Mit der Übermittlung der für die Abwicklung des Rechnungskaufes und einer Identitäts - und Bonitätsprüfung erforderlichen
+          Daten an Klarna bin ich einverstanden. Meine <a href="https://online.klarna.com/consent_de.yaws" target="_blank">Einwilligung</a> kann ich jederzeit mit Wirkung für die Zukunft widerrufen. </td>
+      </tr>
+      <?php } ?>
+    </table>
+  </div>
+</div>
+<div class="buttons">
+  <div class="right">
+    <input type="button" value="<?php echo $button_confirm; ?>" id="button-confirm" class="button" />
+  </div>
+</div>
+<script type="text/javascript"><!--
+$('#button-confirm').on('click', function() {
+	$.ajax({
+		url: 'index.php?route=payment/klarna_invoice/send',
+		type: 'post',
+		data: $('#payment input[type=\'text\'], #payment input[type=\'checkbox\']:checked, #payment input[type=\'radio\']:checked, #payment select'),
+		dataType: 'json',
+		beforeSend: function() {
+			$('#button-confirm').attr('disabled', true);
+
+			$('.warning, .error').remove();
+
+			$('#payment').before('<div class="attention"><img src="catalog/view/theme/default/image/loading.gif" alt="" /> <?php echo $text_wait; ?></div>');
+		},
+		complete: function() {
+			$('#button-confirm').attr('disabled', false);
+			$('.attention').remove();
+		},
+		success: function(json) {
+			if (json['error']) {
+				$('#payment').before('<div class="warning">' + json['error'] + '</div>');
+			}
+
+			if (json['redirect']) {
+				location = json['redirect'];
+			}
+		}
+	});
+});
+//--></script>
\ No newline at end of file
diff --git a/catalog/view/theme/default/template/payment/moneybookers.tpl b/catalog/view/theme/default/template/payment/moneybookers.tpl
index 9894048..4eef494 100644
--- a/catalog/view/theme/default/template/payment/moneybookers.tpl
+++ b/catalog/view/theme/default/template/payment/moneybookers.tpl
@@ -22,6 +22,7 @@
   <input type="hidden" name="detail1_text" value="<?php echo $detail1_text; ?>" />
   <input type="hidden" name="merchant_fields" value="order_id" />
   <input type="hidden" name="order_id" value="<?php echo $order_id; ?>" />
+  <input type="hidden" name="platform" value="<?php echo $platform; ?>" />
   <div class="buttons">
     <div class="right">
       <input type="submit" value="<?php echo $button_confirm; ?>" class="button" />
diff --git a/catalog/view/theme/default/template/payment/nochex.tpl b/catalog/view/theme/default/template/payment/nochex.tpl
index 8a73e2f..134b40b 100644
--- a/catalog/view/theme/default/template/payment/nochex.tpl
+++ b/catalog/view/theme/default/template/payment/nochex.tpl
@@ -10,6 +10,7 @@
   <input type="hidden" name="test_success_url" value="<?php echo $success_url; ?>" />
   <input type="hidden" name="test_cancel_url" value="<?php echo $cancel_url; ?>" />
   <input type="hidden" name="test_declined_url" value="<?php echo $declined_url; ?>" />
+  <input type="hidden" name="callback_url" value="<?php echo $callback_url; ?>" />
   <?php } ?>
   <input type="hidden" name="amount" value="<?php echo $amount; ?>" />
   <input type="hidden" name="description" value="<?php echo $description; ?>" />
@@ -23,9 +24,9 @@
   <input type="hidden" name="customer_phone_number" value="<?php echo $customer_phone_number; ?>" />
   <input type="hidden" name="email_address" value="<?php echo $email_address; ?>" />
   <input type="hidden" name="hide_billing_details" value="true" />
-</form>
-<div class="buttons">
-  <div class="right">
-    <input type="submit" value="<?php echo $button_confirm; ?>" class="button" />
+  <div class="buttons">
+    <div class="right">
+      <input type="submit" value="<?php echo $button_confirm; ?>" class="button" />
+    </div>
   </div>
-</div>
+</form>
\ No newline at end of file
diff --git a/catalog/view/theme/default/template/payment/paypoint.tpl b/catalog/view/theme/default/template/payment/paypoint.tpl
index cdc9ddf..b4ac1b7 100644
--- a/catalog/view/theme/default/template/payment/paypoint.tpl
+++ b/catalog/view/theme/default/template/payment/paypoint.tpl
@@ -4,7 +4,7 @@
   <input type="hidden" name="amount" value="<?php echo $amount; ?>" />
   <?php if ($digest) { ?>
   <input type="hidden" name="digest" value="<?php echo $digest; ?>" />
-  <?php } ?>  
+  <?php } ?>
   <input type="hidden" name="bill_name" value="<?php echo $bill_name; ?>" />
   <input type="hidden" name="bill_addr_1" value="<?php echo $bill_addr_1; ?>" />
   <input type="hidden" name="bill_addr_2" value="<?php echo $bill_addr_2; ?>" />
diff --git a/catalog/view/theme/default/template/payment/payza.tpl b/catalog/view/theme/default/template/payment/payza.tpl
new file mode 100644
index 0000000..520a7af
--- /dev/null
+++ b/catalog/view/theme/default/template/payment/payza.tpl
@@ -0,0 +1,15 @@
+<form action="<?php echo $action; ?>" method="post">
+  <input type="hidden" name="ap_merchant" value="<?php echo $ap_merchant; ?>" />
+  <input type="hidden" name="ap_amount" value="<?php echo $ap_amount; ?>" />
+  <input type="hidden" name="ap_currency" value="<?php echo $ap_currency; ?>" />
+  <input type="hidden" name="ap_purchasetype" value="<?php echo $ap_purchasetype; ?>" />
+  <input type="hidden" name="ap_itemname" value="<?php echo $ap_itemname; ?>" />
+  <input type="hidden" name="ap_itemcode" value="<?php echo $ap_itemcode; ?>" />
+  <input type="hidden" name="ap_returnurl" value="<?php echo $ap_returnurl; ?>" />
+  <input type="hidden" name="ap_cancelurl" value="<?php echo $ap_cancelurl; ?>" />
+  <div class="buttons">
+    <div class="right">
+      <input type="submit" value="<?php echo $button_confirm; ?>" class="button" />
+    </div>
+  </div>
+</form>
diff --git a/catalog/view/theme/default/template/payment/perpetual_payments.tpl b/catalog/view/theme/default/template/payment/perpetual_payments.tpl
index fe1031f..08d0a0c 100644
--- a/catalog/view/theme/default/template/payment/perpetual_payments.tpl
+++ b/catalog/view/theme/default/template/payment/perpetual_payments.tpl
@@ -1,5 +1,5 @@
 <h2><?php echo $text_credit_card; ?></h2>
-<div id="payment">
+<div class="content" id="payment">
   <table class="form">
     <tr>
       <td><?php echo $entry_cc_number; ?></td>
@@ -51,30 +51,29 @@
   </div>
 </div>
 <script type="text/javascript"><!--
-$('#button-confirm').bind('click', function() {
+$('#button-confirm').on('click', function() {
 	$.ajax({
 		url: 'index.php?route=payment/perpetual_payments/send',
 		type: 'post',
 		data: $('#payment :input'),
-		dataType: 'json',		
+		dataType: 'json',
 		beforeSend: function() {
 			$('#button-confirm').attr('disabled', true);
-			
 			$('#payment').before('<div class="attention"><img src="catalog/view/theme/default/image/loading.gif" alt="" /> <?php echo $text_wait; ?></div>');
 		},
+		complete: function() {
+			$('#button-confirm').attr('disabled', false);
+			$('.attention').remove();
+		},
 		success: function(json) {
 			if (json['error']) {
 				alert(json['error']);
-				
-				$('#button-confirm').attr('disabled', false);
 			}
-			
-			$('.attention').remove();
-			
+
 			if (json['success']) {
 				location = json['success'];
 			}
 		}
 	});
 });
-//--></script> 
\ No newline at end of file
+//--></script>
\ No newline at end of file
diff --git a/catalog/view/theme/default/template/payment/pp_pro.tpl b/catalog/view/theme/default/template/payment/pp_pro.tpl
index 1797b28..f0a1b32 100644
--- a/catalog/view/theme/default/template/payment/pp_pro.tpl
+++ b/catalog/view/theme/default/template/payment/pp_pro.tpl
@@ -1,5 +1,5 @@
 <h2><?php echo $text_credit_card; ?></h2>
-<div id="payment">
+<div class="content" id="payment">
   <table class="form">
     <tr>
       <td><?php echo $entry_cc_type; ?></td>
@@ -59,30 +59,29 @@
   </div>
 </div>
 <script type="text/javascript"><!--
-$('#button-confirm').bind('click', function() {
+$('#button-confirm').on('click', function() {
 	$.ajax({
 		url: 'index.php?route=payment/pp_pro/send',
 		type: 'post',
 		data: $('#payment :input'),
-		dataType: 'json',		
+		dataType: 'json',
 		beforeSend: function() {
 			$('#button-confirm').attr('disabled', true);
-			
 			$('#payment').before('<div class="attention"><img src="catalog/view/theme/default/image/loading.gif" alt="" /> <?php echo $text_wait; ?></div>');
 		},
+		complete: function() {
+			$('#button-confirm').attr('disabled', false);
+			$('.attention').remove();
+		},
 		success: function(json) {
 			if (json['error']) {
 				alert(json['error']);
-				
-				$('#button-confirm').attr('disabled', false);
 			}
-			
-			$('.attention').remove();
-			
+
 			if (json['success']) {
 				location = json['success'];
 			}
 		}
 	});
 });
-//--></script> 
+//--></script>
diff --git a/catalog/view/theme/default/template/payment/pp_pro_uk.tpl b/catalog/view/theme/default/template/payment/pp_pro_uk.tpl
index 4f290e5..391f51d 100644
--- a/catalog/view/theme/default/template/payment/pp_pro_uk.tpl
+++ b/catalog/view/theme/default/template/payment/pp_pro_uk.tpl
@@ -1,5 +1,5 @@
 <h2><?php echo $text_credit_card; ?></h2>
-<div id="payment">
+<div class="content" id="payment">
   <table class="form">
     <tr>
       <td><?php echo $entry_cc_owner; ?></td>
@@ -63,30 +63,29 @@
   </div>
 </div>
 <script type="text/javascript"><!--
-$('#button-confirm').bind('click', function() {
+$('#button-confirm').on('click', function() {
 	$.ajax({
 		url: 'index.php?route=payment/pp_pro_uk/send',
 		type: 'post',
 		data: $('#payment :input'),
-		dataType: 'json',		
+		dataType: 'json',
 		beforeSend: function() {
 			$('#button-confirm').attr('disabled', true);
-			
 			$('#payment').before('<div class="attention"><img src="catalog/view/theme/default/image/loading.gif" alt="" /> <?php echo $text_wait; ?></div>');
 		},
+		complete: function() {
+			$('#button-confirm').attr('disabled', false);
+			$('.attention').remove();
+		},
 		success: function(json) {
 			if (json['error']) {
 				alert(json['error']);
-				
-				$('#button-confirm').attr('disabled', false);
 			}
-			
-			$('.attention').remove();
-			
+
 			if (json['success']) {
 				location = json['success'];
 			}
 		}
 	});
 });
-//--></script> 
+//--></script>
diff --git a/catalog/view/theme/default/template/payment/qiwi.tpl b/catalog/view/theme/default/template/payment/qiwi.tpl
new file mode 100644
index 0000000..70229ba
--- /dev/null
+++ b/catalog/view/theme/default/template/payment/qiwi.tpl
@@ -0,0 +1,52 @@
+<div class="content">
+<p><?php echo $sub_text_info; ?></p>
+<form action="<?php echo $action; ?>" method="get" id="payments" >
+	<input type="hidden" name="from" value="<?php echo $from; ?>" />
+	<input type="hidden" name="summ" value="<?php echo $summ; ?>" />
+	<input type="hidden" name="com" value="<?php echo $com; ?>" />
+	<input type="hidden" name="txn_id" value="<?php echo $txn_id; ?>" />
+	<input type="hidden" name="lifetime" value="<?php echo $lifetime; ?>" />
+
+	<div style="text-align: right;"><?php echo $markup; ?></div><br>
+	<div style="text-align: right;"><?php echo $sub_text_info_phone; ?> +7 <input type="text" name="to" value="<?php echo $phone; ?>" size="10" maxlength="10"></div><br>
+</form>
+</div>
+<div class="buttons">
+<?php if ($summ < 15000) { ?>
+    <div class="right"><a id="payment" class="button"><span><?php echo $button_confirm; ?></span></a> </div>
+<?php } else { ?>
+    <p><?php echo $qiwi_limit; ?></p>
+    <div class="right"><a id="payment_back" class="button"><span><?php echo $button_back; ?></span></a> </div>
+<?php } ?>
+
+</div>
+
+
+<script type="text/javascript">
+
+
+$(document).ready(function(){
+	$("#payment").click(function(event){
+			$.ajax({
+	 		type: 'GET',
+			url: 'index.php?route=payment/qiwi/confirm',
+			success: function () {
+	     			$('#payments').submit();
+			}
+
+			});
+
+	return false;
+	});
+
+
+	$("#payment_back").click(function(event){
+	 		location.href = 'index.php?route=checkout/cart'
+	return false;
+	});
+
+});
+
+
+ </script>
+
diff --git a/catalog/view/theme/default/template/payment/sagepay_direct.tpl b/catalog/view/theme/default/template/payment/sagepay_direct.tpl
index f617f88..f01e389 100644
--- a/catalog/view/theme/default/template/payment/sagepay_direct.tpl
+++ b/catalog/view/theme/default/template/payment/sagepay_direct.tpl
@@ -1,5 +1,5 @@
 <h2><?php echo $text_credit_card; ?></h2>
-<div id="payment">
+<div class="content" id="payment">
   <table class="form">
     <tr>
       <td><?php echo $entry_cc_owner; ?></td>
@@ -63,44 +63,43 @@
   </div>
 </div>
 <script type="text/javascript"><!--
-$('#button-confirm').bind('click', function() {
+$('#button-confirm').on('click', function() {
 	$.ajax({
 		url: 'index.php?route=payment/sagepay_direct/send',
 		type: 'post',
 		data: $('#payment :input'),
-		dataType: 'json',		
+		dataType: 'json',
 		beforeSend: function() {
 			$('#button-confirm').attr('disabled', true);
-			
 			$('#payment').before('<div class="attention"><img src="catalog/view/theme/default/image/loading.gif" alt="" /> <?php echo $text_wait; ?></div>');
 		},
+		complete: function() {
+			$('#button-confirm').attr('disabled', false);
+			$('.attention').remove();
+		},
 		success: function(json) {
 			if (json['ACSURL']) {
 				$('#3dauth').remove();
-				
+
 				html  = '<form action="' + json['ACSURL'] + '" method="post" id="3dauth">';
 				html += '<input type="hidden" name="MD" value="' + json['MD'] + '" />';
 				html += '<input type="hidden" name="PaReq" value="' + json['PaReq'] + '" />';
 				html += '<input type="hidden" name="TermUrl" value="' + json['TermUrl'] + '" />';
 				html += '</form>';
-				
+
 				$('#payment').after(html);
-				
+
 				$('#3dauth').submit();
 			}
-			
+
 			if (json['error']) {
 				alert(json['error']);
-				
-				$('#button-confirm').attr('disabled', false);
 			}
-			
-			$('.attention').remove();
-			
+
 			if (json['success']) {
 				location = json['success'];
 			}
 		}
 	});
 });
-//--></script> 
+//--></script>
diff --git a/catalog/view/theme/default/template/payment/sagepay_us.tpl b/catalog/view/theme/default/template/payment/sagepay_us.tpl
index 4ae2627..4994c3b 100644
--- a/catalog/view/theme/default/template/payment/sagepay_us.tpl
+++ b/catalog/view/theme/default/template/payment/sagepay_us.tpl
@@ -1,5 +1,5 @@
 <h2><?php echo $text_credit_card; ?></h2>
-<div id="payment">
+<div class="content" id="payment">
   <table class="form">
     <tr>
       <td><?php echo $entry_cc_owner; ?></td>
@@ -35,26 +35,25 @@
   </div>
 </div>
 <script type="text/javascript"><!--
-$('#button-confirm').bind('click', function() {
+$('#button-confirm').on('click', function() {
 	$.ajax({
 		url: 'index.php?route=payment/sagepay_us/send',
 		type: 'post',
 		data: $('#payment :input'),
-		dataType: 'json',		
+		dataType: 'json',
 		beforeSend: function() {
 			$('#button-confirm').attr('disabled', true);
-			
 			$('#payment').before('<div class="attention"><img src="catalog/view/theme/default/image/loading.gif" alt="" /> <?php echo $text_wait; ?></div>');
 		},
+		complete: function() {
+			$('#button-confirm').attr('disabled', false);
+			$('.attention').remove();
+		},
 		success: function(json) {
 			if (json['error']) {
 				alert(json['error']);
-				
-				$('#button-confirm').attr('disabled', false);
 			}
-			
-			$('.attention').remove();
-			
+
 			if (json['success']) {
 				location = json['success'];
 			}
diff --git a/catalog/view/theme/default/template/payment/web_payment_software.tpl b/catalog/view/theme/default/template/payment/web_payment_software.tpl
index 0dfb670..6511333 100644
--- a/catalog/view/theme/default/template/payment/web_payment_software.tpl
+++ b/catalog/view/theme/default/template/payment/web_payment_software.tpl
@@ -1,5 +1,5 @@
 <h2><?php echo $text_credit_card; ?></h2>
-<div id="payment">
+<div class="content" id="payment">
   <table class="form">
     <tr>
       <td><?php echo $entry_cc_owner; ?></td>
@@ -35,30 +35,29 @@
   </div>
 </div>
 <script type="text/javascript">
-$('#button-confirm').bind('click', function() {
+$('#button-confirm').on('click', function() {
 	$.ajax({
 		url: 'index.php?route=payment/web_payment_software/send',
 		type: 'post',
 		data: $('#payment :input'),
-		dataType: 'json',		
+		dataType: 'json',
 		beforeSend: function() {
 			$('#button-confirm').attr('disabled', true);
-			
 			$('#payment').before('<div class="attention"><img src="catalog/view/theme/default/image/loading.gif" alt="" /> <?php echo $text_wait; ?></div>');
 		},
+		complete: function() {
+			$('#button-confirm').attr('disabled', false);
+			$('.attention').remove();
+		},
 		success: function(json) {
 			if (json['error']) {
 				alert(json['error']);
-				
-				$('#button-confirm').attr('disabled', false);
 			}
-			
-			$('.attention').remove();
-			
+
 			if (json['success']) {
 				location = json['success'];
 			}
 		}
 	});
 });
-</script> 
+</script>
diff --git a/catalog/view/theme/default/template/product/category.tpl b/catalog/view/theme/default/template/product/category.tpl
index ad4ee83..e79f325 100644
--- a/catalog/view/theme/default/template/product/category.tpl
+++ b/catalog/view/theme/default/template/product/category.tpl
@@ -144,13 +144,12 @@ function display(view) {
 
 			html += '</div>';
 
-
 			$(element).html(html);
 		});
 
 		$('.display').html('<b><?php echo $text_display; ?></b> <?php echo $text_list; ?> <b>/</b> <a onclick="display(\'grid\');"><?php echo $text_grid; ?></a>');
 
-		$.cookie('display', 'list');
+		$.totalStorage('display', 'list');
 	} else {
 		$('.product-list').attr('class', 'product-grid');
 
@@ -187,11 +186,11 @@ function display(view) {
 
 		$('.display').html('<b><?php echo $text_display; ?></b> <a onclick="display(\'list\');"><?php echo $text_list; ?></a> <b>/</b> <?php echo $text_grid; ?>');
 
-		$.cookie('display', 'grid');
+		$.totalStorage('display', 'grid');
 	}
 }
 
-view = $.cookie('display');
+view = $.totalStorage('display');
 
 if (view) {
 	display(view);
diff --git a/catalog/view/theme/default/template/product/compare.tpl b/catalog/view/theme/default/template/product/compare.tpl
index 3bcee0e..f8cc3a3 100644
--- a/catalog/view/theme/default/template/product/compare.tpl
+++ b/catalog/view/theme/default/template/product/compare.tpl
@@ -62,6 +62,7 @@
         <td><?php echo $products[$product['product_id']]['availability']; ?></td>
         <?php } ?>
       </tr>
+	  <?php if ($review_status) { ?>
       <tr>
         <td><?php echo $text_rating; ?></td>
         <?php foreach ($products as $product) { ?>
@@ -69,7 +70,8 @@
           <?php echo $products[$product['product_id']]['reviews']; ?></td>
         <?php } ?>
       </tr>
-      <tr>
+      <?php } ?>
+	  <tr>
         <td><?php echo $text_summary; ?></td>
         <?php foreach ($products as $product) { ?>
         <td class="description"><?php echo $products[$product['product_id']]['description']; ?></td>
diff --git a/catalog/view/theme/default/template/product/manufacturer_info.tpl b/catalog/view/theme/default/template/product/manufacturer_info.tpl
index a2a7c19..66e859d 100644
--- a/catalog/view/theme/default/template/product/manufacturer_info.tpl
+++ b/catalog/view/theme/default/template/product/manufacturer_info.tpl
@@ -57,7 +57,9 @@
       <?php if ($product['rating']) { ?>
       <div class="rating"><img src="catalog/view/theme/default/image/stars-<?php echo $product['rating']; ?>.png" alt="<?php echo $product['reviews']; ?>" /></div>
       <?php } ?>
-      <div class="cart"><input type="button" value="<?php echo $button_cart; ?>" onclick="addToCart('<?php echo $product['product_id']; ?>');" class="button" /></div>
+      <div class="cart">
+        <input type="button" value="<?php echo $button_cart; ?>" onclick="addToCart('<?php echo $product['product_id']; ?>');" class="button" />
+      </div>
       <div class="wishlist"><a onclick="addToWishList('<?php echo $product['product_id']; ?>');"><?php echo $button_wishlist; ?></a></div>
       <div class="compare"><a onclick="addToCompare('<?php echo $product['product_id']; ?>');"><?php echo $button_compare; ?></a></div>
     </div>
@@ -111,13 +113,12 @@ function display(view) {
 
 			html += '</div>';
 
-
 			$(element).html(html);
 		});
 
 		$('.display').html('<b><?php echo $text_display; ?></b> <?php echo $text_list; ?> <b>/</b> <a onclick="display(\'grid\');"><?php echo $text_grid; ?></a>');
 
-		$.cookie('display', 'list');
+		$.totalStorage('display', 'list');
 	} else {
 		$('.product-list').attr('class', 'product-grid');
 
@@ -154,11 +155,11 @@ function display(view) {
 
 		$('.display').html('<b><?php echo $text_display; ?></b> <a onclick="display(\'list\');"><?php echo $text_list; ?></a> <b>/</b> <?php echo $text_grid; ?>');
 
-		$.cookie('display', 'grid');
+		$.totalStorage('display', 'grid');
 	}
 }
 
-view = $.cookie('display');
+view = $.totalStorage('display');
 
 if (view) {
 	display(view);
diff --git a/catalog/view/theme/default/template/product/product.tpl b/catalog/view/theme/default/template/product/product.tpl
index e1a28e0..c24d0a2 100644
--- a/catalog/view/theme/default/template/product/product.tpl
+++ b/catalog/view/theme/default/template/product/product.tpl
@@ -10,12 +10,12 @@
     <?php if ($thumb || $images) { ?>
     <div class="left">
       <?php if ($thumb) { ?>
-      <div class="image"><a href="<?php echo $popup; ?>" title="<?php echo $heading_title; ?>" class="colorbox" rel="colorbox"><img src="<?php echo $thumb; ?>" title="<?php echo $heading_title; ?>" alt="<?php echo $heading_title; ?>" id="image" /></a></div>
+      <div class="image"><a href="<?php echo $popup; ?>" title="<?php echo $heading_title; ?>" class="colorbox"><img src="<?php echo $thumb; ?>" title="<?php echo $heading_title; ?>" alt="<?php echo $heading_title; ?>" id="image" /></a></div>
       <?php } ?>
       <?php if ($images) { ?>
       <div class="image-additional">
         <?php foreach ($images as $image) { ?>
-        <a href="<?php echo $image['popup']; ?>" title="<?php echo $heading_title; ?>" class="colorbox" rel="colorbox"><img src="<?php echo $image['thumb']; ?>" title="<?php echo $heading_title; ?>" alt="<?php echo $heading_title; ?>" /></a>
+        <a href="<?php echo $image['popup']; ?>" title="<?php echo $heading_title; ?>" class="colorbox"><img src="<?php echo $image['thumb']; ?>" title="<?php echo $heading_title; ?>" alt="<?php echo $heading_title; ?>" /></a>
         <?php } ?>
       </div>
       <?php } ?>
@@ -61,14 +61,14 @@
         <br />
         <?php foreach ($options as $option) { ?>
         <?php if ($option['type'] == 'select') { ?>
-        <div id="option-<?php echo $option['product_option_id']; ?>" class="option">
+        <div id="option<?php echo $option['product_option_id']; ?>" class="option">
           <?php if ($option['required']) { ?>
           <span class="required">*</span>
           <?php } ?>
           <b><?php echo $option['name']; ?>:</b><br />
           <select name="option[<?php echo $option['product_option_id']; ?>]">
             <option value=""><?php echo $text_select; ?></option>
-            <?php foreach ($option['option_value'] as $option_value) { ?>
+            <?php foreach ($option['product_option_value'] as $option_value) { ?>
             <option value="<?php echo $option_value['product_option_value_id']; ?>"><?php echo $option_value['name']; ?>
             <?php if ($option_value['price']) { ?>
             (<?php echo $option_value['price_prefix']; ?><?php echo $option_value['price']; ?>)
@@ -80,14 +80,14 @@
         <br />
         <?php } ?>
         <?php if ($option['type'] == 'radio') { ?>
-        <div id="option-<?php echo $option['product_option_id']; ?>" class="option">
+        <div id="option<?php echo $option['product_option_id']; ?>" class="option">
           <?php if ($option['required']) { ?>
           <span class="required">*</span>
           <?php } ?>
           <b><?php echo $option['name']; ?>:</b><br />
-          <?php foreach ($option['option_value'] as $option_value) { ?>
-          <input type="radio" name="option[<?php echo $option['product_option_id']; ?>]" value="<?php echo $option_value['product_option_value_id']; ?>" id="option-value-<?php echo $option_value['product_option_value_id']; ?>" />
-          <label for="option-value-<?php echo $option_value['product_option_value_id']; ?>"><?php echo $option_value['name']; ?>
+          <?php foreach ($option['product_option_value'] as $option_value) { ?>
+          <input type="radio" name="option[<?php echo $option['product_option_id']; ?>]" value="<?php echo $option_value['product_option_value_id']; ?>" id="option-value<?php echo $option_value['product_option_value_id']; ?>" />
+          <label for="option-value<?php echo $option_value['product_option_value_id']; ?>"><?php echo $option_value['name']; ?>
             <?php if ($option_value['price']) { ?>
             (<?php echo $option_value['price_prefix']; ?><?php echo $option_value['price']; ?>)
             <?php } ?>
@@ -98,14 +98,14 @@
         <br />
         <?php } ?>
         <?php if ($option['type'] == 'checkbox') { ?>
-        <div id="option-<?php echo $option['product_option_id']; ?>" class="option">
+        <div id="option<?php echo $option['product_option_id']; ?>" class="option">
           <?php if ($option['required']) { ?>
           <span class="required">*</span>
           <?php } ?>
           <b><?php echo $option['name']; ?>:</b><br />
-          <?php foreach ($option['option_value'] as $option_value) { ?>
-          <input type="checkbox" name="option[<?php echo $option['product_option_id']; ?>][]" value="<?php echo $option_value['product_option_value_id']; ?>" id="option-value-<?php echo $option_value['product_option_value_id']; ?>" />
-          <label for="option-value-<?php echo $option_value['product_option_value_id']; ?>"><?php echo $option_value['name']; ?>
+          <?php foreach ($option['product_option_value'] as $option_value) { ?>
+          <input type="checkbox" name="option[<?php echo $option['product_option_id']; ?>][]" value="<?php echo $option_value['product_option_value_id']; ?>" id="option-value<?php echo $option_value['product_option_value_id']; ?>" />
+          <label for="option-value<?php echo $option_value['product_option_value_id']; ?>"><?php echo $option_value['name']; ?>
             <?php if ($option_value['price']) { ?>
             (<?php echo $option_value['price_prefix']; ?><?php echo $option_value['price']; ?>)
             <?php } ?>
@@ -116,85 +116,85 @@
         <br />
         <?php } ?>
         <?php if ($option['type'] == 'image') { ?>
-        <div id="option-<?php echo $option['product_option_id']; ?>" class="option">
+        <div id="option<?php echo $option['product_option_id']; ?>" class="option">
           <?php if ($option['required']) { ?>
           <span class="required">*</span>
           <?php } ?>
           <b><?php echo $option['name']; ?>:</b><br />
-            <table class="option-image">
-              <?php foreach ($option['option_value'] as $option_value) { ?>
-              <tr>
-                <td style="width: 1px;"><input type="radio" name="option[<?php echo $option['product_option_id']; ?>]" value="<?php echo $option_value['product_option_value_id']; ?>" id="option-value-<?php echo $option_value['product_option_value_id']; ?>" /></td>
-                <td><label for="option-value-<?php echo $option_value['product_option_value_id']; ?>"><img src="<?php echo $option_value['image']; ?>" alt="<?php echo $option_value['name'] . ($option_value['price'] ? ' ' . $option_value['price_prefix'] . $option_value['price'] : ''); ?>" /></label></td>
-                <td><label for="option-value-<?php echo $option_value['product_option_value_id']; ?>"><?php echo $option_value['name']; ?>
-                    <?php if ($option_value['price']) { ?>
-                    (<?php echo $option_value['price_prefix']; ?><?php echo $option_value['price']; ?>)
-                    <?php } ?>
-                  </label></td>
-              </tr>
-              <?php } ?>
-            </table>
+          <table class="option-image">
+            <?php foreach ($option['product_option_value'] as $option_value) { ?>
+            <tr>
+              <td style="width: 1px;"><input type="radio" name="option[<?php echo $option['product_option_id']; ?>]" value="<?php echo $option_value['product_option_value_id']; ?>" id="option-value<?php echo $option_value['product_option_value_id']; ?>" /></td>
+              <td><label for="option-value<?php echo $option_value['product_option_value_id']; ?>"><img src="<?php echo $option_value['image']; ?>" alt="<?php echo $option_value['name'] . ($option_value['price'] ? ' ' . $option_value['price_prefix'] . $option_value['price'] : ''); ?>" /></label></td>
+              <td><label for="option-value<?php echo $option_value['product_option_value_id']; ?>"><?php echo $option_value['name']; ?>
+                  <?php if ($option_value['price']) { ?>
+                  (<?php echo $option_value['price_prefix']; ?><?php echo $option_value['price']; ?>)
+                  <?php } ?>
+                </label></td>
+            </tr>
+            <?php } ?>
+          </table>
         </div>
         <br />
         <?php } ?>
         <?php if ($option['type'] == 'text') { ?>
-        <div id="option-<?php echo $option['product_option_id']; ?>" class="option">
+        <div id="option<?php echo $option['product_option_id']; ?>" class="option">
           <?php if ($option['required']) { ?>
           <span class="required">*</span>
           <?php } ?>
           <b><?php echo $option['name']; ?>:</b><br />
-          <input type="text" name="option[<?php echo $option['product_option_id']; ?>]" value="<?php echo $option['option_value']; ?>" />
+          <input type="text" name="option[<?php echo $option['product_option_id']; ?>]" value="<?php echo $option['value']; ?>" />
         </div>
         <br />
         <?php } ?>
         <?php if ($option['type'] == 'textarea') { ?>
-        <div id="option-<?php echo $option['product_option_id']; ?>" class="option">
+        <div id="option<?php echo $option['product_option_id']; ?>" class="option">
           <?php if ($option['required']) { ?>
           <span class="required">*</span>
           <?php } ?>
           <b><?php echo $option['name']; ?>:</b><br />
-          <textarea name="option[<?php echo $option['product_option_id']; ?>]" cols="40" rows="5"><?php echo $option['option_value']; ?></textarea>
+          <textarea name="option[<?php echo $option['product_option_id']; ?>]" cols="40" rows="5"><?php echo $option['value']; ?></textarea>
         </div>
         <br />
         <?php } ?>
         <?php if ($option['type'] == 'file') { ?>
-        <div id="option-<?php echo $option['product_option_id']; ?>" class="option">
+        <div id="option<?php echo $option['product_option_id']; ?>" class="option">
           <?php if ($option['required']) { ?>
           <span class="required">*</span>
           <?php } ?>
           <b><?php echo $option['name']; ?>:</b><br />
-          <a id="button-option-<?php echo $option['product_option_id']; ?>" class="button"><?php echo $button_upload; ?></a>
+          <input type="button" value="<?php echo $button_upload; ?>" id="button-option<?php echo $option['product_option_id']; ?>" class="button" onclick="upload('<?php echo $option['product_option_id']; ?>');" />
           <input type="hidden" name="option[<?php echo $option['product_option_id']; ?>]" value="" />
         </div>
         <br />
         <?php } ?>
         <?php if ($option['type'] == 'date') { ?>
-        <div id="option-<?php echo $option['product_option_id']; ?>" class="option">
+        <div id="option<?php echo $option['product_option_id']; ?>" class="option">
           <?php if ($option['required']) { ?>
           <span class="required">*</span>
           <?php } ?>
           <b><?php echo $option['name']; ?>:</b><br />
-          <input type="text" name="option[<?php echo $option['product_option_id']; ?>]" value="<?php echo $option['option_value']; ?>" class="date" />
+          <input type="text" name="option[<?php echo $option['product_option_id']; ?>]" value="<?php echo $option['value']; ?>" class="date" />
         </div>
         <br />
         <?php } ?>
         <?php if ($option['type'] == 'datetime') { ?>
-        <div id="option-<?php echo $option['product_option_id']; ?>" class="option">
+        <div id="option<?php echo $option['product_option_id']; ?>" class="option">
           <?php if ($option['required']) { ?>
           <span class="required">*</span>
           <?php } ?>
           <b><?php echo $option['name']; ?>:</b><br />
-          <input type="text" name="option[<?php echo $option['product_option_id']; ?>]" value="<?php echo $option['option_value']; ?>" class="datetime" />
+          <input type="text" name="option[<?php echo $option['product_option_id']; ?>]" value="<?php echo $option['value']; ?>" class="datetime" />
         </div>
         <br />
         <?php } ?>
         <?php if ($option['type'] == 'time') { ?>
-        <div id="option-<?php echo $option['product_option_id']; ?>" class="option">
+        <div id="option<?php echo $option['product_option_id']; ?>" class="option">
           <?php if ($option['required']) { ?>
           <span class="required">*</span>
           <?php } ?>
           <b><?php echo $option['name']; ?>:</b><br />
-          <input type="text" name="option[<?php echo $option['product_option_id']; ?>]" value="<?php echo $option['option_value']; ?>" class="time" />
+          <input type="text" name="option[<?php echo $option['product_option_id']; ?>]" value="<?php echo $option['value']; ?>" class="time" />
         </div>
         <br />
         <?php } ?>
@@ -205,18 +205,17 @@
         <div><?php echo $text_qty; ?>
           <input type="text" name="quantity" size="2" value="<?php echo $minimum; ?>" />
           <input type="hidden" name="product_id" size="2" value="<?php echo $product_id; ?>" />
-          &nbsp;<input type="button" value="<?php echo $button_cart; ?>" id="button-cart" class="button" />
-          </div>
-        <div><span>&nbsp;&nbsp;&nbsp;<?php echo $text_or; ?>&nbsp;&nbsp;&nbsp;</span></div>
-        <div><a onclick="addToWishList('<?php echo $product_id; ?>');"><?php echo $button_wishlist; ?></a><br />
-          <a onclick="addToCompare('<?php echo $product_id; ?>');"><?php echo $button_compare; ?></a></div>
+          &nbsp;
+          <input type="button" value="<?php echo $button_cart; ?>" id="button-cart" class="button" />
+          <span>&nbsp;&nbsp;<?php echo $text_or; ?>&nbsp;&nbsp;</span> <span class="links"><a onclick="addToWishList('<?php echo $product_id; ?>');"><?php echo $button_wishlist; ?></a><br />
+          <a onclick="addToCompare('<?php echo $product_id; ?>');"><?php echo $button_compare; ?></a></span> </div>
         <?php if ($minimum > 1) { ?>
         <div class="minimum"><?php echo $text_minimum; ?></div>
         <?php } ?>
       </div>
       <?php if ($review_status) { ?>
       <div class="review">
-        <div><img src="catalog/view/theme/default/image/stars-<?php echo $rating; ?>.png" alt="<?php echo $reviews; ?>" />&nbsp;&nbsp;<a onclick="$('a[href=\'#tab-review\']').trigger('click');"><?php echo $reviews; ?></a>&nbsp;&nbsp;|&nbsp;&nbsp;<a onclick="$('a[href=\'#tab-review\']').trigger('click');"><?php echo $text_write; ?></a></div>
+        <div><img src="catalog/view/theme/default/image/stars-<?php echo $rating; ?>.png" alt="<?php echo $reviews; ?>" />&nbsp;&nbsp;<a onclick="$('a[href=\'#tab-review\']').trigger('click');"><?php echo $reviews; ?></a>&nbsp;&nbsp;|&nbsp;&nbsp;<?php if ($guest_review) { ?><a onclick="$('a[href=\'#tab-review\']').trigger('click');"><?php echo $text_write; ?></a><?php } else { echo $text_login_write; } ?></div>
         <div class="share"><!-- AddThis Button BEGIN -->
           <div class="addthis_default_style"><a class="addthis_button_compact"><?php echo $text_share; ?></a> <a class="addthis_button_email"></a><a class="addthis_button_print"></a> <a class="addthis_button_facebook"></a> <a class="addthis_button_twitter"></a></div>
           <script type="text/javascript" src="//s7.addthis.com/js/250/addthis_widget.js"></script>
@@ -263,8 +262,9 @@
   <div id="tab-review" class="tab-content">
     <div id="review"></div>
     <h2 id="review-title"><?php echo $text_write; ?></h2>
+    <?php if ($guest_review) { ?>
     <b><?php echo $entry_name; ?></b><br />
-    <input type="text" name="name" value="" />
+    <input type="text" name="name" value="<?php echo $customer_name; ?>" />
     <br />
     <br />
     <b><?php echo $entry_review; ?></b>
@@ -281,7 +281,7 @@
     <input type="radio" name="rating" value="4" />
     &nbsp;
     <input type="radio" name="rating" value="5" />
-    &nbsp; <span><?php echo $entry_good; ?></span><br />
+    &nbsp;<span><?php echo $entry_good; ?></span><br />
     <br />
     <b><?php echo $entry_captcha; ?></b><br />
     <input type="text" name="captcha" value="" />
@@ -291,6 +291,7 @@
     <div class="buttons">
       <div class="right"><a id="button-review" class="button"><?php echo $button_continue; ?></a></div>
     </div>
+    <?php } else { echo $text_login_write; } ?>
   </div>
   <?php } ?>
   <?php if ($products) { ?>
@@ -321,20 +322,32 @@
   <?php } ?>
   <?php if ($tags) { ?>
   <div class="tags"><b><?php echo $text_tags; ?></b>
-    <?php foreach ($tags as $tag) { ?>
-    <a href="<?php echo $tag['href']; ?>"><?php echo $tag['tag']; ?></a>,
+    <?php for ($i = 0; $i < count($tags); $i++) { ?>
+    <?php if ($i < (count($tags) - 1)) { ?>
+    <a href="<?php echo $tags[$i]['href']; ?>"><?php echo $tags[$i]['tag']; ?></a>,
+    <?php } else { ?>
+    <a href="<?php echo $tags[$i]['href']; ?>"><?php echo $tags[$i]['tag']; ?></a>
+    <?php } ?>
     <?php } ?>
   </div>
   <?php } ?>
   <?php echo $content_bottom; ?></div>
+<div style="display: none;">
+  <form enctype="multipart/form-data">
+    <input type="file" name="file" id="file" />
+  </form>
+</div>
 <script type="text/javascript"><!--
-$('.colorbox').colorbox({
-	overlayClose: true,
-	opacity: 0.5
+$(document).ready(function() {
+	$('.colorbox').colorbox({
+		overlayClose: true,
+		opacity: 0.5,
+		rel: "colorbox"
+	});
 });
 //--></script>
 <script type="text/javascript"><!--
-$('#button-cart').bind('click', function() {
+$('#button-cart').on('click', function() {
 	$.ajax({
 		url: 'index.php?route=checkout/cart/add',
 		type: 'post',
@@ -346,7 +359,7 @@ $('#button-cart').bind('click', function() {
 			if (json['error']) {
 				if (json['error']['option']) {
 					for (i in json['error']['option']) {
-						$('#option-' + i).after('<span class="error">' + json['error']['option'][i] + '</span>');
+						$('#option' + i).after('<span class="error">' + json['error']['option'][i] + '</span>');
 					}
 				}
 			}
@@ -365,52 +378,67 @@ $('#button-cart').bind('click', function() {
 });
 //--></script>
 <?php if ($options) { ?>
-<script type="text/javascript" src="catalog/view/javascript/jquery/ajaxupload.js"></script>
 <?php foreach ($options as $option) { ?>
 <?php if ($option['type'] == 'file') { ?>
 <script type="text/javascript"><!--
-new AjaxUpload('#button-option-<?php echo $option['product_option_id']; ?>', {
-	action: 'index.php?route=product/product/upload',
-	name: 'file',
-	autoSubmit: true,
-	responseType: 'json',
-	onSubmit: function(file, extension) {
-		$('#button-option-<?php echo $option['product_option_id']; ?>').after('<img src="catalog/view/theme/default/image/loading.gif" class="loading" style="padding-left: 5px;" />');
-	},
-	onComplete: function(file, json) {
-		$('.error').remove();
+function upload(product_option_id) {
+	$('#file').off();
 
-		if (json.success) {
-			alert(json.success);
+	$('#file').on('change', function() {
+		$.ajax({
+			url: 'index.php?route=product/product/upload',
+			type: 'post',
+			dataType: 'json',
+			data: new FormData($(this).parent()[0]),
+			beforeSend: function() {
+				$('#button-option' + product_option_id).after('<img src="catalog/view/theme/default/image/loading.gif" class="loading" style="padding-left: 5px;" />');
+				$('#button-option' + product_option_id).attr('disabled', true);
+				$('#option' + product_option_id + ' + .error').remove();
+			},
+			complete: function() {
+				$('.loading').remove();
+				$('#button-option' + product_option_id).attr('disabled', false);
+			},
+			success: function(json) {
+				if (json['error']) {
+					$('#option' + product_option_id).after('<span class="error">' + json['error'] + '</span>');
+				}
 
-			$('input[name=\'option[<?php echo $option['product_option_id']; ?>]\']').attr('value', json.file);
-		}
+				if (json['success']) {
+					alert(json['success']);
 
-		if (json.error) {
-			$('#option-<?php echo $option['product_option_id']; ?>').after('<span class="error">' + json.error + '</span>');
-		}
+					$('input[name=\'option[' + product_option_id + ']\']').attr('value', json['file']);
+				}
+			},
+			error: function(xhr, ajaxOptions, thrownError) {
+				alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
+			},
+			cache: false,
+			contentType: false,
+			processData: false
+		});
+	});
 
-		$('.loading').remove();
-	}
-});
+	$('input[name=\'file\']').click();
+}
 //--></script>
 <?php } ?>
 <?php } ?>
 <?php } ?>
 <script type="text/javascript"><!--
 $('#review .pagination a').live('click', function() {
-	$('#review').slideUp('slow');
+	$('#review').fadeOut('slow');
 
 	$('#review').load(this.href);
 
-	$('#review').slideDown('slow');
+	$('#review').fadeIn('slow');
 
 	return false;
 });
 
 $('#review').load('index.php?route=product/product/review&product_id=<?php echo $product_id; ?>');
 
-$('#button-review').bind('click', function() {
+$('#button-review').on('click', function() {
 	$.ajax({
 		url: 'index.php?route=product/product/write&product_id=<?php echo $product_id; ?>',
 		type: 'post',
@@ -426,17 +454,20 @@ $('#button-review').bind('click', function() {
 			$('.attention').remove();
 		},
 		success: function(data) {
-			if (data.error) {
-				$('#review-title').after('<div class="warning">' + data.error + '</div>');
+			if (data['error']) {
+				$('#review-title').after('<div class="warning">' + data['error'] + '</div>');
 			}
 
-			if (data.success) {
-				$('#review-title').after('<div class="success">' + data.success + '</div>');
+			if (data['success']) {
+				$('#review-title').after('<div class="success">' + data['success'] + '</div>');
 
 				$('input[name=\'name\']').val('');
 				$('textarea[name=\'text\']').val('');
 				$('input[name=\'rating\']:checked').attr('checked', '');
 				$('input[name=\'captcha\']').val('');
+                var img_src = $("img#captcha").attr("src").replace(/\&rnd=\d*/gi,"");
+                var d = Math.floor((Math.random()*10000)+1);
+                $("img#captcha").attr("src", img_src+"&rnd="+d);
 			}
 		}
 	});
@@ -447,15 +478,17 @@ $('#tabs a').tabs();
 //--></script>
 <script type="text/javascript" src="catalog/view/javascript/jquery/ui/jquery-ui-timepicker-addon.js"></script>
 <script type="text/javascript"><!--
-if ($.browser.msie && $.browser.version == 6) {
-	$('.date, .datetime, .time').bgIframe();
-}
+$(document).ready(function() {
+	if ($.browser.msie && $.browser.version == 6) {
+		$('.date, .datetime, .time').bgIframe();
+	}
 
-$('.date').datepicker({dateFormat: 'yy-mm-dd'});
-$('.datetime').datetimepicker({
-	dateFormat: 'yy-mm-dd',
-	timeFormat: 'h:m'
+	$('.date').datepicker({dateFormat: 'yy-mm-dd'});
+	$('.datetime').datetimepicker({
+		dateFormat: 'yy-mm-dd',
+		timeFormat: 'h:m'
+	});
+	$('.time').timepicker({timeFormat: 'h:m'});
 });
-$('.time').timepicker({timeFormat: 'h:m'});
 //--></script>
 <?php echo $footer; ?>
diff --git a/catalog/view/theme/default/template/product/review.tpl b/catalog/view/theme/default/template/product/review.tpl
index b237171..eac2ed4 100644
--- a/catalog/view/theme/default/template/product/review.tpl
+++ b/catalog/view/theme/default/template/product/review.tpl
@@ -1,9 +1,10 @@
 <?php if ($reviews) { ?>
 <?php foreach ($reviews as $review) { ?>
-<div class="content"><b><?php echo $review['author']; ?></b> | <img src="catalog/view/theme/default/image/stars-<?php echo $review['rating'] . '.png'; ?>" alt="<?php echo $review['reviews']; ?>" /><br />
-  <?php echo $review['date_added']; ?><br />
-  <br />
-  <?php echo $review['text']; ?></div>
+<div class="review-list">
+  <div class="author"><b><?php echo $review['author']; ?></b> <?php echo $text_on; ?> <?php echo $review['date_added']; ?></div>
+  <div class="rating"><img src="catalog/view/theme/default/image/stars-<?php echo $review['rating'] . '.png'; ?>" alt="<?php echo $review['reviews']; ?>" /></div>
+  <div class="text"><?php echo $review['text']; ?></div>
+</div>
 <?php } ?>
 <div class="pagination"><?php echo $pagination; ?></div>
 <?php } else { ?>
diff --git a/catalog/view/theme/default/template/product/search.tpl b/catalog/view/theme/default/template/product/search.tpl
index d9979ec..ca7766e 100644
--- a/catalog/view/theme/default/template/product/search.tpl
+++ b/catalog/view/theme/default/template/product/search.tpl
@@ -9,27 +9,27 @@
   <b><?php echo $text_critea; ?></b>
   <div class="content">
     <p><?php echo $entry_search; ?>
-      <?php if ($filter_name) { ?>
-      <input type="text" name="filter_name" value="<?php echo $filter_name; ?>" />
+      <?php if ($search) { ?>
+      <input type="text" name="search" value="<?php echo $search; ?>" />
       <?php } else { ?>
-      <input type="text" name="filter_name" value="<?php echo $filter_name; ?>" onclick="this.value = '';" onkeydown="this.style.color = '000000'" style="color: #999;" />
+      <input type="text" name="search" value="<?php echo $search; ?>" onclick="this.value = '';" onkeydown="this.style.color = '000000'" style="color: #999;" />
       <?php } ?>
-      <select name="filter_category_id">
+      <select name="category_id">
         <option value="0"><?php echo $text_category; ?></option>
         <?php foreach ($categories as $category_1) { ?>
-        <?php if ($category_1['category_id'] == $filter_category_id) { ?>
+        <?php if ($category_1['category_id'] == $category_id) { ?>
         <option value="<?php echo $category_1['category_id']; ?>" selected="selected"><?php echo $category_1['name']; ?></option>
         <?php } else { ?>
         <option value="<?php echo $category_1['category_id']; ?>"><?php echo $category_1['name']; ?></option>
         <?php } ?>
         <?php foreach ($category_1['children'] as $category_2) { ?>
-        <?php if ($category_2['category_id'] == $filter_category_id) { ?>
+        <?php if ($category_2['category_id'] == $category_id) { ?>
         <option value="<?php echo $category_2['category_id']; ?>" selected="selected">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<?php echo $category_2['name']; ?></option>
         <?php } else { ?>
         <option value="<?php echo $category_2['category_id']; ?>">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<?php echo $category_2['name']; ?></option>
         <?php } ?>
         <?php foreach ($category_2['children'] as $category_3) { ?>
-        <?php if ($category_3['category_id'] == $filter_category_id) { ?>
+        <?php if ($category_3['category_id'] == $category_id) { ?>
         <option value="<?php echo $category_3['category_id']; ?>" selected="selected">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<?php echo $category_3['name']; ?></option>
         <?php } else { ?>
         <option value="<?php echo $category_3['category_id']; ?>">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<?php echo $category_3['name']; ?></option>
@@ -38,17 +38,17 @@
         <?php } ?>
         <?php } ?>
       </select>
-      <?php if ($filter_sub_category) { ?>
-      <input type="checkbox" name="filter_sub_category" value="1" id="sub_category" checked="checked" />
+      <?php if ($sub_category) { ?>
+      <input type="checkbox" name="sub_category" value="1" id="sub_category" checked="checked" />
       <?php } else { ?>
-      <input type="checkbox" name="filter_sub_category" value="1" id="sub_category" />
+      <input type="checkbox" name="sub_category" value="1" id="sub_category" />
       <?php } ?>
       <label for="sub_category"><?php echo $text_sub_category; ?></label>
     </p>
-    <?php if ($filter_description) { ?>
-    <input type="checkbox" name="filter_description" value="1" id="description" checked="checked" />
+    <?php if ($description) { ?>
+    <input type="checkbox" name="description" value="1" id="description" checked="checked" />
     <?php } else { ?>
-    <input type="checkbox" name="filter_description" value="1" id="description" />
+    <input type="checkbox" name="description" value="1" id="description" />
     <?php } ?>
     <label for="description"><?php echo $entry_description; ?></label>
   </div>
@@ -119,37 +119,48 @@
   <?php }?>
   <?php echo $content_bottom; ?></div>
 <script type="text/javascript"><!--
-$('#content input[name=\'filter_name\']').keydown(function(e) {
+$('#content input[name=\'search\']').keydown(function(e) {
 	if (e.keyCode == 13) {
 		$('#button-search').trigger('click');
 	}
 });
 
-$('#button-search').bind('click', function() {
+$('select[name=\'category_id\']').on('change', function() {
+	if (this.value == '0') {
+		$('input[name=\'sub_category\']').attr('disabled', 'disabled');
+		$('input[name=\'sub_category\']').removeAttr('checked');
+	} else {
+		$('input[name=\'sub_category\']').removeAttr('disabled');
+	}
+});
+
+$('select[name=\'category_id\']').trigger('change');
+
+$('#button-search').on('click', function() {
 	url = 'index.php?route=product/search';
 
-	var filter_name = $('#content input[name=\'filter_name\']').attr('value');
+	var search = $('#content input[name=\'search\']').attr('value');
 
-	if (filter_name) {
-		url += '&filter_name=' + encodeURIComponent(filter_name);
+	if (search) {
+		url += '&search=' + encodeURIComponent(search);
 	}
 
-	var filter_category_id = $('#content select[name=\'filter_category_id\']').attr('value');
+	var category_id = $('#content select[name=\'category_id\']').attr('value');
 
-	if (filter_category_id > 0) {
-		url += '&filter_category_id=' + encodeURIComponent(filter_category_id);
+	if (category_id > 0) {
+		url += '&category_id=' + encodeURIComponent(category_id);
 	}
 
-	var filter_sub_category = $('#content input[name=\'filter_sub_category\']:checked').attr('value');
+	var sub_category = $('#content input[name=\'sub_category\']:checked').attr('value');
 
-	if (filter_sub_category) {
-		url += '&filter_sub_category=true';
+	if (sub_category) {
+		url += '&sub_category=true';
 	}
 
-	var filter_description = $('#content input[name=\'filter_description\']:checked').attr('value');
+	var filter_description = $('#content input[name=\'description\']:checked').attr('value');
 
 	if (filter_description) {
-		url += '&filter_description=true';
+		url += '&description=true';
 	}
 
 	location = url;
@@ -191,13 +202,12 @@ function display(view) {
 
 			html += '</div>';
 
-
 			$(element).html(html);
 		});
 
 		$('.display').html('<b><?php echo $text_display; ?></b> <?php echo $text_list; ?> <b>/</b> <a onclick="display(\'grid\');"><?php echo $text_grid; ?></a>');
 
-		$.cookie('display', 'list');
+		$.totalStorage('display', 'list');
 	} else {
 		$('.product-list').attr('class', 'product-grid');
 
@@ -234,11 +244,11 @@ function display(view) {
 
 		$('.display').html('<b><?php echo $text_display; ?></b> <a onclick="display(\'list\');"><?php echo $text_list; ?></a> <b>/</b> <?php echo $text_grid; ?>');
 
-		$.cookie('display', 'grid');
+		$.totalStorage('display', 'grid');
 	}
 }
 
-view = $.cookie('display');
+view = $.totalStorage('display');
 
 if (view) {
 	display(view);
diff --git a/catalog/view/theme/default/template/product/special.tpl b/catalog/view/theme/default/template/product/special.tpl
index d246237..cd9f09f 100644
--- a/catalog/view/theme/default/template/product/special.tpl
+++ b/catalog/view/theme/default/template/product/special.tpl
@@ -105,13 +105,12 @@ function display(view) {
 
 			html += '</div>';
 
-
 			$(element).html(html);
 		});
 
 		$('.display').html('<b><?php echo $text_display; ?></b> <?php echo $text_list; ?> <b>/</b> <a onclick="display(\'grid\');"><?php echo $text_grid; ?></a>');
 
-		$.cookie('display', 'list');
+		$.totalStorage('display', 'list');
 	} else {
 		$('.product-list').attr('class', 'product-grid');
 
@@ -148,11 +147,11 @@ function display(view) {
 
 		$('.display').html('<b><?php echo $text_display; ?></b> <a onclick="display(\'list\');"><?php echo $text_list; ?></a> <b>/</b> <?php echo $text_grid; ?>');
 
-		$.cookie('display', 'grid');
+		$.totalStorage('display', 'grid');
 	}
 }
 
-view = $.cookie('display');
+view = $.totalStorage('display');
 
 if (view) {
 	display(view);
diff --git a/catalog/view/theme/default/template/total/coupon.tpl b/catalog/view/theme/default/template/total/coupon.tpl
index 2d368d1..05c019b 100644
--- a/catalog/view/theme/default/template/total/coupon.tpl
+++ b/catalog/view/theme/default/template/total/coupon.tpl
@@ -10,7 +10,7 @@ $('#button-coupon').bind('click', function() {
 		type: 'POST',
 		url: 'index.php?route=total/coupon/calculate',
 		data: $('#coupon :input'),
-		dataType: 'json',		
+		dataType: 'json',
 		beforeSend: function() {
 			$('.success, .warning').remove();
 			$('#button-coupon').attr('disabled', true);
@@ -19,16 +19,16 @@ $('#button-coupon').bind('click', function() {
 		complete: function() {
 			$('#button-coupon').attr('disabled', false);
 			$('.wait').remove();
-		},		
+		},
 		success: function(json) {
 			if (json['error']) {
 				$('#basket').before('<div class="warning">' + json['error'] + '<img src="catalog/view/theme/default/image/close.png" alt="" class="close" /></div>');
 			}
-			
+
 			if (json['redirect']) {
 				location = json['redirect'];
 			}
 		}
 	});
 });
-//--></script> 
\ No newline at end of file
+//--></script>
\ No newline at end of file
diff --git a/catalog/view/theme/default/template/total/reward.tpl b/catalog/view/theme/default/template/total/reward.tpl
index beaad98..93f9252 100644
--- a/catalog/view/theme/default/template/total/reward.tpl
+++ b/catalog/view/theme/default/template/total/reward.tpl
@@ -10,7 +10,7 @@ $('#button-reward').bind('click', function() {
 		type: 'POST',
 		url: 'index.php?route=total/reward/calculate',
 		data: $('#reward :input'),
-		dataType: 'json',		
+		dataType: 'json',
 		beforeSend: function() {
 			$('.success, .warning').remove();
 			$('#button-reward').attr('disabled', true);
@@ -19,16 +19,16 @@ $('#button-reward').bind('click', function() {
 		complete: function() {
 			$('#button-reward').attr('disabled', false);
 			$('.wait').remove();
-		},		
+		},
 		success: function(json) {
 			if (json['error']) {
 				$('#basket').before('<div class="warning">' + json['error'] + '<img src="catalog/view/theme/default/image/close.png" alt="" class="close" /></div>');
 			}
-			
+
 			if (json['redirect']) {
 				location = json['redirect'];
 			}
 		}
 	});
 });
-//--></script> 
+//--></script>
diff --git a/catalog/view/theme/default/template/total/shipping.tpl b/catalog/view/theme/default/template/total/shipping.tpl
index 360e5d9..250b377 100644
--- a/catalog/view/theme/default/template/total/shipping.tpl
+++ b/catalog/view/theme/default/template/total/shipping.tpl
@@ -37,7 +37,7 @@ $('#button-quote').bind('click', function() {
 		type: 'POST',
 		url: 'index.php?route=total/shipping/quote',
 		data: 'country_id=' + $('select[name=\'country_id\']').val() + '&zone_id=' + $('select[name=\'zone_id\']').val() + '&postcode=' + encodeURIComponent($('input[name=\'postcode\']').val()),
-		dataType: 'json',		
+		dataType: 'json',
 		beforeSend: function() {
 			$('.success, .warning').remove();
 			$('#button-quote').attr('disabled', true);
@@ -46,67 +46,67 @@ $('#button-quote').bind('click', function() {
 		complete: function() {
 			$('#button-quote').attr('disabled', false);
 			$('.wait').remove();
-		},		
+		},
 		success: function(json) {
 			$('.error').remove();
 
 			if (json['redirect']) {
 				location = json['redirect'];
 			}
-						
+
 			if (json['error']) {
 				if (json['error']['warning']) {
 					$('#basket').before('<div class="warning">' + json['error']['warning'] + '</div>');
 				}
-				
+
 				if (json['error']['country']) {
 					$('#shipping select[name=\'country_id\'] + br').after('<span class="error">' + json['error']['country'] + '</span>');
-				}	
-				
+				}
+
 				if (json['error']['zone']) {
 					$('#shipping select[name=\'zone_id\'] + br').after('<span class="error">' + json['error']['zone'] + '</span>');
 				}
-				
+
 				if (json['error']['postcode']) {
 					$('#shipping input[name=\'postcode\']').after('<span class="error">' + json['error']['postcode'] + '</span>');
-				}					
+				}
 			}
-			
+
 			if (json['shipping_methods']) {
 				html  = '<br />';
 				html += '<table width="100%" cellpadding="3">';
-				
+
 				for (i in json['shipping_methods']) {
 					html += '<tr>';
 					html += '  <td colspan="3"><b>' + json['shipping_methods'][i]['title'] + '</b></td>';
 					html += '</tr>';
-				
+
 					if (!json['shipping_methods'][i]['error']) {
 						for (j in json['shipping_methods'][i]['quote']) {
 							html += '<tr>';
-							
+
 							if (json['shipping_methods'][i]['quote'][j]['code'] == $('input[name=\'shipping_method\']').attr('value')) {
 								html += '<td width="1"><input type="radio" name="shipping_method" value="' + json['shipping_methods'][i]['quote'][j]['code'] + '" id="' + json['shipping_methods'][i]['quote'][j]['code'] + '" checked="checked" /></td>';
 							} else {
 								html += '<td width="1"><input type="radio" name="shipping_method" value="' + json['shipping_methods'][i]['quote'][j]['code'] + '" id="' + json['shipping_methods'][i]['quote'][j]['code'] + '" /></td>';
 							}
-								
+
 							html += '  <td><label for="' + json['shipping_methods'][i]['quote'][j]['code'] + '">' + json['shipping_methods'][i]['quote'][j]['title'] + '</label></td>';
 							html += '  <td width="1"><label for="' + json['shipping_methods'][i]['quote'][j]['code'] + '">' + json['shipping_methods'][i]['quote'][j]['text'] + '</label></td>';
 							html += '</tr>';
-						}		
+						}
 					} else {
 						html += '<tr>';
 						html += '  <td colspan="3"><div class="error">' + json['shipping_methods'][i]['error'] + '</div></td>';
-						html += '</tr>	';						
+						html += '</tr>	';
 					}
 				}
-				
+
 				html += '</table>';
-				html += '<br /><a id="button-shipping" class="button"><span><?php echo $button_shipping; ?></span></a>';				
-		
-				$('#quote').html(html);	
-			
+				html += '<br /><a id="button-shipping" class="button"><span><?php echo $button_shipping; ?></span></a>';
+
+				$('#quote').html(html);
+
 				$('#quote').slideDown('slow');
 			}
 		}
@@ -118,7 +118,7 @@ $('#button-shipping').live('click', function() {
 		type: 'POST',
 		url: 'index.php?route=total/shipping/calculate',
 		data: 'shipping_method=' + $('input[name=\'shipping_method\']:checked').attr('value'),
-		dataType: 'json',		
+		dataType: 'json',
 		beforeSend: function() {
 			$('.warning').remove();
 			$('#button-shipping').attr('disabled', true);
@@ -127,19 +127,19 @@ $('#button-shipping').live('click', function() {
 		complete: function() {
 			$('#button-shipping').attr('disabled', false);
 			$('.wait').remove();
-		},		
+		},
 		success: function(json) {
 			if (json['error']) {
 				$('#shipping').before('<div class="warning">' + json['error'] + '<img src="catalog/view/theme/default/image/close.png" alt="" class="close" /></div>');
 			}
-			
+
 			if (json['redirect']) {
 				location = json['redirect'];
 			}
 		}
 	});
 });
-//--></script> 
+//--></script>
 <script type="text/javascript"><!--
 $('select[name=\'zone_id\']').load('index.php?route=total/shipping/zone&country_id=<?php echo $country_id; ?>&zone_id=<?php echo $zone_id; ?>');
-//--></script> 
\ No newline at end of file
+//--></script>
\ No newline at end of file
diff --git a/catalog/view/theme/default/template/total/voucher.tpl b/catalog/view/theme/default/template/total/voucher.tpl
index b16db02..6f9e218 100644
--- a/catalog/view/theme/default/template/total/voucher.tpl
+++ b/catalog/view/theme/default/template/total/voucher.tpl
@@ -10,7 +10,7 @@ $('#button-voucher').bind('click', function() {
 		type: 'POST',
 		url: 'index.php?route=total/voucher/calculate',
 		data: $('#voucher :input'),
-		dataType: 'json',		
+		dataType: 'json',
 		beforeSend: function() {
 			$('.success, .warning').remove();
 			$('#button-voucher').attr('disabled', true);
@@ -19,16 +19,16 @@ $('#button-voucher').bind('click', function() {
 		complete: function() {
 			$('#button-voucher').attr('disabled', false);
 			$('.wait').remove();
-		},		
+		},
 		success: function(json) {
 			if (json['error']) {
 				$('#basket').before('<div class="warning">' + json['error'] + '<img src="catalog/view/theme/default/image/close.png" alt="" class="close" /></div>');
 			}
-			
+
 			if (json['redirect']) {
 				location = json['redirect'];
 			}
 		}
 	});
 });
-//--></script> 
\ No newline at end of file
+//--></script>
\ No newline at end of file
